---

title: Core module


keywords: fastai
sidebar: home_sidebar

summary: "API details"
description: "API details"
nb_path: "nbs/00_Core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_Core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>which python
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/yh3455/miniconda3/envs/seqpy3v0/bin/python
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-parameters">1. parameters<a class="anchor-link" href="#1.-parameters"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">SEQLinkage.Main</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args(['--fam','../sample_i/rare_positions/sample_i_coding.hg38_multianno.fam', 
                                 '--vcf', '../sample_i/rare_positions/sample_i_coding.hg38_multianno.vcf.gz',
                                 '--blueprint','./data/vipgenemap.hg38.txt','-f','MERLIN',
'--tempdir','./Tempdir_s1',
'--build', 'hg38',  '--freq', 'AF', '-K', '0.001', '--moi', 'AD', '-W', '0', '-M', '1', 
'--theta-max', '0.5', '--theta-inc', '0.05','--run-linkage', '--output', './testseqlink'])</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args(['--fam','../sample_i/rare_positions/sample_i_coding.hg38_multianno.fam', 
                                 '--vcf', '../sample_i/vcf/small_sample_i.vcf.gz',
                                 '--blueprint','./data/vipgenemap.hg38.txt','-f','MERLIN',
'--tempdir','./Tempdir_s1',
'--build', 'hg38',  '--freq', 'AF', '-K', '0.001', '--moi', 'AD', '-W', '0', '-M', '1', 
'--theta-max', '0.5', '--theta-inc', '0.05','--run-linkage', '--output', './testseqlink'])</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args(['--fam','./seqlinkage-example/seqlinkage-example.fam','--vcf','./seqlinkage-example/seqlinkage-example.vcf.gz','-f','MERLIN',
                                 '--tempdir','./seqlinkage-example/tmprst',
                                 '--build','hg19','--blueprint','./seqlinkage-example/twogenomap.txt','--freq','EVSEAAF','-K','0.001','--moi','AR','-W','0','-M','1',
                                 '--theta-max','0.5','--theta-inc','0.05','--run-linkage','--output','./seqlinkage-example/tsq20211130'])</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>?shoud we set mle parameter as true?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args(['--fam','../MWE/sample2_uniq.fam', 
                                 '--vcf', '../MWE/sample_ii_coding.hg38_multianno.vcf.gz',
'--blueprint','../MWE/genemap.hg38.txt', '--chrom-prefix','1','-f','MERLIN',
'--tempdir','./Tempdir',
'--build', 'hg38',  '--freq', 'AF', '-K', '0.001', '--moi', 'AD', '-W', '0', '-M', '1', 
'--theta-max', '0.5', '--theta-inc', '0.05','--run-linkage', '--output', './testseqlink1105'])</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args('--bin 1 --fam ../seqlinkage-example/seqlinkage-example.fam --vcf ../seqlinkage-example/seqlinkage-example.vcf.gz -f MERLIN --blueprint ../data/genemap.txt --freq EVSEAAF'.split())</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args('--bin 1 --fam ../data/mwe_normal_fam.csv --vcf ../data/first1000snp_full_samples.vcf.gz --anno ../data/first1000_chr1_multianno.csv --pop ../data/full_sample_fam_pop.txt -f MERLIN --blueprint ../data/genemap.hg38.txt --freq AF'.split())</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>args = Args().parser.parse_args('--fam ../data/new_trim_ped_fam.fam --vcf ../data/first1000snp_full_samples.vcf.gz -f MERLIN --blueprint ../data/genemap.hg38.txt --freq AF'.split())</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">&#39;--fam ../data/mwe_normal_fam.csv --vcf /mnt/mfs/statgen/alzheimers-family/linkage_files/geno/full_sample/vcf/full_sample.vcf.gz --anno ../MWE/annotation/EFIGA_NIALOAD_chr19.hg38.hg38_multianno.csv --pop ../data/full_sample_fam_pop.txt -f MERLIN MEGA2 PLINK LINKAGE --build hg38 --freq AF -o data/mwechr19data -K 0.001 --moi AD -W 0 -M 1 --run-linkage -j 8&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Namespace(bin=0, blueprint=None, single_markers=False, tfam=&#39;../data/mwe_normal_fam.csv&#39;, vcf=&#39;/mnt/mfs/statgen/alzheimers-family/linkage_files/geno/full_sample/vcf/full_sample.vcf.gz&#39;, anno=&#39;../MWE/annotation/EFIGA_NIALOAD_chr19.hg38.hg38_multianno.csv&#39;, pop=&#39;../data/full_sample_fam_pop.txt&#39;, build=&#39;hg38&#39;, prephased=False, freq=&#39;AF&#39;, freq_by_fam=None, mle=False, rvhaplo=False, recomb_max=1, recomb_cross_fam=False, rsq=0.0, include_vars=None, maf_cutoff=1.0, chr_prefix=None, output=&#39;data/mwechr19data&#39;, format=[&#39;MERLIN&#39;, &#39;MEGA2&#39;, &#39;PLINK&#39;, &#39;LINKAGE&#39;], prevalence=0.001, inherit_mode=&#39;AD&#39;, wild_pen=0.0, muta_pen=1.0, theta_max=0.5, theta_inc=0.05, run_linkage=True, output_limit=10, jobs=8, tempdir=None, vanilla=True, quiet=False, debug=False, no_save=False, func=&lt;function main at 0x2aafe38e5040&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.from-Core-import-deepcopy">2.from Core import deepcopy<a class="anchor-link" href="#2.from-Core-import-deepcopy"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-RData-class">3. RData class<a class="anchor-link" href="#3.-RData-class"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/first1000_chr1_multianno.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Ref</th>
      <th>Alt</th>
      <th>Func.refGene</th>
      <th>Gene.refGene</th>
      <th>GeneDetail.refGene</th>
      <th>ExonicFunc.refGene</th>
      <th>AAChange.refGene</th>
      <th>...</th>
      <th>CLNDISDB</th>
      <th>CLNREVSTAT</th>
      <th>CLNSIG</th>
      <th>DN ID</th>
      <th>Patient ID</th>
      <th>Phenotype</th>
      <th>Platform</th>
      <th>Study</th>
      <th>Pubmed ID</th>
      <th>Otherinfo1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>10140</td>
      <td>10147</td>
      <td>ACCCTAAC</td>
      <td>A</td>
      <td>intergenic</td>
      <td>NONE;DDX11L1</td>
      <td>dist=NONE;dist=1727</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:10140:ACCCTAAC:A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10146</td>
      <td>10147</td>
      <td>AC</td>
      <td>A</td>
      <td>intergenic</td>
      <td>NONE;DDX11L1</td>
      <td>dist=NONE;dist=1727</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:10146:AC:A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>10146</td>
      <td>10148</td>
      <td>ACC</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:10146:ACC:*</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>10150</td>
      <td>10151</td>
      <td>CT</td>
      <td>C</td>
      <td>intergenic</td>
      <td>NONE;DDX11L1</td>
      <td>dist=NONE;dist=1723</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:10150:CT:C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>10172</td>
      <td>10177</td>
      <td>CCCTAA</td>
      <td>C</td>
      <td>intergenic</td>
      <td>NONE;DDX11L1</td>
      <td>dist=NONE;dist=1697</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:10172:CCCTAA:C</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>1</td>
      <td>66479</td>
      <td>66487</td>
      <td>TATTTATAG</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:66479:TATTTATAG:*</td>
    </tr>
    <tr>
      <th>996</th>
      <td>1</td>
      <td>66480</td>
      <td>66481</td>
      <td>AT</td>
      <td>A</td>
      <td>intergenic</td>
      <td>FAM138A;OR4F5</td>
      <td>dist=30399;dist=2610</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:66480:AT:A</td>
    </tr>
    <tr>
      <th>997</th>
      <td>1</td>
      <td>66480</td>
      <td>66483</td>
      <td>ATTT</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:66480:ATTT:*</td>
    </tr>
    <tr>
      <th>998</th>
      <td>1</td>
      <td>66481</td>
      <td>66488</td>
      <td>TTTATAGA</td>
      <td>T</td>
      <td>intergenic</td>
      <td>FAM138A;OR4F5</td>
      <td>dist=30400;dist=2603</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:66481:TTTATAGA:T</td>
    </tr>
    <tr>
      <th>999</th>
      <td>1</td>
      <td>66481</td>
      <td>66488</td>
      <td>TTTATAGA</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>...</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>.</td>
      <td>chr1:66481:TTTATAGA:*</td>
    </tr>
  </tbody>
</table>
<p>1000 rows Ã— 152 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../MWE/annotation/EFIGA_NIALOAD_chr21.hg38.hg38_multianno.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span> <span class="o">=</span> <span class="n">anno</span><span class="p">[[</span><span class="s1">&#39;Chr&#39;</span><span class="p">,</span><span class="s1">&#39;Start&#39;</span><span class="p">,</span><span class="s1">&#39;Gene.refGene&#39;</span><span class="p">,</span><span class="s1">&#39;Ref&#39;</span><span class="p">,</span><span class="s1">&#39;Alt&#39;</span><span class="p">,</span><span class="s1">&#39;AF&#39;</span><span class="p">,</span><span class="s1">&#39;AF_afr&#39;</span><span class="p">,</span><span class="s1">&#39;AF_ami&#39;</span><span class="p">,</span><span class="s1">&#39;AF_amr&#39;</span><span class="p">,</span><span class="s1">&#39;AF_asj&#39;</span><span class="p">,</span><span class="s1">&#39;AF_eas&#39;</span><span class="p">,</span><span class="s1">&#39;AF_fin&#39;</span><span class="p">,</span><span class="s1">&#39;AF_nfe&#39;</span><span class="p">,</span><span class="s1">&#39;AF_oth&#39;</span><span class="p">,</span><span class="s1">&#39;AF_sas&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">anno</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Gene.refGene&#39;</span><span class="p">):</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span><span class="n">v</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">anno</span><span class="o">.</span><span class="n">Otherinfo1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span><span class="p">[</span><span class="n">anno</span><span class="o">.</span><span class="n">Start</span><span class="o">==</span><span class="mi">30210178</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>Otherinfo1</th>
      <th>Ref</th>
      <th>Alt</th>
      <th>AF</th>
      <th>AF_afr</th>
      <th>AF_ami</th>
      <th>AF_amr</th>
      <th>AF_asj</th>
      <th>AF_eas</th>
      <th>AF_fin</th>
      <th>AF_nfe</th>
      <th>AF_oth</th>
      <th>AF_sas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATATATATATATATAGTCTCCCTAATTGTAATTCAAGGTACGTATGTGTATATATATATATATATATATATATATATATATAT:A</th>
      <td>21</td>
      <td>30210178</td>
      <td>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTA...</td>
      <td>AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATAT...</td>
      <td>A</td>
      <td>0.0012</td>
      <td>0.0013</td>
      <td>0.0013</td>
      <td>0.0002</td>
      <td>0</td>
      <td>0.0022</td>
      <td>0.0006</td>
      <td>0.0014</td>
      <td>0.0006</td>
      <td>0.0012</td>
    </tr>
    <tr>
      <th>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATATATATATATATAGTCTCCCTAATTGTAATTCAAGGTACGTATGTGTATATATATATATATATATATATATATATATATATATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATATATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATAT:A</th>
      <td>21</td>
      <td>30210178</td>
      <td>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTA...</td>
      <td>AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATAT...</td>
      <td>A</td>
      <td>0.0018</td>
      <td>0.0009</td>
      <td>0.0013</td>
      <td>0.0014</td>
      <td>0.0046</td>
      <td>0.0007</td>
      <td>0.0013</td>
      <td>0.0023</td>
      <td>0.0012</td>
      <td>0.0008</td>
    </tr>
    <tr>
      <th>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATATATATATATATAGTCTCCCTAATTGTAATTCAAGGTACGTATGTGTATATATATATATATATATATATATATATATATATATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATAT:A</th>
      <td>21</td>
      <td>30210178</td>
      <td>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTA...</td>
      <td>AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATAT...</td>
      <td>A</td>
      <td>0.0016</td>
      <td>0.0003</td>
      <td>0.0013</td>
      <td>0.0015</td>
      <td>0.0023</td>
      <td>0.0022</td>
      <td>0.0019</td>
      <td>0.0022</td>
      <td>0.0023</td>
      <td>0.0016</td>
    </tr>
    <tr>
      <th>chr21:30210178:A:AAT</th>
      <td>21</td>
      <td>30210178</td>
      <td>chr21:30210178:A:AAT</td>
      <td>A</td>
      <td>AAT</td>
      <td>0.0066</td>
      <td>0.0259</td>
      <td>0</td>
      <td>0.0017</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0001</td>
      <td>0.0041</td>
      <td>0.0004</td>
    </tr>
    <tr>
      <th>chr21:30210178:AAT:A</th>
      <td>21</td>
      <td>30210178</td>
      <td>chr21:30210178:AAT:A</td>
      <td>AAT</td>
      <td>A</td>
      <td>0.0002</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0003</td>
      <td>0</td>
      <td>0.0006</td>
      <td>0.0002</td>
      <td>0.0006</td>
      <td>0.0004</td>
    </tr>
    <tr>
      <th>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATATATATATATATAGTCTCCCTAATTGTAATTCAAGGTACGTATGTGTATATATATATATATATATATATATATATATATATATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATATATATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATATATATATATAT:A</th>
      <td>21</td>
      <td>30210178</td>
      <td>chr21:30210178:AATATATATATATATAGTCTCCCTAATTCTA...</td>
      <td>AATATATATATATATAGTCTCCCTAATTCTAATTCAAGGTACATAT...</td>
      <td>A</td>
      <td>0.0018</td>
      <td>0.0009</td>
      <td>0.0013</td>
      <td>0.0014</td>
      <td>0.0046</td>
      <td>0.0007</td>
      <td>0.0013</td>
      <td>0.0023</td>
      <td>0.0012</td>
      <td>0.0008</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span> <span class="o">=</span> <span class="n">anno</span><span class="p">[</span><span class="o">~</span><span class="n">anno</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">anno</span><span class="p">[(</span><span class="n">anno</span><span class="o">.</span><span class="n">Start</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">anno</span><span class="o">.</span><span class="n">Start</span><span class="o">&lt;</span><span class="mi">20000</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span> <span class="o">=</span> <span class="n">anno</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">anno</span> <span class="o">=</span> <span class="n">anno</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam_pop_file</span> <span class="o">=</span> <span class="s1">&#39;../data/full_sample_fam_pop.txt&#39;</span>
<span class="n">fam_pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fam_pop_file</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="s1">&#39;Chr&#39;</span><span class="p">]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">fam_pop</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Chr&#39;, nan, &#39;AF_afr&#39;, &#39;AF_nfe&#39;, &#39;AF_amr&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RData" class="doc_header"><code>class</code> <code>RData</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Core.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RData</code>(<strong><code>vcf</code></strong>, <strong><code>tfam</code></strong>, <strong><code>anno_file</code></strong>=<em><code>None</code></em>, <strong><code>fam_pop_file</code></strong>=<em><code>None</code></em>, <strong><code>ind_sample_file</code></strong>=<em><code>None</code></em>, <strong><code>allele_freq_info</code></strong>=<em><code>None</code></em>) :: <code>dict</code></p>
</blockquote>
<p>dict() -&gt; new empty dictionary
dict(mapping) -&gt; new dictionary initialized from a mapping object's
    (key, value) pairs
dict(iterable) -&gt; new dictionary initialized as if via:
    d = {}
    for k, v in iterable:
        d[k] = v
dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs
    in the keyword argument list.  For example:  dict(one=1, two=2)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.RegionExtractor-class">4.RegionExtractor class<a class="anchor-link" href="#4.RegionExtractor-class"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">RegionExtractor</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Extract given genomic region from VCF</span>
<span class="sd">    converting genotypes into dictionary of</span>
<span class="sd">    genotype list&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">build</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">build</span><span class="p">,</span> <span class="n">chr_prefix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allele_freq_info</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">include_vars_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span> <span class="o">=</span> <span class="n">cstatgen</span><span class="o">.</span><span class="n">VCFstream</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chr_prefix</span> <span class="o">=</span> <span class="n">chr_prefix</span>
        <span class="c1"># name of allele frequency meta info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">af_info</span> <span class="o">=</span> <span class="n">allele_freq_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xchecker</span> <span class="o">=</span> <span class="n">PseudoAutoRegion</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">build</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ychecker</span> <span class="o">=</span> <span class="n">PseudoAutoRegion</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">build</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">include_vars_file</span> <span class="o">=</span> <span class="n">include_vars_file</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># Clean up</span>
        <span class="n">data</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">Extract</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpos</span><span class="p">)</span>
        <span class="n">varIdx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># for each variant site</span>
        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">Next</span><span class="p">()):</span>
            <span class="c1"># skip tri-allelic sites</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">IsBiAllelic</span><span class="p">():</span>
                <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span><span class="o">==</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">continue</span>
            <span class="c1"># check if the line&#39;s sample number matches the entire VCF sample number</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">CountSampleGenotypes</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">sampleCount</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Genotype and sample mismatch for region </span><span class="si">{}</span><span class="s1">: </span><span class="si">{:,d}</span><span class="s1"> vs </span><span class="si">{:,d}</span><span class="s1">&#39;</span><span class="o">.</span>\
                             <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">CountSampleGenotypes</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">sampleCount</span><span class="p">))</span>
            <span class="c1"># valid line found, get variant info</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">af_info</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">maf</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">large_maf</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">pop_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">af_info</span><span class="p">:</span>
                        <span class="n">large_maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetInfo</span><span class="p">(</span><span class="n">pop_info</span><span class="p">)))</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="n">maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">maf</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="n">maf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">large_maf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
                            <span class="n">maf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">maf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">large_maf</span><span class="o">=</span><span class="kc">False</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">maf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">af_info</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">af_info</span> <span class="k">else</span> <span class="kc">None</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">maf</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">if</span> <span class="n">maf</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="n">large_maf</span><span class="o">=</span><span class="kc">True</span>
                        <span class="n">maf</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">maf</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;VCF line </span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2"> does not have valid allele frequency field </span><span class="si">{}</span><span class="s2">!&quot;</span><span class="o">.</span>\
                                 <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetChrom</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">af_info</span><span class="p">))</span>
            <span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetChrom</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">maf</span><span class="p">])</span>
            <span class="c1"># for each family assign member genotype if the site is non-trivial to the family</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
                <span class="n">gs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">GetGenotypes</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">famsampidx</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">popidx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">af_info</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">large_maf</span><span class="p">[</span><span class="n">popidx</span><span class="p">]:</span>
                        <span class="n">tmpgs</span><span class="o">=</span><span class="p">[]</span>
                        <span class="k">for</span> <span class="n">tmpg</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">tmpg</span><span class="o">==</span><span class="s1">&#39;00&#39;</span><span class="p">:</span>
                                <span class="n">tmpgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpg</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">tmpgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span> <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="n">tmpg</span><span class="p">]))</span>
                        <span class="n">gs</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmpgs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">large_maf</span><span class="p">:</span>
                        <span class="n">tmpgs</span><span class="o">=</span><span class="p">[]</span>
                        <span class="k">for</span> <span class="n">tmpg</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">tmpg</span><span class="o">==</span><span class="s1">&#39;00&#39;</span><span class="p">:</span>
                                <span class="n">tmpgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpg</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">tmpgs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span> <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="n">tmpg</span><span class="p">]))</span>
                        <span class="n">gs</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmpgs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">person</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">gs</span><span class="p">):</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gs</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># skip monomorphic gs</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gs</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s2">&quot;00&quot;</span><span class="p">])))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">wtvar</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varIdx</span><span class="p">)</span>
                    <span class="c1"># this variant is found in the family</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varIdx</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">person</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">gs</span><span class="p">):</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">varIdx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">varIdx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_vars_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">include_vars_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">invar_fh</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">invar_line</span> <span class="ow">in</span> <span class="n">invar_fh</span><span class="p">:</span>
                        <span class="n">chrom</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">invar_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">vidx</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">chrom</span> <span class="ow">and</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
                                <span class="n">data</span><span class="o">.</span><span class="n">include_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
                                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">include_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">]</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">variants_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                <span class="n">env</span><span class="o">.</span><span class="n">variants_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="n">varIdx</span>
            <span class="k">return</span> <span class="mi">0</span>


    <span class="k">def</span> <span class="nf">getRegion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">region</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startpos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endpos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpos</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;23&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xchecker</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startpos</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">xchecker</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpos</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="s1">&#39;XY&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;24&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ychecker</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startpos</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ychecker</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpos</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="s1">&#39;XY&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chr_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chr_prefix</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chr_prefix</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.MarkerMaker-class">5.MarkerMaker class<a class="anchor-link" href="#5.MarkerMaker-class"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MarkerMaker</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wsize</span><span class="p">,</span> <span class="n">maf_cutoff</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">single_markers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">recomb_max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">af_info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">freq_by_fam</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">rsq</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">mle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">rvhaplo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">recomb_perfam</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">missings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gtconv</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recomb_max</span> <span class="o">=</span> <span class="n">recomb_max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">haplotyper</span> <span class="o">=</span> <span class="n">cstatgen</span><span class="o">.</span><span class="n">HaplotypingEngine</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">af_info</span> <span class="o">=</span> <span class="n">af_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq_by_fam</span> <span class="o">=</span> <span class="n">freq_by_fam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsq</span><span class="o">=</span><span class="n">rsq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mle</span><span class="o">=</span><span class="n">mle</span>          <span class="c1">#use MLE estimate from families for MAF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="o">=</span> <span class="ow">not</span> <span class="n">mle</span>   <span class="c1">#count founder alleles to estimate MAF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rvhaplo</span><span class="o">=</span><span class="n">rvhaplo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recomb_perfam</span><span class="o">=</span><span class="n">recomb_perfam</span>
        <span class="k">if</span> <span class="n">wsize</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">wsize</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="n">wsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coder</span> <span class="o">=</span> <span class="n">cstatgen</span><span class="o">.</span><span class="n">HaplotypeCoder</span><span class="p">(</span><span class="n">wsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maf_cutoff</span> <span class="o">=</span> <span class="n">maf_cutoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">single_markers</span> <span class="o">=</span> <span class="n">single_markers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># temp raw haplotype, maf and variant names data</span>
        <span class="n">haplotypes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">##Per fam per variant</span>
        <span class="n">uniq_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">exclude_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">recombPos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#try:</span>
            <span class="c1"># haplotyping plus collect found allele counts</span>
            <span class="c1"># and computer founder MAFS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__Haplotype</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">,</span><span class="n">exclude_vars</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;__Haplotype&#39;</span><span class="p">,</span><span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">,</span><span class="n">exclude_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">haplotypes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mafs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">varnames</span> <span class="o">=</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span>  <span class="c1">###anno</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span> <span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">]):</span>
                <span class="c1"># all families have only one variant</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__AssignSNVHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># calculate LD clusters using founder haplotypes</span>
                <span class="n">clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ClusterByLD</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
                <span class="c1"># recoding the genotype of the region</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__CodeHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
    <span class="c1">#except Exception as e:</span>
        <span class="c1">#    if env.debug:</span>
        <span class="c1">#        raise</span>
        <span class="c1">#    return -1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__FormatHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">varnames</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__getMLEfreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span> <span class="n">markers_to_analyze</span><span class="p">,</span> <span class="n">pos_all</span><span class="p">,</span> <span class="n">families</span><span class="p">,</span> <span class="n">rsq</span><span class="p">,</span> <span class="n">output_log</span><span class="p">):</span>
        <span class="n">output_sample</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">mle_mafs</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers_to_analyze</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mle_mafs</span>
        <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">families</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">sort_family</span><span class="p">(</span><span class="n">fam</span><span class="p">):</span>
                <span class="n">output_sample</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">last_ele</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">output_sample</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">person</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">markers_to_analyze</span><span class="p">:</span>
                        <span class="n">idx</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">marker</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
                        <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;00&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">markers_to_analyze</span><span class="p">))</span>
        <span class="k">with</span> <span class="n">stdoutRedirect</span><span class="p">(</span><span class="n">to</span> <span class="o">=</span> <span class="n">output_log</span><span class="p">):</span>
            <span class="n">af</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">markers_to_analyze</span><span class="p">,</span> <span class="n">pos_all</span><span class="p">,</span> <span class="n">output_sample</span><span class="p">,</span> <span class="n">rsq</span><span class="p">,</span> <span class="n">output_log</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_log</span><span class="p">)</span> <span class="k">as</span> <span class="n">mle_fh</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">mle_fh</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">):</span>
                    <span class="n">tmp_eles</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">tmp_eles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mle_mafs</span><span class="p">:</span>
                        <span class="n">freqs</span><span class="o">=</span><span class="n">tmp_eles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="n">mle_maf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">mle_maf</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">mle_mafs</span><span class="p">[</span><span class="n">tmp_eles</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.9f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">mle_maf</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1">#alt allele is more frequent</span>
                            <span class="n">mle_mafs</span><span class="p">[</span><span class="n">tmp_eles</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.9f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">mle_maf</span>)
                            <span class="n">marker_idx</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">tmp_eles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
                            <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">families</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">marker_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">fam</span><span class="p">]:</span>
                                    <span class="k">continue</span>
                                <span class="n">tmp_famvaridx</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">marker_idx</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">fam</span><span class="p">]:</span>
                                    <span class="n">tmpg</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">marker_idx</span><span class="p">]</span>
                                    <span class="n">tmpg_switch</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span> <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="n">tmpg</span><span class="p">])</span> <span class="k">if</span> <span class="n">tmpg</span><span class="o">!=</span><span class="s1">&#39;00&#39;</span> <span class="k">else</span> <span class="n">tmpg</span>
                                    <span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">marker_idx</span><span class="p">]</span><span class="o">=</span><span class="n">tmpg_switch</span>
                                    <span class="n">tmpg2</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">tmp_famvaridx</span><span class="p">]</span>
                                    <span class="n">tmpg_switch2</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span> <span class="k">for</span> <span class="n">tg</span> <span class="ow">in</span> <span class="n">tmpg2</span><span class="p">])</span> <span class="k">if</span> <span class="n">tmpg2</span><span class="o">!=</span><span class="s1">&#39;00&#39;</span> <span class="k">else</span> <span class="n">tmpg2</span>
                                    <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">tmp_famvaridx</span><span class="p">]</span><span class="o">=</span><span class="n">tmpg_switch2</span>
        <span class="k">return</span> <span class="n">mle_mafs</span>

    <span class="k">def</span> <span class="nf">__computefounderfreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span> <span class="n">families</span><span class="p">):</span>
        <span class="c1">#count founder alleles to estimate MAF</span>
        <span class="n">total_founder_alleles</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">tmp_haplotypes</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">tmp_mafs</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">families</span><span class="p">:</span>
            <span class="n">tmp_haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PedToHaplotype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
            <span class="c1"># count founder alleles</span>
            <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">tmp_haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="n">total_founder_alleles</span><span class="o">+=</span><span class="mf">1.0</span>
                <span class="k">for</span> <span class="n">idxv</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;map&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
                        <span class="c1"># [#alt, #haplotypes]</span>
                        <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">gt</span> <span class="o">=</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">gt</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span><span class="p">:</span>
                    <span class="c1">#genotyped</span>
                        <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gtconv</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#genotype is missing</span>
                        <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">1.0</span>
        <span class="c1">#compute MAFs based on counts</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">total_founder_alleles</span><span class="p">)</span> <span class="k">if</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">total_founder_alleles</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="k">return</span> <span class="n">tmp_mafs</span>

    <span class="k">def</span> <span class="nf">__Haplotype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">,</span><span class="n">exclude_vars</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;genetic haplotyping. haplotypes stores per family data&#39;&#39;&#39;</span>
        <span class="c1"># FIXME: it is SWIG&#39;s (2.0.12) fault not to properly destroy the object &quot;Pedigree&quot; in &quot;Execute()&quot;</span>
        <span class="c1"># So there is a memory leak here which I tried to partially handle on C++</span>
        <span class="c1">#</span>
        <span class="c1"># Per family haplotyping</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
            <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># haplotyping</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hap</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">prephased</span><span class="p">:</span>
                    <span class="n">tmp_log_output</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span> 
                    <span class="c1">#with stdoutRedirect(to = tmp_log_output + &#39;.log&#39;):</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span> 
                                                                   <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">tmp_log_output</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;haplotyper execute&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hap</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PedToHaplotype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
           
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># C++ haplotyping implementation failed</span>
                <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># either use privided MAF or computer MAF</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">vcf_mafs</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                        <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># count founder alleles</span>
                <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">continue</span>
                    <span class="k">for</span> <span class="n">idxv</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                            <span class="c1"># [#alt, #haplotypes]</span>
                            <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                        <span class="n">gt</span> <span class="o">=</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">gt</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span><span class="p">:</span>
                            <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gtconv</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span>
                            <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="c1">#</span>
        <span class="c1"># Compute founder MAFs</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;variant mafs = &quot;</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Drop some variants if maf is greater than given threshold</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maf_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">exclude_vars</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mafs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">:</span>
                    <span class="n">exclude_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">listit</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> \
                      <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span> <span class="k">if</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_vars</span><span class="p">]</span>
                <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_vars</span><span class="p">]</span>
                <span class="c1"># handle trivial data</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
                    <span class="k">del</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">del</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># count how many variants are removed</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exclude_vars</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__ClusterByLD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">varnames</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># get founder haplotypes</span>
        <span class="n">founder_haplotypes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">markers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">varnames</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ihap</span><span class="p">,</span> <span class="n">hap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">continue</span>
                <span class="n">gt</span> <span class="o">=</span> <span class="p">[</span><span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;?&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">markers</span><span class="p">]</span>
                <span class="n">founder_haplotypes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ihap</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gt</span><span class="p">])))</span>
        <span class="c1"># calculate LD blocks, use r2 measure</span>
        <span class="n">ld</span> <span class="o">=</span> <span class="n">Align</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">founder_haplotypes</span><span class="p">)</span><span class="o">.</span><span class="n">matrixLD</span><span class="p">(</span><span class="n">validCharacters</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">)[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span>
        <span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ld</span><span class="p">:</span>
            <span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ld</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">ld</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span><span class="p">:</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ld</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="n">ld</span><span class="p">,</span> <span class="n">blocks</span>
        <span class="c1"># get LD clusters</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="p">[[</span><span class="n">markers</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">connected_components</span><span class="p">(</span><span class="n">blocks</span><span class="p">))]</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LD blocks: &quot;</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LD clusters: &quot;</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">clusters</span>


    <span class="k">def</span> <span class="nf">__CodeHaplotypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">clusters</span><span class="p">):</span>
        <span class="c1"># apply CHP coding</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">haplotypes</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                <span class="c1"># when only wild-type haplotypes are present in a family, still code them instead of ignoring the family</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
                    <span class="n">pop</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span>
                        <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
                <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="n">tmp_person</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="p">,</span> <span class="n">person</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s1">&#39;00&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]:</span>
                        <span class="n">tmp_person</span><span class="o">+=</span><span class="p">[</span><span class="s1">&#39;?:&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmp_person</span><span class="o">+=</span><span class="p">[</span><span class="s1">&#39;1:&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_person</span><span class="p">)</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_person</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
                <span class="n">nonvar_hap_flag</span><span class="o">=</span><span class="kc">False</span>
                <span class="c1">#determine if wild-type haplotype is present in a family</span>
                <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="n">tmp_genes</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">for</span> <span class="n">tmpa</span> <span class="ow">in</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
                        <span class="k">if</span> <span class="s1">&#39;A&#39;</span> <span class="ow">in</span> <span class="n">tmpa</span> <span class="ow">or</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">tmpa</span><span class="p">:</span>
                            <span class="n">tmp_genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpa</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">tmp_genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpa</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">tmp_genes</span><span class="p">)</span><span class="o">==</span><span class="nb">set</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">]):</span>
                        <span class="c1">#non variant haplotype</span>
                        <span class="n">nonvar_hap_flag</span><span class="o">=</span><span class="kc">True</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">nonvar_hap_flag</span><span class="p">:</span>
                    <span class="c1">#if family don&#39;t have wild-type haplotype, add a fake one to ensure correct coding</span>
                    <span class="n">var_num</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                    <span class="n">fake_person</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;FAKEPERSON&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;1:&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">var_num</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fake_person</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">hidx</span><span class="p">,</span><span class="n">hap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">missing_persons</span><span class="p">:</span>
                        <span class="n">missing_person</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="p">,</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;?:&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                        <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">hidx</span><span class="p">]</span><span class="o">=</span><span class="n">missing_person</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">clusters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hap</span><span class="si">{0}</span><span class="se">\t</span><span class="si">{1}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]),</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">haplotypes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="p">[[</span><span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">],</span> <span class="n">clusters_idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">clusters</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Family LD clusters: &quot;</span><span class="p">,</span> <span class="n">clusters_idx</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Print</span><span class="p">()</span>
        <span class="c1"># line: [fid, sid, hap1, hap2]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetHaplotypes</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="c1"># this sample is not in VCF file. Every variant site should be missing</span>
                <span class="c1"># they have to be skipped for now</span>
                <span class="k">continue</span>
            <span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
            <span class="c1">#sub-region count for each sample individual</span>
            <span class="n">superMarkerCount</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">superMarkerCount</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">t_Marker</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">superMarkerCount</span><span class="p">):</span>
                <span class="n">t_pat1</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="n">t_Marker</span><span class="p">]</span>
                <span class="n">t_pat2</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="n">t_Marker</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">t_pat1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_pat1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">t_pat2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_pat2</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># get MAF</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;0&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">,[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetAlleleFrequencies</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="n">data</span><span class="o">.</span><span class="n">varnames_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="n">wt_maf</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wt_maf</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">wt_maf</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
            <span class="n">tmp_data_maf</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">tmp_data_maf</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">tmp_ratio</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">wt_maf</span><span class="p">)</span>
                        <span class="n">tmp_list</span><span class="o">=</span><span class="p">[</span><span class="n">wt_maf</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">tmp_ratio</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                            <span class="n">tmp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">wt_maf</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">tmpv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                                <span class="n">tmp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpv</span><span class="o">/</span><span class="n">tmp_ratio</span><span class="p">)</span>
                        <span class="n">tmp_data_maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmp_list</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmp_data_maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmp_data_maf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;marker freqs = &quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__AssignSNVHaplotypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
            <span class="c1"># each person&#39;s haplotype</span>
            <span class="n">data</span><span class="o">.</span><span class="n">varnames_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="n">token</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">missing_persons</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">token</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">token</span><span class="o">==</span><span class="s1">&#39;?&#39;</span><span class="p">:</span>
                            <span class="n">token</span><span class="o">=</span><span class="s1">&#39;0&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmp_token</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">tmp_token</span><span class="o">==</span><span class="s1">&#39;?&#39;</span><span class="p">:</span>
                            <span class="n">tmp_token</span><span class="o">=</span><span class="s1">&#39;0&#39;</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">tmp_token</span><span class="p">)</span>

            <span class="c1"># get MAF</span>
            <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]])]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span>
                              <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">haplotypes</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s1">&#39;00&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                <span class="n">t_maf</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">t_maf</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                            <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">t_maf</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
                <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="p">((</span><span class="n">t_maf</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">t_maf</span><span class="p">),)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;marker freqs = &quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__FormatHaplotypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">varnames</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">):</span>
        <span class="c1"># Reformat sample genotypes</span>
        <span class="c1">## Linhai Edit: Reformat to deal with recombination events in families</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recomb_perfam</span><span class="p">:</span>
            <span class="c1">#code recombination per family basis, no need to consider overlap across families</span>
            <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
                    <span class="k">continue</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">missings</span><span class="p">]</span> <span class="o">*</span> <span class="n">diff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#code recombination across families to generate sub-regions that extend across families</span>
            <span class="n">tmp_combined_recombPos</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">sorted_var</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">uniq_vars</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
            <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">fam</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">recombPos</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))):</span>
                        <span class="k">if</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">varnames</span><span class="p">[</span><span class="n">fam</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="c1">##remove recombination event if occurred at 1st RV</span>
                            <span class="k">del</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">fam</span><span class="p">][</span><span class="n">pair</span><span class="p">]</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">fam</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_combined_recombPos</span><span class="p">:</span>
                            <span class="n">tmp_combined_recombPos</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">pair</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">tmp_combined_recombPos</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
            <span class="n">tmp_all_recombs</span><span class="o">=</span><span class="p">[</span><span class="n">pair</span> <span class="k">for</span> <span class="n">pairs</span> <span class="ow">in</span> <span class="n">tmp_combined_recombPos</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
            <span class="n">sorted_combined_recombPos</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tmp_all_recombs</span><span class="p">)),</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
            <span class="n">recomb_fams</span><span class="o">=</span><span class="n">tmp_combined_recombPos</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="c1">##get sub-regions that applies to all families</span>
            <span class="k">for</span> <span class="n">varidx</span><span class="p">,</span><span class="n">variant</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_var</span><span class="p">):</span>
                <span class="n">included_fams</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">recomb_fams</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">recomb_region</span> <span class="ow">in</span> <span class="n">sorted_combined_recombPos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">varidx</span> <span class="o">&gt;</span> <span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">recomb_region</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">varidx</span> <span class="o">&lt;</span> <span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">recomb_region</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="c1">##if the variant is in a recombination region</span>
                        <span class="n">included_fams</span><span class="o">-=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">included_fams</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">recomb_fams</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="o">==</span><span class="p">[]:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">variant</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">==</span><span class="n">varidx</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">neighbour_recomb_flag</span><span class="o">=</span><span class="kc">False</span>
                            <span class="k">for</span> <span class="n">recomb_region</span> <span class="ow">in</span> <span class="n">sorted_combined_recombPos</span><span class="p">:</span>
                                <span class="n">recomb_idx</span><span class="o">=</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">recomb_region</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">recomb_idx</span><span class="o">==</span><span class="n">varidx</span><span class="p">:</span>
                                    <span class="n">neighbour_recomb_flag</span><span class="o">=</span><span class="kc">True</span>
                                    <span class="k">break</span>
                                <span class="k">elif</span> <span class="n">recomb_idx</span><span class="o">&gt;</span><span class="n">varidx</span><span class="p">:</span>
                                    <span class="k">break</span>
                            <span class="k">if</span> <span class="n">neighbour_recomb_flag</span><span class="p">:</span>
                                <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">variant</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">variant</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">variant</span><span class="p">])</span>
            <span class="c1">##Get the markers in families compliant with the sub_regions</span>
            <span class="k">for</span> <span class="n">sub_region</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">:</span>
                <span class="n">markers</span><span class="o">=</span><span class="p">{}</span>
                <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">recomb_fams</span><span class="p">:</span>
                    <span class="n">pidx</span><span class="o">=</span><span class="mi">0</span>
                    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">recombPos</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))):</span>
                        <span class="n">sub_region_start</span><span class="o">=</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sub_region</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">sub_region_end</span><span class="o">=</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sub_region</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">recomb_start</span><span class="o">=</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">recomb_end</span><span class="o">=</span><span class="n">sorted_var</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">sub_region_end</span> <span class="o">&lt;=</span> <span class="n">recomb_start</span><span class="p">:</span>
                            <span class="n">markers</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">=</span><span class="n">pidx</span>
                            <span class="k">break</span>
                        <span class="k">elif</span> <span class="n">sub_region_end</span> <span class="o">&gt;</span> <span class="n">recomb_start</span> <span class="ow">and</span> <span class="n">sub_region_start</span><span class="o">&gt;</span><span class="n">recomb_start</span> <span class="ow">and</span> <span class="n">sub_region_end</span><span class="o">&lt;</span><span class="n">recomb_end</span><span class="p">:</span>
                            <span class="c1">##within the recombination region</span>
                            <span class="n">markers</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
                            <span class="k">break</span>
                        <span class="n">pidx</span><span class="o">+=</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">fam</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">markers</span><span class="p">:</span>
                        <span class="n">markers</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span><span class="o">=</span><span class="n">pidx</span>
                <span class="n">data</span><span class="o">.</span><span class="n">complied_markers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">)</span>
            <span class="c1">#coordinates for sub_regions</span>
            <span class="n">data</span><span class="o">.</span><span class="n">coordinates_by_region</span><span class="o">=</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">sub_region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">sub_region</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">sub_region</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
                    <span class="k">continue</span>
                <span class="n">diff</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c1">##only one whole region with no recombination</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">*</span> <span class="n">diff</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">famid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                        <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">complied_markers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">fam</span><span class="p">]:</span>
                                <span class="n">famid</span><span class="o">=</span><span class="n">fam</span>
                        <span class="n">complied_data</span><span class="o">=</span><span class="p">[]</span>
                        <span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">complied_markers</span><span class="p">:</span>
                            <span class="n">complied_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">marker</span><span class="p">[</span><span class="n">famid</span><span class="p">]])</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">=</span><span class="n">complied_data</span>

    <span class="k">def</span> <span class="nf">__PedToHaplotype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ped</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;convert prephased ped format to haplotype format.</span>
<span class="sd">        Input: e.g. [[&#39;13346&#39;, &#39;5888&#39;, &#39;0&#39;, &#39;0&#39;, &#39;1&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;], [&#39;13346&#39;, &#39;5856&#39;, &#39;0&#39;, &#39;0&#39;, &#39;2&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;], [&#39;13346&#39;, &#39;5920&#39;, &#39;5888&#39;, &#39;5856&#39;, &#39;1&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;], [&#39;13346&#39;, &#39;6589&#39;, &#39;5888&#39;, &#39;5856&#39;, &#39;1&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;]]</span>
<span class="sd">        Output: e.g. ((&#39;13346&#39;, &#39;5856&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;), (&#39;13346&#39;, &#39;5856&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;), (&#39;13346&#39;, &#39;5888&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;), (&#39;13346&#39;, &#39;5888&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;), (&#39;13346&#39;, &#39;6589&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;), (&#39;13346&#39;, &#39;6589&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;), (&#39;13346&#39;, &#39;5920&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;), (&#39;13346&#39;, &#39;5920&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;))</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">haps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ped</span><span class="p">:</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span> <span class="k">else</span> <span class="s1">&#39;?:&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">5</span><span class="p">:]]</span>
            <span class="n">haps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span> <span class="k">else</span> <span class="s1">&#39;?:&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">5</span><span class="p">:]]</span>
            <span class="n">haps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">haps</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getRegion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.LinkageWriter-class">6.LinkageWriter class<a class="anchor-link" href="#6.LinkageWriter-class"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">LinkageWriter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_missing_append</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_f</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_by_region</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_position</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">missings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_missing</span> <span class="o">=</span> <span class="n">num_missing_append</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># new chrom entered,</span>
                <span class="c1"># commit whatever is in buffer before accepting new data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="c1"># write tped output</span>
        <span class="n">position</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getMidPosition</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># genotypes</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">gs</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># everyone&#39;s genotype is the same (most likely missing or monomorphic)</span>
                <span class="k">return</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tped</span> <span class="o">+=</span> <span class="n">env</span><span class="o">.</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">,</span> <span class="n">position</span><span class="p">]</span> <span class="o">+</span> \
                <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">gs</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_missing</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="c1"># freqs</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">+=</span> <span class="n">env</span><span class="o">.</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># have to expand each region into mutiple chunks to account for different recomb points</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">])</span>
            <span class="c1"># sub-chunk id</span>
            <span class="n">cid</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">skipped_chunk</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distance_by_region</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_converter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">position</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">coordinates_by_region</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gs</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">skipped_chunk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">cid</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tped</span> <span class="o">+=</span> \
                  <span class="n">env</span><span class="o">.</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cid</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_by_region</span><span class="p">[</span><span class="n">cid</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">position</span><span class="p">]</span> <span class="o">+</span> \
                  <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">g</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">num_missing</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># everyone&#39;s genotype is the same (most likely missing or monomorphic)</span>
                <span class="k">return</span> <span class="mi">2</span>
            <span class="c1"># freqs</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">:</span>
                <span class="n">cid</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">skipped_chunk</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">complied_markers</span><span class="p">:</span>
                        <span class="c1">#if recombination coded per family instead of across families</span>
                        <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                            <span class="k">break</span>
                        <span class="n">cid</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">+=</span> <span class="n">env</span><span class="o">.</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cid</span><span class="p">)]</span> <span class="o">+</span> \
                                                    <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">idx</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">matched_idx</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">complied_markers</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">cid</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">+=</span> <span class="n">env</span><span class="o">.</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cid</span><span class="p">)]</span> <span class="o">+</span> \
                                                <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">matched_idx</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">cid</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">+=</span> <span class="n">env</span><span class="o">.</span><span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cid</span><span class="p">)]</span> <span class="o">+</span> \
                                                <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chp</span> <span class="o">+=</span> <span class="s2">&quot;CHP Super Marker positions: &quot;</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">combined_regions</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">varnames_by_fam</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pattern_txt</span><span class="o">=</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">tmarker</span><span class="p">],</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span> <span class="p">))</span> <span class="k">for</span> <span class="n">tmarker</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">item</span><span class="p">]))]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">pattern_txt</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">varfam</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">varnames_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">],</span><span class="n">pattern_txt</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="n">env</span><span class="o">.</span><span class="n">batch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tped</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.chr</span><span class="si">{}</span><span class="s1">.tped&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span><span class="p">)),</span>
                          <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tped</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.chr</span><span class="si">{}</span><span class="s1">.freq&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span><span class="p">)),</span>
                          <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chp</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.chr</span><span class="si">{}</span><span class="s1">.chp&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span><span class="p">)),</span>
                          <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chp</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">varfam</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.chr</span><span class="si">{}</span><span class="s1">.var&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span><span class="p">)),</span>
                          <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">varfam</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tped</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chp</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">varfam</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prev_chrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span>

    <span class="k">def</span> <span class="nf">distance_converter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mid_position</span><span class="p">):</span>
        <span class="n">delta</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mid_position</span><span class="p">)</span><span class="o">/</span><span class="mf">1000000.0</span>
        <span class="n">distance</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_avg</span><span class="p">)</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
        <span class="n">distance_m</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_m</span><span class="p">)</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
        <span class="n">distance_f</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_f</span><span class="p">)</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">distance</span><span class="p">,</span><span class="n">distance_m</span><span class="p">,</span><span class="n">distance_f</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">getRegion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_avg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_f</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_avg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_f</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.EncoderWorker-class">7.EncoderWorker class<a class="anchor-link" href="#7.EncoderWorker-class"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">EncoderWorker</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queue</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">extractor</span><span class="p">,</span> <span class="n">coder</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="o">=</span> <span class="n">queue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numGrps</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extractor</span> <span class="o">=</span> <span class="n">extractor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maker</span> <span class="o">=</span> <span class="n">coder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">writer</span>

    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units processed {{</span><span class="si">{:.2%}</span><span class="s1">}} ...&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">total_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">numGrps</span><span class="p">),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
                    <span class="c1"># total mendelian errors found</span>
                    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">mendelerror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                        <span class="n">env</span><span class="o">.</span><span class="n">mendelerror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">CountMendelianErrors</span><span class="p">()</span>
                    <span class="c1"># total recombination events found</span>
                    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">recomb_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                        <span class="n">env</span><span class="o">.</span><span class="n">recomb_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">CountRecombinations</span><span class="p">()</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">total_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                        <span class="n">env</span><span class="o">.</span><span class="n">total_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">extractor</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
                    <span class="n">isSuccess</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">extractor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maker</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">]:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                                <span class="c1"># previous module failed</span>
                                <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                                <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                                <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">isSuccess</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">isSuccess</span><span class="p">:</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                            <span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">total_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">%</span> <span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Old-version">Old version<a class="anchor-link" href="#Old-version"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">RData</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples_vcf</span><span class="p">,</span> <span class="n">tfam</span><span class="p">):</span>
        <span class="c1"># tfam.samples: a dict of {sid:[fid, pid, mid, sex, trait], ...}</span>
        <span class="c1"># tfam.families: a dict of {fid:[s1, s2 ...], ...}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tfam</span> <span class="o">=</span> <span class="n">tfam</span>
        <span class="c1"># samples have to be in both vcf and tfam data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">samples_vcf</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">])</span>
        <span class="c1"># a dict of {fid:[member names], ...}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">families</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">}</span>
        <span class="c1"># a dict of {fid:[idx ...], ...}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">famsampidx</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># a dict of {fid:[maf1, maf2 ...]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maf</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># reorder family samples based on order of VCF file</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># skip families having no samples in VCF file</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">famsampidx</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
        <span class="c1"># a dict of {fid:[idx ...], ...}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">famvaridx</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gss</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#test line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variants</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maf</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># superMarkerCount is the max num. of recombinant fragments among all fams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gss</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#test line</span>

    <span class="k">def</span> <span class="nf">getMidPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getFamVariants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fam</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span> <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">fam</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;map&quot;</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">mafs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">fam</span><span class="p">]:</span>
                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">mafs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">names</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">mafs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown style &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">style</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">getFamSamples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fam</span><span class="p">):</span>
        <span class="n">nvar</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span> <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">[</span><span class="n">fam</span><span class="p">]])</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">fam</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">sort_family</span><span class="p">(</span><span class="n">fam</span><span class="p">)):</span>
            <span class="c1"># sample info, first 5 columns of ped</span>
            <span class="n">output</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">item</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># sample genotypes</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">:</span>
                <span class="n">output</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;00&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">nvar</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Old-maker">Old maker<a class="anchor-link" href="#Old-maker"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegionExtractor" class="doc_header"><code>class</code> <code>RegionExtractor</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Core.py#L168" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegionExtractor</code>(<strong><code>filename</code></strong>, <strong><code>build</code></strong>=<em><code>None</code></em>, <strong><code>chr_prefix</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract given genomic region from VCF
converting genotypes into dictionary of
genotype list</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MarkerMaker" class="doc_header"><code>class</code> <code>MarkerMaker</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Core.py#L307" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MarkerMaker</code>(<strong><code>wsize</code></strong>, <strong><code>maf_cutoff</code></strong>=<em><code>None</code></em>, <strong><code>recomb</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LinkageWriter" class="doc_header"><code>class</code> <code>LinkageWriter</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Core.py#L527" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LinkageWriter</code>(<strong><code>num_missing_append</code></strong>=<em><code>0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EncoderWorker" class="doc_header"><code>class</code> <code>EncoderWorker</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Core.py#L614" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EncoderWorker</code>(<strong><code>queue</code></strong>, <strong><code>length</code></strong>, <strong><code>data</code></strong>, <strong><code>extractor</code></strong>, <strong><code>coder</code></strong>, <strong><code>writer</code></strong>) :: <code>Process</code></p>
</blockquote>
<p>Process objects represent activity that is run in a separate process</p>
<p>The class is analogous to <code>threading.Thread</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Main-function">Main function<a class="anchor-link" href="#Main-function"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">checkParams</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Binary trait detected in [/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/data/mwe_normal_fam.csv]</span>
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">freq</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;AF&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">no_save</span><span class="p">:</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">NoCache</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">Cache</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
<span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;vcf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading regional marker data from archive ...&#39;</span><span class="p">)</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CACHE&#39;</span><span class="p">])</span>
    <span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">fileLinesCount</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/*.tped&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">))))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">batch</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># load VCF file header</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">RData</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">tfam</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">anno</span><span class="p">,</span><span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span><span class="n">allele_freq_info</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">vs</span>
    <span class="n">samples_vcf</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">samples_vcf</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fail to extract samples from [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">),</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> samples found in [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">),</span> <span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">))</span>
<span class="n">samples_not_vcf</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">samples_not_vcf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>anno (2036189, 6)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 7 samples found in FAM file but not in VCF file:
28_9_186, 22_1_10, 1036_2, 22_1_20, 28_9_101, 1036_1, 28_9_100</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3,461 samples in VCF file will be ignored due to absence in FAM file</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3,479 samples found in [/mnt/mfs/statgen/alzheimers-family/linkage_files/geno/full_sample/vcf/full_sample.vcf.gz]</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">samples_not_vcf</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(7, 3479)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No valid family to process. &#39;</span> \
              <span class="s1">&#39;Families have to be at least trio with at least one member in VCF file.&#39;</span><span class="p">,</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No valid sample to process. &#39;</span> \
              <span class="s1">&#39;Samples have to be in families, and present in both TFAM and VCF files.&#39;</span><span class="p">,</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">rewriteFamfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.tfam&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)),</span>
               <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="n">samples_not_vcf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">single_markers</span><span class="p">:</span>
    <span class="n">regions</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vs</span><span class="o">.</span><span class="n">GetGenomeCoordinates</span><span class="p">():</span>
        <span class="n">region_info</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">region_info</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
            <span class="n">regions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_info</span><span class="p">)</span>
    <span class="n">args</span><span class="o">.</span><span class="n">blueprint</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># load blueprint</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot load regional marker blueprint [</span><span class="si">{}</span><span class="s2">]. &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">),</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> families with a total of </span><span class="si">{:,d}</span><span class="s1"> samples will be scanned for </span><span class="si">{:,d}</span><span class="s1"> pre-defined units&#39;</span><span class="o">.</span>\
        <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)))</span>
<span class="n">env</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">jobs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">regions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)</span>
<span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">jobs</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">Queue</span><span class="p">()</span>  
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 families with a total of 18 samples will be scanned for 28,325 pre-defined units</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Testing">Testing<a class="anchor-link" href="#Testing"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractor</span> <span class="o">=</span><span class="n">RegionExtractor</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">,</span> <span class="n">build</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">build</span><span class="p">,</span><span class="n">chr_prefix</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">chr_prefix</span><span class="p">)</span>
<span class="n">maker</span> <span class="o">=</span>            <span class="n">MarkerMaker</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">bin</span><span class="p">,</span> <span class="n">maf_cutoff</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">)</span>
<span class="n">writer</span> <span class="o">=</span>             <span class="n">LinkageWriter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples_not_vcf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">regions</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">]):</span><span class="c1">#[:20]):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#for region in rg:</span>
    <span class="n">extractor</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="n">maker</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="n">isSuccess</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="n">extractor</span><span class="p">,</span> <span class="n">maker</span><span class="p">,</span> <span class="n">writer</span><span class="p">]:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1">#print(data,data.genotype_all)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                <span class="c1"># previous module failed</span>
                <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">isSuccess</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">isSuccess</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
            <span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="k">1000</span>==0:
        <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">),</span><span class="n">region</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;V6-13273&#39; &#39;V10-13302&#39; &#39;V15-13417&#39;] [13273, 13302, 13417] [1.886e-01 9.542e-05 1.477e-01]
[&#39;V6-13273&#39; &#39;V13-13380&#39; &#39;V15-13417&#39;]Estimating allele frequencies... [using maximum likelihood]0
   V6-13273 V10-13302 V15-13417 

V6-13273: 0 0.707106 0.292894 
total familyCount:1
V10-13302: 0 0.75 0.25 
total familyCount:1
V15-13417: 0 0.75 0.25 
total familyCount:1
 [13273, 13380, 13417] [2.165e-01 1.980e-05 1.712e-01]
[] Estimating allele frequencies... [using maximum likelihood]0
   V6-13273 V13-13380 V15-13417 

V6-13273: 0 0.744757 0.255243 
total familyCount:1
V13-13380: 0 0.744757 0.255243 
total familyCount:1
V15-13417: 0 0.744757 0.255243 
total familyCount:1
[] []
0 3 23 [&#39;1&#39;, &#39;11868&#39;, &#39;14362&#39;, &#39;LOC102725121@1&#39;, &#39;9.177127474362311e-07&#39;, &#39;1.1657192989882668e-06&#39;, &#39;6.814189157634088e-07&#39;]
[&#39;V6-13273&#39; &#39;V10-13302&#39; &#39;V15-13417&#39;] [13273, 13302, 13417] [1.886e-01 9.542e-05 1.477e-01]
[&#39;V6-13273&#39; &#39;V13-13380&#39; &#39;V15-13417&#39;] [13273, 13380, 13417] [2.165e-01 1.980e-05 1.712e-01]
Estimating allele frequencies... [using maximum likelihood]0
   V6-13273 V10-13302 V15-13417 

V6-13273: 0 0.707106 0.292894 
total familyCount:1
V10-13302: 0 0.75 0.25 
total familyCount:1
V15-13417: 0 0.75 0.25 
total familyCount:1
[] [] []
Estimating allele frequencies... [using maximum likelihood]0
   V6-13273 V13-13380 V15-13417 

V6-13273: 0 0.744757 0.255243 
total familyCount:1
V13-13380: 0 0.744757 0.255243 
total familyCount:1
V15-13417: 0 0.744757 0.255243 
total familyCount:1
[&#39;V3-14464&#39; &#39;V8-14653&#39; &#39;V16-14907&#39; &#39;V17-14930&#39; &#39;V18-14933&#39; &#39;V36-16103&#39;
 &#39;V44-16378&#39; &#39;V49-16487&#39; &#39;V71-17358&#39; &#39;V77-17385&#39; &#39;V81-17407&#39; &#39;V114-17697&#39;
 &#39;V139-17928&#39; &#39;V140-17929&#39; &#39;V146-20184&#39; &#39;V147-20191&#39; &#39;V149-20212&#39;
 &#39;V152-20227&#39; &#39;V156-20235&#39; &#39;V158-20250&#39; &#39;V165-20316&#39; &#39;V167-20485&#39;
 &#39;V169-20522&#39; &#39;V171-20547&#39; &#39;V180-29368&#39;] [14464, 14653, 14907, 14930, 14933, 16103, 16378, 16487, 17358, 17385, 17407, 17697, 17928, 17929, 20184, 20191, 20212, 20227, 20235, 20250, 20316, 20485, 20522, 20547, 29368] [0.1907 0.4209 0.335  0.2784 0.0084 0.0294 0.5035 0.0695 0.0017 0.2078
 0.0224 0.1217 0.0146 0.0136 0.0305 0.075  0.0933 0.0745 0.0926 0.3311
 0.3091 0.003  0.0031 0.3041 0.0084]
[&#39;V3-14464&#39; &#39;V8-14653&#39; &#39;V9-14677&#39; &#39;V16-14907&#39; &#39;V17-14930&#39; &#39;V36-16103&#39;
 &#39;V44-16378&#39; &#39;V49-16487&#39; &#39;V72-17365&#39; &#39;V77-17385&#39; &#39;V78-17398&#39; &#39;V81-17407&#39;
 &#39;V86-17479&#39; &#39;V99-17559&#39; &#39;V114-17697&#39; &#39;V119-17722&#39; &#39;V121-17746&#39;
 &#39;V131-17829&#39; &#39;V142-19190&#39; &#39;V146-20184&#39; &#39;V147-20191&#39; &#39;V149-20212&#39;
 &#39;V152-20227&#39; &#39;V156-20235&#39; &#39;V158-20250&#39; &#39;V165-20316&#39; &#39;V171-20547&#39;]Estimating allele frequencies... [using maximum likelihood]0
   V3-14464 V8-14653 V16-14907 V17-14930 V18-14933 V36-16103 V44-16378 
   V49-16487 V71-17358 V77-17385 V81-17407 V114-17697 V139-17928 V140-17929 
   V146-20184 V147-20191 V149-20212 V152-20227 V156-20235 V158-20250 
   V165-20316 V167-20485 V169-20522 V171-20547 V180-29368 

V3-14464: 0 0.75 0.25 
total familyCount:1
V8-14653: 0 0.75 0.25 
total familyCount:1
V16-14907: 0 0.5 0.5 
total familyCount:1
V17-14930: 0 0.5 0.5 
total familyCount:1
V18-14933: 0 1 
total familyCount:1
V36-16103: 0 0.707106 0.292894 
total familyCount:1
V44-16378: 0 0.5 0.5 
total familyCount:1
V49-16487: 0 0.75 0.25 
total familyCount:1
V71-17358: 0 1 
total familyCount:1
V77-17385: 0 1 
total familyCount:1
V81-17407: 0 0.5 0.5 
total familyCount:1
V114-17697: 0 0.5 0.5 
total familyCount:1
 [14464, 14653, 14677, 14907, 14930, 16103, 16378, 16487, 17365, 17385, 17398, 17407, 17479, 17559, 17697, 17722, 17746, 17829, 19190, 20184, 20191, 20212, 20227, 20235, 20250, 20316, 20547] [3.038e-01 4.487e-01 7.190e-02 3.680e-01 3.322e-01 2.290e-02 4.994e-01
 9.850e-02 2.210e-02 2.135e-01 3.000e-04 2.090e-02 1.000e-04 2.000e-04
 1.783e-01 2.810e-02 3.420e-02 1.150e-02 2.301e-05 3.830e-02 1.485e-01
 1.807e-01 1.247e-01 5.090e-02 3.512e-01 3.466e-01 3.344e-01]
[&#39;V3-14464&#39; &#39;V5-14470&#39; &#39;V8-14653&#39; &#39;V9-14677&#39; &#39;V16-14907&#39; &#39;V17-14930&#39;
 &#39;V31-16068&#39; &#39;V36-16103&#39; &#39;V44-16378&#39; &#39;V76-17379&#39; &#39;V77-17385&#39; &#39;V82-17408&#39;
 &#39;V96-17519&#39; &#39;V98-17556&#39; &#39;V107-17614&#39; &#39;V142-19190&#39; &#39;V145-20166&#39;
 &#39;V147-20191&#39; &#39;V149-20212&#39; &#39;V152-20227&#39; &#39;V153-20227&#39; &#39;V156-20235&#39;
 &#39;V158-20250&#39; &#39;V161-20254&#39; &#39;V165-20316&#39; &#39;V170-20545&#39; &#39;V171-20547&#39;
 &#39;V180-29368&#39;] [14464, 14470, 14653, 14677, 14907, 14930, 16068, 16103, 16378, 17379, 17385, 17408, 17519, 17556, 17614, 19190, 20166, 20191, 20212, 20227, 20227, 20235, 20250, 20254, 20316, 20545, 20547, 29368] [3.038e-01 5.100e-03 4.487e-01 7.190e-02 3.680e-01 3.322e-01 2.400e-03
 2.290e-02 4.994e-01 8.800e-03 2.135e-01 1.040e-02 4.100e-03 1.790e-02
 5.700e-02 2.301e-05 1.064e-01 1.485e-01 1.807e-01 1.247e-01 7.220e-02
 5.090e-02 3.512e-01 1.430e-02 3.466e-01 1.400e-03 3.344e-01 1.110e-02]
V139-17928: 0 0.5 0.5 
total familyCount:1
V140-17929: 0 0.5 0.5 
total familyCount:1
V146-20184: 0 0.5 0.5 
total familyCount:1
V147-20191: 0 1 
total familyCount:1
V149-20212: 0 1 
total familyCount:1
V152-20227: 0 1 
total familyCount:1
V156-20235: 0 1 
total familyCount:1
V158-20250: 0 1 
total familyCount:1
V165-20316: 0 1 
total familyCount:1
V167-20485: 0 1 
total familyCount:1
V169-20522: 0 1 
total familyCount:1
V171-20547: 0 0.75 0.25 
total familyCount:1
V180-29368: 0 1 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V3-14464 V8-14653 V9-14677 V16-14907 V17-14930 V36-16103 V44-16378 
   V49-16487 V72-17365 V77-17385 V78-17398 V81-17407 V86-17479 V99-17559 
   V114-17697 V119-17722 V121-17746 V131-17829 V142-19190 V146-20184 
   V147-20191 V149-20212 V152-20227 V156-20235 V158-20250 V165-20316 
   V171-20547 

V3-14464: 0 0.739454 0.260546 
total familyCount:1
V8-14653: 0 0.707103 0.292897 
total familyCount:1
V9-14677: 0 0.739454 0.260546[&#39;V4-17385&#39; &#39;V8-17407&#39;] 
total familyCount:1
V16-14907: 0 0.707103 0.292897 
total familyCount:1
V17-14930: 0 0.728713 0.271287 
total familyCount:1
V36-16103: 0 0.5 0.5 
total familyCount:1
V44-16378: 0 0.5 0.5 
total familyCount:1
V49-16487: 0 0.744757 0.255243 
total familyCount:1
V72-17365: 0 0.744757 0.255243 
total familyCount:1
V77-17385: 0 0.739454 0.260546 
total familyCount:1
V78-17398: 0 0.744757 0.255243 
total familyCount:1
V81-17407: 0 0.744757 0.255243 
total familyCount:1
V86-17479: 0 0.744757 0.255243 
total familyCount:1
V99-17559: 0 0.744757 0.255243 
total familyCount:1
V114-17697: 0 0.739454 0.260546 
total familyCount:1
V119-17722: 0 0.744757 0.255243 
total familyCount:1
V121-17746: 0 0.739454 0.260546 
total familyCount:1
V131-17829: 0 0.744757 0.255243 
total familyCount:1
V142-19190: 0 0.739454 0.260546 
total familyCount:1
V146-20184: 0 0.744757 0.255243 
total familyCount:1
V147-20191: 0 0.744757 0.255243 
total familyCount:1
V149-20212: 0 0.744757 0.255243 
total familyCount:1
V1 [17385, 17407] [0.2078 0.0224]
[&#39;V4-17385&#39; &#39;V5-17398&#39; &#39;V8-17407&#39;] [17385, 17398, 17407] [0.2135 0.0003 0.0209]
52-20227: 0 0.744757 0.255243 
total familyCount:1
V156-20235: 0 0.744757 0.255243 
total familyCount:1
V158-20250: 0 0.739454 0.260546 
total familyCount:1
V165-20316: 0 0.739454 0.260546 
total familyCount:1
V171-20547: 0 0.739454 0.260546 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V3-14464 V5-14470 V8-14653 V9-14677 V16-14907 V17-14930 V31-16068 V36-16103 
   V44-16378 V76-17379 V77-17385 V82-17408 V96-17519 V98-17556 V107-17614 
   V142-19190 V145-20166 V147-20191 V149-20212 V152-20227 V153-20227 
   V156-20235 V158-20250 V161-20254 V165-20316 V170-20545 V171-20547 
   V180-29368 

V3-14464: 0 0.646634 0.353366 
total familyCount:1
V5-14470: 0 0.824706 0.175294 
total familyCount:1
V8-14653: 0 0.452863 0.547137 
total familyCount:1
V9-14677: 0 0.656432 0.343568 
total familyCount:1
V16-14907: 0 0.5 0.5 
total familyCount:1
V17-14930: 0 0.628665 0.371335 
total familyCount:1
V31-16068: 0 0.5 0.5 
total familyCount:1
V36-16103: 0 0.628667 0.3[&#39;V3-17379&#39; &#39;V4-17385&#39; &#39;V9-17408&#39;] [17379, 17385, 17408] [0.0088 0.2135 0.0104]
71333 
total familyCount:1
V44-16378: 0 0.617751 0.382249 
total familyCount:1
V76-17379: 0 0.824706 0.175294 
total familyCount:1
V77-17385: 0 0.5 0.5 
total familyCount:1
V82-17408: 0 0.824706 0.175294 
total familyCount:1
V96-17519: 0 0.824706 0.175294 
total familyCount:1
V98-17556: 0 0.820231 0.179769 
total familyCount:1
V107-17614: 0 0.824706 0.175294 
total familyCount:1
V142-19190: 0 0.6 0.4 
total familyCount:1
V145-20166: 0 0.628665 0.371335 
total familyCount:1
V147-20191: 0 0.628665 0.371335 
total familyCount:1
V149-20212: 0 0.628665 0.371335 
total familyCount:1
V152-20227: 0 0.656432 0.343568 
total familyCount:1
V153-20227: 0 0.646634 0.353366 
total familyCount:1
V156-20235: 0 0.824706 0.175294 
total familyCount:1
V158-20250: 0 0.628665 0.371335 
total familyCount:1
V161-20254: 0 0.824706 0.175294 
total familyCount:1
V165-20316: 0 0.628665 0.371335 
total familyCount:1
V170-20545: 0 0.820231 0.179769 
total familyCount:1
V171-20547: 0 0.617751 0.382249 
total familyCount:1
V180-29368: 0 0.656432 0.343568 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0          
   V4-17385 V8-17407 

V4-17385: 0 1 
total familyCount:1
V8-17407: 0 0.5 0.5 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V4-17385 V5-17398 V8-17407 

V4-17385: 0 0.739454 0.260546 
total familyCount:1
V5-17398: 0 0.744757 0.255243 
total familyCount:1
V8-17407: 0 0.744757 0.255243 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V3-17379 V4-17385 V9-17408 

V3-17379: 0 0.824706 0.175294 
total familyCount:1
V4-17385: 0 0.5 0.5 
total familyCount:1
V9-17408: 0 0.824706 0.175294 
total familyCount:1
1000 1 0 [&#39;1&#39;, &#39;61742479&#39;, &#39;62163915&#39;, &#39;PATJ&#39;, &#39;94.08912254193991&#39;, &#39;118.69606841169087&#39;, &#39;71.63174343660968&#39;]
2000 1 0 [&#39;1&#39;, &#39;162790701&#39;, &#39;162812818&#39;, &#39;HSD17B7&#39;, &#39;168.91829636079495&#39;, &#39;218.49549236802426&#39;, &#39;122.20452659549645&#39;]
3000 1 0 [&#39;2&#39;, &#39;27212359&#39;, &#39;27217182&#39;, &#39;ATRAID&#39;, &#39;48.19894998090023&#39;, &#39;54.585310839481366&#39;, &#39;42.49830744092714&#39;]
4000 1 0 [&#39;2&#39;, &#39;168920780&#39;, &#39;169031324&#39;, &#39;ABCB11&#39;, &#39;174.1718395156357&#39;, &#39;222.22338807109554&#39;, &#39;127.6844708222256&#39;]
5000 1 0 [&#39;3&#39;, &#39;47413680&#39;, &#39;47475941&#39;, &#39;SCAP&#39;, &#39;68.99620573382401&#39;, &#39;81.61445932132666&#39;, &#39;57.9855449134992&#39;]
6000 1 0 [&#39;3&#39;, &#39;184230352&#39;, &#39;184242329&#39;, &#39;VWA5B2&#39;, &#39;192.1275334861548&#39;, &#39;247.45672160907745&#39;, &#39;139.2580545053618&#39;]
7000 1 0 [&#39;4&#39;, &#39;138164096&#39;, &#39;138242349&#39;, &#39;SLC7A11&#39;, &#39;140.35374100483878&#39;, &#39;186.05001188945482&#39;, &#39;97.20783019850205&#39;]
8000 1 0 [&#39;5&#39;, &#39;132190146&#39;, &#39;132227853&#39;, &#39;P4HA2&#39;, &#39;138.85770413097532&#39;, &#39;173.97439801388742&#39;, &#39;105.14936291323124&#39;]
9000 1 0 [&#39;6&#39;, &#39;31615233&#39;, &#39;31617015&#39;, &#39;AIF1&#39;, &#39;53.57404706283638&#39;, &#39;56.98460061173304&#39;, &#39;51.484032621407884&#39;]
10000 1 0 [&#39;6&#39;, &#39;167155246&#39;, &#39;167157980&#39;, &#39;GPR31&#39;, &#39;187.8212404552102&#39;, &#39;243.3868606324144&#39;, &#39;134.9096549771634&#39;]
11000 1 0 [&#39;7&#39;, &#39;113080412&#39;, &#39;113087778&#39;, &#39;GPR85&#39;, &#39;121.94724950804803&#39;, &#39;163.03027920118186&#39;, &#39;82.53468270653605&#39;]
12000 1 0 [&#39;8&#39;, &#39;81478418&#39;, &#39;81483233&#39;, &#39;FABP4&#39;, &#39;95.00012872224329&#39;, &#39;125.79097683477232&#39;, &#39;65.891333925847&#39;]
13000 1 0 [&#39;9&#39;, &#39;95085207&#39;, &#39;95085304&#39;, &#39;MIR23B&#39;, &#39;100.77698198363763&#39;, &#39;124.30346632003499&#39;, &#39;78.55681544180344&#39;]
14000 1 0 [&#39;10&#39;, &#39;58325628&#39;, &#39;58329679&#39;, &#39;LOC112268068&#39;, &#39;74.88956742062021&#39;, &#39;94.58971593360282&#39;, &#39;57.27601225803206&#39;]
15000 1 0 [&#39;11&#39;, &#39;12286899&#39;, &#39;12362138&#39;, &#39;MICALCL&#39;, &#39;25.200421811362663&#39;, &#39;19.780182273947002&#39;, &#39;30.47861020169645&#39;]
16000 1 0 [&#39;11&#39;, &#39;101890673&#39;, &#39;101916522&#39;, &#39;ANGPTL5&#39;, &#39;109.59131065684834&#39;, &#39;139.3668510208155&#39;, &#39;80.95094926518013&#39;]
17000 1 0 [&#39;12&#39;, &#39;54395260&#39;, &#39;54419266&#39;, &#39;ITGA5&#39;, &#39;72.35531487721212&#39;, &#39;85.30635133411202&#39;, &#39;60.57391809500565&#39;]
18000 1 0 [&#39;13&#39;, &#39;46455203&#39;, &#39;46466776&#39;, &#39;LINC01198&#39;, &#39;50.167966040012665&#39;, &#39;57.175574695883995&#39;, &#39;43.125175052271366&#39;]
19000 1 0 [&#39;14&#39;, &#39;86905777&#39;, &#39;86922755&#39;, &#39;LINC01148&#39;, &#39;84.32939464542692&#39;, &#39;103.04064213211844&#39;, &#39;66.78106340164302&#39;]
20000 1 0 [&#39;15&#39;, &#39;73873563&#39;, &#39;73889214&#39;, &#39;TBC1D21&#39;, &#39;77.64806530153696&#39;, &#39;97.22184379127768&#39;, &#39;58.61042722911022&#39;]
21000 1 0 [&#39;16&#39;, &#39;33495800&#39;, &#39;33496235&#39;, &#39;LOC390705@2&#39;, &#39;59.597025459459736&#39;, &#39;64.51252841288981&#39;, &#39;55.757286567026384&#39;]
22000 1 0 [&#39;17&#39;, &#39;28360653&#39;, &#39;28360734&#39;, &#39;MIR4723&#39;, &#39;53.29906731104194&#39;, &#39;56.137810791384275&#39;, &#39;49.8686532838509&#39;]
23000 1 0 [&#39;17&#39;, &#39;79823451&#39;, &#39;79827704&#39;, &#39;LINC01977&#39;, &#39;129.41707434188964&#39;, &#39;161.0935891249485&#39;, &#39;98.15793907670367&#39;]
24000 1 0 [&#39;19&#39;, &#39;12953118&#39;, &#39;12957223&#39;, &#39;GADD45GIP1&#39;, &#39;33.20123193440195&#39;, &#39;31.021078181726253&#39;, &#39;35.714493705610096&#39;]
25000 1 0 [&#39;19&#39;, &#39;51964339&#39;, &#39;51986840&#39;, &#39;ZNF350&#39;, &#39;89.6950481101567&#39;, &#39;113.9831205106624&#39;, &#39;66.44497607852102&#39;]
26000 1 0 [&#39;20&#39;, &#39;62143768&#39;, &#39;62182514&#39;, &#39;SS18L1&#39;, &#39;110.30700665717275&#39;, &#39;124.48353231287628&#39;, &#39;98.56286538747486&#39;]
27000 1 0 [&#39;22&#39;, &#39;43110749&#39;, &#39;43129712&#39;, &#39;BIK&#39;, &#39;54.13818873093194&#39;, &#39;71.04904715507725&#39;, &#39;37.884233842626216&#39;]
28000 1 0 [&#39;X&#39;, &#39;130494940&#39;, &#39;130497447&#39;, &#39;DENND10P1&#39;, &#39;NA&#39;, &#39;146.88487435565696&#39;, &#39;NA&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="s1">&#39;PAPPA2&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;dregions&#39;,
              [[&#39;1&#39;,
                &#39;176463174&#39;,
                &#39;176845601&#39;,
                &#39;PAPPA2&#39;,
                &#39;186.27975412824702&#39;,
                &#39;238.992712111315&#39;,
                &#39;136.40298421566155&#39;]]),
             (&#39;dvariants&#39;, []),
             (&#39;dfamvaridx&#39;, []),
             (&#39;dgeno&#39;, []),
             (&#39;gss&#39;, []),
             (&#39;hapimp&#39;, {}),
             (&#39;ld&#39;, []),
             (&#39;coder&#39;, {}),
             (&#39;format&#39;, [])])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="s1">&#39;MC1R&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;dregions&#39;,
              [[&#39;16&#39;,
                &#39;89918861&#39;,
                &#39;89920972&#39;,
                &#39;MC1R&#39;,
                &#39;133.68971029636177&#39;,
                &#39;159.0516420273219&#39;,
                &#39;111.19712545131974&#39;]]),
             (&#39;dvariants&#39;, []),
             (&#39;dfamvaridx&#39;, []),
             (&#39;dgeno&#39;, []),
             (&#39;gss&#39;, []),
             (&#39;hapimp&#39;, {}),
             (&#39;ld&#39;, []),
             (&#39;coder&#39;, {}),
             (&#39;format&#39;, [])])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="s1">&#39;WASH7P&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;dregions&#39;,
              [[&#39;1&#39;,
                &#39;14361&#39;,
                &#39;29370&#39;,
                &#39;WASH7P&#39;,
                &#39;1.5299877409602128e-06&#39;,
                &#39;1.94345806118021e-06&#39;,
                &#39;1.136044574393209e-06&#39;]]),
             (&#39;dvariants&#39;,
              [[[&#39;1&#39;, 14378, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14429, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14458, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14464, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14469, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14470, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14488, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14521, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14653, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14677, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14731, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14742, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14747, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14773, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14792, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14843, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14907, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14930, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14933, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15207, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15219, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15219, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15746, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15773, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15777, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15811, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15835, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15849, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15913, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15989, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16006, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16068, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16071, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16079, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16101, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16102, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16103, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16127, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16128, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16158, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16206, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16280, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16310, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16337, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16378, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16397, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16443, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16451, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16474, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16487, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16531, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16555, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16633, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16722, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16731, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16731, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16734, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16911, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17005, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17135, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17146, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17147, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17151, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17181, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17212, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17213, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17217, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17222, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17223, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17289, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17353, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17358, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17365, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17373, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17375, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17378, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17379, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17385, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17398, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17403, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17406, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17407, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17408, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17452, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17453, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17478, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17479, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17483, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17484, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17492, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17493, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17496, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17501, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17511, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17512, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17517, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17519, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17538, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17556, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17559, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17563, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17569, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17585, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17589, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17594, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17596, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17606, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17614, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17626, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17647, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17672, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17688, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17689, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17695, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17697, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17701, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17709, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17716, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17721, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17722, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17728, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17746, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17747, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17748, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17750, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17753, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17765, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17765, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17767, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17781, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17805, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17829, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17842, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17843, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17844, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17853, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17854, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17901, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17904, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17928, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17929, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19190, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19190, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19254, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19535, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20166, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20184, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20191, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20210, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20212, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20217, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20225, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20227, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20227, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20231, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20231, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20235, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20237, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20250, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20251, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20253, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20254, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20273, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20280, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20297, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20316, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20443, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20485, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20496, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20522, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20545, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20547, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20552, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20554, &#39;WASH7P&#39;],
                [&#39;1&#39;, 28588, &#39;WASH7P&#39;],
                [&#39;1&#39;, 28588, &#39;WASH7P&#39;],
                [&#39;1&#39;, 28588, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29278, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29300, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29359, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29368, &#39;WASH7P&#39;]]]),
             (&#39;dfamvaridx&#39;,
              [{&#39;1036&#39;: [3,
                 8,
                 16,
                 17,
                 18,
                 36,
                 44,
                 49,
                 71,
                 77,
                 81,
                 114,
                 139,
                 140,
                 146,
                 147,
                 149,
                 152,
                 156,
                 158,
                 165,
                 167,
                 169,
                 171,
                 180],
                &#39;22_1&#39;: [3,
                 8,
                 9,
                 16,
                 17,
                 36,
                 44,
                 49,
                 72,
                 77,
                 78,
                 81,
                 86,
                 99,
                 114,
                 119,
                 121,
                 131,
                 142,
                 146,
                 147,
                 149,
                 152,
                 156,
                 158,
                 165,
                 171],
                &#39;28_9&#39;: [3,
                 5,
                 8,
                 9,
                 16,
                 17,
                 31,
                 36,
                 44,
                 76,
                 77,
                 82,
                 96,
                 98,
                 107,
                 142,
                 145,
                 147,
                 149,
                 152,
                 153,
                 156,
                 158,
                 161,
                 165,
                 170,
                 171,
                 180]}]),
             (&#39;dgeno&#39;,
              [{&#39;28_9_103&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_106&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;00&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;00&#39;,
                 &#39;00&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;28_9_108&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;28_9_109&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;00&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_111&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;28_9_105&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_114&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_110&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;1036_5&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;1036_99&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;1036_6&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;00&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;1036_4&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;1036_3&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;22_1_2&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;],
                &#39;22_1_3&#39;: [&#39;11&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;22_1_4&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;22_1_5&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;22_1_99&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;1036_1&#39;: [(&#39;1&#39;, &#39;0&#39;)],
                &#39;1036_2&#39;: [(&#39;3&#39;, &#39;0&#39;)],
                &#39;22_1_10&#39;: [(&#39;3&#39;, &#39;1&#39;)],
                &#39;22_1_20&#39;: [(&#39;1&#39;, &#39;2&#39;)]}]),
             (&#39;gss&#39;,
              [Empty DataFrame
               Columns: []
               Index: []]),
             (&#39;hapimp&#39;,
              {&#39;1036&#39;: [&#39;1036&#39;,
                array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V16-14907&#39;, &#39;V17-14930&#39;, &#39;V18-14933&#39;,
                       &#39;V36-16103&#39;, &#39;V44-16378&#39;, &#39;V49-16487&#39;, &#39;V71-17358&#39;, &#39;V77-17385&#39;,
                       &#39;V81-17407&#39;, &#39;V114-17697&#39;, &#39;V139-17928&#39;, &#39;V140-17929&#39;,
                       &#39;V146-20184&#39;, &#39;V147-20191&#39;, &#39;V149-20212&#39;, &#39;V152-20227&#39;,
                       &#39;V156-20235&#39;, &#39;V158-20250&#39;, &#39;V165-20316&#39;, &#39;V167-20485&#39;,
                       &#39;V169-20522&#39;, &#39;V171-20547&#39;, &#39;V180-29368&#39;], dtype=&#39;&lt;U10&#39;),
                [14464,
                 14653,
                 14907,
                 14930,
                 14933,
                 16103,
                 16378,
                 16487,
                 17358,
                 17385,
                 17407,
                 17697,
                 17928,
                 17929,
                 20184,
                 20191,
                 20212,
                 20227,
                 20235,
                 20250,
                 20316,
                 20485,
                 20522,
                 20547,
                 29368],
                array([0.1907, 0.4209, 0.335 , 0.2784, 0.0084, 0.0294, 0.5035, 0.0695,
                       0.0017, 0.2078, 0.0224, 0.1217, 0.0146, 0.0136, 0.0305, 0.075 ,
                       0.0933, 0.0745, 0.0926, 0.3311, 0.3091, 0.003 , 0.0031, 0.3041,
                       0.0084]),
                array([[&#39;1036&#39;, &#39;1036_1&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                        &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_1&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                       [&#39;1036&#39;, &#39;1036_2&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_2&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                       [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_99&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A2,1|&#39;,
                        &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;2/&#39;, &#39;A2,1|&#39;,
                        &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A2,1/&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;]], dtype=&#39;&lt;U7&#39;)],
               &#39;22_1&#39;: [&#39;22_1&#39;,
                array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V9-14677&#39;, &#39;V16-14907&#39;, &#39;V17-14930&#39;,
                       &#39;V36-16103&#39;, &#39;V44-16378&#39;, &#39;V49-16487&#39;, &#39;V72-17365&#39;, &#39;V77-17385&#39;,
                       &#39;V78-17398&#39;, &#39;V81-17407&#39;, &#39;V86-17479&#39;, &#39;V99-17559&#39;, &#39;V114-17697&#39;,
                       &#39;V119-17722&#39;, &#39;V121-17746&#39;, &#39;V131-17829&#39;, &#39;V142-19190&#39;,
                       &#39;V146-20184&#39;, &#39;V147-20191&#39;, &#39;V149-20212&#39;, &#39;V152-20227&#39;,
                       &#39;V156-20235&#39;, &#39;V158-20250&#39;, &#39;V165-20316&#39;, &#39;V171-20547&#39;],
                      dtype=&#39;&lt;U10&#39;),
                [14464,
                 14653,
                 14677,
                 14907,
                 14930,
                 16103,
                 16378,
                 16487,
                 17365,
                 17385,
                 17398,
                 17407,
                 17479,
                 17559,
                 17697,
                 17722,
                 17746,
                 17829,
                 19190,
                 20184,
                 20191,
                 20212,
                 20227,
                 20235,
                 20250,
                 20316,
                 20547],
                array([3.038e-01, 4.487e-01, 7.190e-02, 3.680e-01, 3.322e-01, 2.290e-02,
                       4.994e-01, 9.850e-02, 2.210e-02, 2.135e-01, 3.000e-04, 2.090e-02,
                       1.000e-04, 2.000e-04, 1.783e-01, 2.810e-02, 3.420e-02, 1.150e-02,
                       2.301e-05, 3.830e-02, 1.485e-01, 1.807e-01, 1.247e-01, 5.090e-02,
                       3.512e-01, 3.466e-01, 3.344e-01]),
                array([[&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                        &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1/&#39;,
                        &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;2|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2/&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1/&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A1,2/&#39;,
                        &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;]],
                      dtype=&#39;&lt;U7&#39;)],
               &#39;28_9&#39;: [&#39;28_9&#39;,
                array([&#39;V3-14464&#39;, &#39;V5-14470&#39;, &#39;V8-14653&#39;, &#39;V9-14677&#39;, &#39;V16-14907&#39;,
                       &#39;V17-14930&#39;, &#39;V31-16068&#39;, &#39;V36-16103&#39;, &#39;V44-16378&#39;, &#39;V76-17379&#39;,
                       &#39;V77-17385&#39;, &#39;V82-17408&#39;, &#39;V96-17519&#39;, &#39;V98-17556&#39;, &#39;V107-17614&#39;,
                       &#39;V142-19190&#39;, &#39;V145-20166&#39;, &#39;V147-20191&#39;, &#39;V149-20212&#39;,
                       &#39;V152-20227&#39;, &#39;V153-20227&#39;, &#39;V156-20235&#39;, &#39;V158-20250&#39;,
                       &#39;V161-20254&#39;, &#39;V165-20316&#39;, &#39;V170-20545&#39;, &#39;V171-20547&#39;,
                       &#39;V180-29368&#39;], dtype=&#39;&lt;U10&#39;),
                [14464,
                 14470,
                 14653,
                 14677,
                 14907,
                 14930,
                 16068,
                 16103,
                 16378,
                 17379,
                 17385,
                 17408,
                 17519,
                 17556,
                 17614,
                 19190,
                 20166,
                 20191,
                 20212,
                 20227,
                 20227,
                 20235,
                 20250,
                 20254,
                 20316,
                 20545,
                 20547,
                 29368],
                array([3.038e-01, 5.100e-03, 4.487e-01, 7.190e-02, 3.680e-01, 3.322e-01,
                       2.400e-03, 2.290e-02, 4.994e-01, 8.800e-03, 2.135e-01, 1.040e-02,
                       4.100e-03, 1.790e-02, 5.700e-02, 2.301e-05, 1.064e-01, 1.485e-01,
                       1.807e-01, 1.247e-01, 7.220e-02, 5.090e-02, 3.512e-01, 1.430e-02,
                       3.466e-01, 1.400e-03, 3.344e-01, 1.110e-02]),
                array([[&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;A1,2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;2:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;A2,1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;?:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;?:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2/&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;,
                        &#39;1|&#39;, &#39;1/&#39;],
                       [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;1/&#39;],
                       [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;?|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;2\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                        &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                        &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;?|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;?\\&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;?|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1\\&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;]],
                      dtype=&#39;&lt;U8&#39;)]}),
             (&#39;ld&#39;, []),
             (&#39;coder&#39;,
              {&#39;input&#39;: [{&#39;28_9_103&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_106&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;00&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;00&#39;,
                  &#39;00&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;28_9_108&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;28_9_109&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;00&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_111&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;28_9_105&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_114&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_110&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;1036_5&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;1036_99&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;1036_6&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;00&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;1036_4&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;1036_3&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;22_1_2&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;],
                 &#39;22_1_3&#39;: [&#39;11&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;22_1_4&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;22_1_5&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;22_1_99&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;1036_1&#39;: [(&#39;1&#39;, &#39;0&#39;)],
                 &#39;1036_2&#39;: [(&#39;3&#39;, &#39;0&#39;)],
                 &#39;22_1_10&#39;: [(&#39;3&#39;, &#39;1&#39;)],
                 &#39;22_1_20&#39;: [(&#39;1&#39;, &#39;2&#39;)]},
                OrderedDict([(&#39;1036&#39;,
                              array([[&#39;1036&#39;, &#39;1036_1&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                                      &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_1&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                                     [&#39;1036&#39;, &#39;1036_2&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_2&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                                     [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_99&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A2,1|&#39;,
                                      &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;2/&#39;, &#39;A2,1|&#39;,
                                      &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A2,1/&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;]], dtype=&#39;&lt;U7&#39;)),
                             (&#39;22_1&#39;,
                              array([[&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                                      &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1/&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;2|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2/&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1/&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A1,2/&#39;,
                                      &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;]],
                                    dtype=&#39;&lt;U7&#39;)),
                             (&#39;28_9&#39;,
                              array([[&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;A1,2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;2:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;A2,1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;?:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;?:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2/&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;1/&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;?|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;2\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                                      &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                                      &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;?|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;?\\&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;?|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1\\&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;]],
                                    dtype=&#39;&lt;U8&#39;))]),
                OrderedDict([(&#39;1036&#39;,
                              array([0.1907, 0.4209, 0.335 , 0.2784, 0.0084, 0.0294, 0.5035, 0.0695,
                                     0.0017, 0.2078, 0.0224, 0.1217, 0.0146, 0.0136, 0.0305, 0.075 ,
                                     0.0933, 0.0745, 0.0926, 0.3311, 0.3091, 0.003 , 0.0031, 0.3041,
                                     0.0084])),
                             (&#39;22_1&#39;,
                              array([3.038e-01, 4.487e-01, 7.190e-02, 3.680e-01, 3.322e-01, 2.290e-02,
                                     4.994e-01, 9.850e-02, 2.210e-02, 2.135e-01, 3.000e-04, 2.090e-02,
                                     1.000e-04, 2.000e-04, 1.783e-01, 2.810e-02, 3.420e-02, 1.150e-02,
                                     2.301e-05, 3.830e-02, 1.485e-01, 1.807e-01, 1.247e-01, 5.090e-02,
                                     3.512e-01, 3.466e-01, 3.344e-01])),
                             (&#39;28_9&#39;,
                              array([3.038e-01, 5.100e-03, 4.487e-01, 7.190e-02, 3.680e-01, 3.322e-01,
                                     2.400e-03, 2.290e-02, 4.994e-01, 8.800e-03, 2.135e-01, 1.040e-02,
                                     4.100e-03, 1.790e-02, 5.700e-02, 2.301e-05, 1.064e-01, 1.485e-01,
                                     1.807e-01, 1.247e-01, 7.220e-02, 5.090e-02, 3.512e-01, 1.430e-02,
                                     3.466e-01, 1.400e-03, 3.344e-01, 1.110e-02]))]),
                OrderedDict([(&#39;1036&#39;,
                              array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V16-14907&#39;, &#39;V17-14930&#39;, &#39;V18-14933&#39;,
                                     &#39;V36-16103&#39;, &#39;V44-16378&#39;, &#39;V49-16487&#39;, &#39;V71-17358&#39;, &#39;V77-17385&#39;,
                                     &#39;V81-17407&#39;, &#39;V114-17697&#39;, &#39;V139-17928&#39;, &#39;V140-17929&#39;,
                                     &#39;V146-20184&#39;, &#39;V147-20191&#39;, &#39;V149-20212&#39;, &#39;V152-20227&#39;,
                                     &#39;V156-20235&#39;, &#39;V158-20250&#39;, &#39;V165-20316&#39;, &#39;V167-20485&#39;,
                                     &#39;V169-20522&#39;, &#39;V171-20547&#39;, &#39;V180-29368&#39;], dtype=&#39;&lt;U10&#39;)),
                             (&#39;22_1&#39;,
                              array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V9-14677&#39;, &#39;V16-14907&#39;, &#39;V17-14930&#39;,
                                     &#39;V36-16103&#39;, &#39;V44-16378&#39;, &#39;V49-16487&#39;, &#39;V72-17365&#39;, &#39;V77-17385&#39;,
                                     &#39;V78-17398&#39;, &#39;V81-17407&#39;, &#39;V86-17479&#39;, &#39;V99-17559&#39;, &#39;V114-17697&#39;,
                                     &#39;V119-17722&#39;, &#39;V121-17746&#39;, &#39;V131-17829&#39;, &#39;V142-19190&#39;,
                                     &#39;V146-20184&#39;, &#39;V147-20191&#39;, &#39;V149-20212&#39;, &#39;V152-20227&#39;,
                                     &#39;V156-20235&#39;, &#39;V158-20250&#39;, &#39;V165-20316&#39;, &#39;V171-20547&#39;],
                                    dtype=&#39;&lt;U10&#39;)),
                             (&#39;28_9&#39;,
                              array([&#39;V3-14464&#39;, &#39;V5-14470&#39;, &#39;V8-14653&#39;, &#39;V9-14677&#39;, &#39;V16-14907&#39;,
                                     &#39;V17-14930&#39;, &#39;V31-16068&#39;, &#39;V36-16103&#39;, &#39;V44-16378&#39;, &#39;V76-17379&#39;,
                                     &#39;V77-17385&#39;, &#39;V82-17408&#39;, &#39;V96-17519&#39;, &#39;V98-17556&#39;, &#39;V107-17614&#39;,
                                     &#39;V142-19190&#39;, &#39;V145-20166&#39;, &#39;V147-20191&#39;, &#39;V149-20212&#39;,
                                     &#39;V152-20227&#39;, &#39;V153-20227&#39;, &#39;V156-20235&#39;, &#39;V158-20250&#39;,
                                     &#39;V161-20254&#39;, &#39;V165-20316&#39;, &#39;V170-20545&#39;, &#39;V171-20547&#39;,
                                     &#39;V180-29368&#39;], dtype=&#39;&lt;U10&#39;))]),
                None],
               &#39;output&#39;: [((&#39;1036&#39;,
                  &#39;1036_1&#39;,
                  &#39;2,2,3,1,2,3&#39;,
                  &#39;21,221,22211,1,2,2221111111111&#39;,
                  &#39;0,0,0,0,0,0&#39;,
                  &#39;NULL,NULL,NULL,NULL,NULL,NULL&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_2&#39;,
                  &#39;1,1,1,2,1,1&#39;,
                  &#39;11,111,11111,2,1,1111111111111&#39;,
                  &#39;0,0,0,0,0,0&#39;,
                  &#39;NULL,NULL,NULL,NULL,NULL,NULL&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_6&#39;,
                  &#39;1,1,1,2,2,3&#39;,
                  &#39;11,111,11111,2,2,2221111111111&#39;,
                  &#39;3,2,2,1,1,2&#39;,
                  &#39;12,221,12111,1,1,1111111111121&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_99&#39;,
                  &#39;1,1,1,2,1,1&#39;,
                  &#39;11,111,11111,2,1,1111111111111&#39;,
                  &#39;2,2,3,1,2,3&#39;,
                  &#39;21,221,22211,1,2,2221111111111&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_5&#39;,
                  &#39;1,1,3,1,2,1&#39;,
                  &#39;11,111,22211,1,2,1111111111111&#39;,
                  &#39;1,1,1,1,1,2&#39;,
                  &#39;11,111,11111,1,1,1111111111121&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_4&#39;,
                  &#39;1,1,1,2,2,3&#39;,
                  &#39;11,111,11111,2,2,2221111111111&#39;,
                  &#39;1,2,2,1,1,2&#39;,
                  &#39;11,221,12111,1,1,1111111111121&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_3&#39;,
                  &#39;1,1,1,1,2,3&#39;,
                  &#39;11,111,11111,1,2,2221111111111&#39;,
                  &#39;3,2,2,1,1,2&#39;,
                  &#39;12,221,12111,1,1,1111111111121&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_10&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,3,2,2,2,1,1&#39;,
                  &#39;111,21,1,11,11,11,1,1,1,222,2,21,112,1,11&#39;,
                  &#39;2,1,2,1,2,2,2,1,2,1,1,1,1,1,2&#39;,
                  &#39;121,11,2,11,21,21,2,1,2,111,1,11,111,1,21&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_20&#39;,
                  &#39;3,1,2,3,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;222,11,2,22,11,11,1,1,1,111,1,11,111,1,11&#39;,
                  &#39;2,3,1,2,3,3,0,2,1,2,1,3,3,2,3&#39;,
                  &#39;121,12,1,21,12,12,NULL,2,1,121,1,12,221,2,12&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_99&#39;,
                  &#39;3,3,1,3,1,1,1,1,1,1,1,1,1,2,3&#39;,
                  &#39;222,12,1,22,11,11,1,1,1,111,1,11,111,2,12&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,3,2,1,1,1,2&#39;,
                  &#39;111,21,1,11,11,11,1,1,1,222,2,11,111,1,21&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_5&#39;,
                  &#39;3,1,1,2,3,3,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;222,11,1,21,12,12,1,1,1,111,1,11,111,1,11&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,1,2,2,1,1,2&#39;,
                  &#39;111,21,1,11,11,11,1,1,1,111,2,21,111,1,21&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_4&#39;,
                  &#39;2,3,1,2,1,1,1,2,1,2,1,1,1,1,1&#39;,
                  &#39;121,12,1,21,11,11,1,2,1,121,1,11,111,1,11&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;111,21,1,11,11,11,1,1,1,111,1,11,111,1,11&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_3&#39;,
                  &#39;2,1,2,2,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;121,11,2,21,11,11,1,1,1,111,1,11,111,1,11&#39;,
                  &#39;2,1,2,1,2,2,2,1,2,1,1,1,2,1,1&#39;,
                  &#39;121,11,2,11,21,21,2,1,2,111,1,11,112,1,11&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_2&#39;,
                  &#39;2,3,1,2,3,1,1,1,1,1,1,3,3,2,3&#39;,
                  &#39;121,12,1,21,12,11,1,1,1,111,1,12,221,2,12&#39;,
                  &#39;1,2,1,1,1,1,1,1,2,1,1,1,1,1,1&#39;,
                  &#39;111,21,1,11,11,11,1,1,2,111,1,11,111,1,11&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_100&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,1,1,1,1,1,11,1&#39;,
                  &#39;2,1,1,1,1,1,1,1,2,2,1,2,1,2,1,2&#39;,
                  &#39;2,111,11,111,111,11,1,1,2221,2,1,2,1,2,11,2&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_101&#39;,
                  &#39;1,2,4,2,2,1,1,2,1,1,1,1,1,1,2,1&#39;,
                  &#39;1,121,22,122,121,11,1,2,1111,1,1,1,1,1,12,1&#39;,
                  &#39;1,0,3,3,3,2,1,1,3,1,1,2,1,2,3,1&#39;,
                  &#39;1,NULL,21,221,122,12,1,1,2222,1,1,2,1,2,22,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_186&#39;,
                  &#39;2,3,3,0,2,1,2,0,3,2,1,2,2,2,2,1&#39;,
                  &#39;2,212,21,NULL,121,11,2,NULL,2222,2,1,2,2,2,12,1&#39;,
                  &#39;1,1,4,0,4,3,1,1,1,1,2,1,1,1,1,2&#39;,
                  &#39;1,111,22,NULL,221,21,1,1,1111,1,2,1,1,1,11,2&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_114&#39;,
                  &#39;2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;2,111,11,111,111,11,1,1,1111,1,1,1,1,1,11,1&#39;,
                  &#39;1,2,4,2,2,2,1,1,3,1,1,2,1,2,3,1&#39;,
                  &#39;1,121,22,122,121,12,1,1,2222,1,1,2,1,2,22,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_105&#39;,
                  &#39;2,1,1,1,1,1,1,1,2,2,1,2,1,2,1,1&#39;,
                  &#39;2,111,11,111,111,11,1,1,2221,2,1,2,1,2,11,1&#39;,
                  &#39;1,2,4,2,2,1,1,2,1,1,1,1,1,1,3,1&#39;,
                  &#39;1,121,22,122,121,11,1,2,1111,1,1,1,1,1,22,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_103&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,1,1,1,1,1,11,1&#39;,
                  &#39;1,2,4,3,2,1,1,2,1,1,1,1,1,1,2,1&#39;,
                  &#39;1,121,22,221,121,11,1,2,1111,1,1,1,1,1,12,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_111&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,1,1,1,1,1,11,1&#39;,
                  &#39;2,3,3,0,2,1,2,1,1,1,1,2,1,2,2,2&#39;,
                  &#39;2,212,21,NULL,121,11,2,1,1111,1,1,2,1,2,12,2&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_110&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,1,1,1,1,1,11,1&#39;,
                  &#39;2,1,3,0,2,1,1,1,1,1,2,2,2,2,2,1&#39;,
                  &#39;2,111,21,NULL,121,11,1,1,1111,1,2,2,2,2,12,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_108&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,1,1,1,1,1,11,1&#39;,
                  &#39;2,1,3,0,2,3,1,1,1,2,2,1,1,1,1,1&#39;,
                  &#39;2,111,21,NULL,121,21,1,1,1111,2,2,1,1,1,11,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_109&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,1,1,1,1,1,11,1&#39;,
                  &#39;1,1,4,0,4,3,1,0,3,1,2,2,2,2,2,1&#39;,
                  &#39;1,111,22,NULL,221,21,1,NULL,2222,1,2,2,2,2,12,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_106&#39;,
                  &#39;1,2,2,4,1,1,1,1,2,2,1,2,1,2,1,2&#39;,
                  &#39;1,121,12,222,111,11,1,1,2221,2,1,2,1,2,11,2&#39;,
                  &#39;1,0,3,3,3,2,1,1,1,1,1,1,1,1,2,1&#39;,
                  &#39;1,NULL,21,221,122,12,1,1,1111,1,1,1,1,1,12,1&#39;)),
                {&#39;28_9_103&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_106&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;],
                  [&#39;1&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_108&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_109&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;1&#39;,
                   &#39;4&#39;,
                   &#39;0&#39;,
                   &#39;4&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_111&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;]),
                 &#39;28_9_105&#39;: ([&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_114&#39;: ([&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_110&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;1036_5&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;3&#39;, &#39;1&#39;, &#39;2&#39;, &#39;1&#39;],
                  [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;1036_99&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;],
                  [&#39;2&#39;, &#39;2&#39;, &#39;3&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;]),
                 &#39;1036_6&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;3&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;1036_4&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;1&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;1036_3&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;3&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;22_1_2&#39;: ([&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;22_1_3&#39;: ([&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;22_1_4&#39;: ([&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;22_1_5&#39;: ([&#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;22_1_99&#39;: ([&#39;3&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;1036_1&#39;: ([&#39;2&#39;, &#39;2&#39;, &#39;3&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;]),
                 &#39;1036_2&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;],
                  [&#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;]),
                 &#39;22_1_10&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;22_1_20&#39;: ([&#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;]),
                 &#39;28_9_100&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;28_9_101&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_186&#39;: ([&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;1&#39;,
                   &#39;4&#39;,
                   &#39;0&#39;,
                   &#39;4&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;])},
                16,
                OrderedDict([(&#39;1036&#39;,
                              ((0.5095662892319659,
                                0.1200720268831532,
                                0.3703616838848809),
                               (0.8372719532111501, 0.16272804678884994),
                               (0.4959350633372792,
                                0.5029270984699294,
                                0.001137838192791339),
                               (0.9776, 0.022399999999999975),
                               (0.8783, 0.12170000000000003),
                               (0.6958968877827948,
                                0.3040986399982008,
                                4.4722190044708225e-06))),
                             (&#39;22_1&#39;,
                              ((0.5430625312998345,
                                0.441995570096564,
                                0.014941898603601638),
                               (0.4808309970579335,
                                0.27997754259069546,
                                0.23919146035137098),
                               (0.9771, 0.02290000000000003),
                               (0.4746978223942187,
                                0.47355991311161183,
                                0.05174226449416947),
                               (0.7727645234894062,
                                0.01746405150743009,
                                0.20977142500316368),
                               (0.9788124071537928,
                                0.0002937318416986151,
                                0.02089386100450853),
                               (0.9999, 9.999999999998899e-05),
                               (0.9998, 0.00019999999999997797),
                               (0.8217, 0.17830000000000001),
                               (0.9657888899959897,
                                0.03419960658300151,
                                1.1503421008744192e-05),
                               (0.99997699, 2.3010000000045494e-05),
                               (0.823571654966203,
                                0.03279899592929768,
                                0.14362934910449926),
                               (0.9216155844553127,
                                0.049426017541645106,
                                0.02895839800304216),
                               (0.6488, 0.35119999999999996),
                               (0.4919178095579019,
                                0.26094079092863304,
                                0.24714139951346517))),
                             (&#39;28_9&#39;,
                              ((0.6961999999999999, 0.30380000000000007),
                               (0.5511793282039936,
                                0.4486017858972101,
                                0.00021888589879619984),
                               (0.42204959999999997,
                                0.20995040000000004,
                                0.24575039999999998,
                                0.12224960000000001),
                               (0.9770461078438263,
                                0.022843845846329314,
                                5.508918270812987e-05,
                                5.4957127136316546e-05),
                               (0.7832579269862147,
                                0.2126199204215599,
                                0.002234485824963839,
                                0.001887666767261636),
                               (0.9781451760744719,
                                0.017827918390930737,
                                0.004026905534597177),
                               (0.943, 0.05700000000000005),
                               (0.99997699, 2.3010000000045494e-05),
                               (0.9947948641004132,
                                0.004556055452908289,
                                0.000649080446678469),
                               (0.9278, 0.07220000000000004),
                               (0.9491, 0.050899999999999945),
                               (0.6488, 0.35119999999999996),
                               (0.9857, 0.01429999999999998),
                               (0.6534, 0.3466),
                               (0.6652881020650283,
                                0.33424330127786284,
                                0.0004685966571089461),
                               (0.9889, 0.011099999999999999)))])]}),
             (&#39;format&#39;,
                 28_9_103 28_9_106 28_9_108 28_9_109 28_9_111 28_9_105 28_9_114 28_9_110  \
              0    (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 2)   (2, 1)   (2, 1)   (1, 2)   
              1    (2, 2)   (2, 0)   (2, 1)   (2, 1)   (2, 3)   (1, 2)   (1, 2)   (2, 1)   
              2    (2, 4)   (2, 3)   (2, 3)   (2, 4)   (2, 3)   (1, 4)   (1, 4)   (2, 3)   
              3    (4, 3)   (4, 3)   (4, 0)   (4, 0)   (4, 0)   (1, 2)   (1, 2)   (4, 0)   
              4    (1, 2)   (1, 3)   (1, 2)   (1, 4)   (1, 2)   (1, 2)   (1, 2)   (1, 2)   
              5    (1, 1)   (1, 2)   (1, 3)   (1, 3)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   
              6    (1, 1)   (1, 1)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   
              7    (2, 2)   (1, 1)   (2, 1)   (2, 0)   (2, 1)   (1, 2)   (1, 1)   (2, 1)   
              8    (1, 1)   (2, 1)   (1, 1)   (1, 3)   (1, 1)   (2, 1)   (1, 3)   (1, 1)   
              9    (1, 1)   (2, 1)   (1, 2)   (1, 1)   (1, 1)   (2, 1)   (1, 1)   (1, 1)   
              10   (1, 1)   (1, 1)   (1, 2)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   (1, 2)   
              11   (1, 1)   (2, 1)   (1, 1)   (1, 2)   (1, 2)   (2, 1)   (1, 2)   (1, 2)   
              12   (1, 1)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   (1, 2)   
              13   (1, 1)   (2, 1)   (1, 1)   (1, 2)   (1, 2)   (2, 1)   (1, 2)   (1, 2)   
              14   (1, 2)   (1, 2)   (1, 1)   (1, 2)   (1, 2)   (1, 3)   (1, 3)   (1, 2)   
              15   (1, 1)   (2, 1)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   
              
                  1036_5 1036_99  ...  22_1_4  22_1_5 22_1_99  1036_1  1036_2 22_1_10  \
              0   (1, 1)  (1, 2)  ...  (2, 1)  (3, 1)  (3, 1)  (2, 0)  (1, 0)  (1, 2)   
              1   (1, 1)  (1, 2)  ...  (3, 2)  (1, 2)  (3, 2)  (2, 0)  (1, 0)  (2, 1)   
              2   (3, 1)  (1, 3)  ...  (1, 1)  (1, 1)  (1, 1)  (3, 0)  (1, 0)  (1, 2)   
              3   (1, 1)  (2, 1)  ...  (2, 1)  (2, 1)  (3, 1)  (1, 0)  (2, 0)  (1, 1)   
              4   (2, 1)  (1, 2)  ...  (1, 1)  (3, 1)  (1, 1)  (2, 0)  (1, 0)  (1, 2)   
              5   (1, 2)  (1, 3)  ...  (1, 1)  (3, 1)  (1, 1)  (3, 0)  (1, 0)  (1, 2)   
              6   (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (1, 2)   
              7   (0, 0)  (0, 0)  ...  (2, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (1, 1)   
              8   (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (1, 2)   
              9   (0, 0)  (0, 0)  ...  (2, 1)  (1, 1)  (1, 3)  (0, 0)  (0, 0)  (3, 1)   
              10  (0, 0)  (0, 0)  ...  (1, 1)  (1, 2)  (1, 2)  (0, 0)  (0, 0)  (2, 1)   
              11  (0, 0)  (0, 0)  ...  (1, 1)  (1, 2)  (1, 1)  (0, 0)  (0, 0)  (2, 1)   
              12  (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (2, 1)   
              13  (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (2, 1)  (0, 0)  (0, 0)  (1, 1)   
              14  (0, 0)  (0, 0)  ...  (1, 1)  (1, 2)  (3, 2)  (0, 0)  (0, 0)  (1, 2)   
              15  (0, 0)  (0, 0)  ...  (0, 0)  (0, 0)  (0, 0)  (0, 0)  (0, 0)  (0, 0)   
              
                 22_1_20 28_9_100 28_9_101 28_9_186  
              0   (3, 2)   (1, 2)   (1, 1)   (2, 1)  
              1   (1, 3)   (2, 1)   (2, 0)   (3, 1)  
              2   (2, 1)   (2, 1)   (4, 3)   (3, 4)  
              3   (3, 2)   (4, 1)   (2, 3)   (0, 0)  
              4   (1, 3)   (1, 1)   (2, 3)   (2, 4)  
              5   (1, 3)   (1, 1)   (1, 2)   (1, 3)  
              6   (1, 0)   (1, 1)   (1, 1)   (2, 1)  
              7   (1, 2)   (2, 1)   (2, 1)   (0, 1)  
              8   (1, 1)   (1, 2)   (1, 3)   (3, 1)  
              9   (1, 2)   (1, 2)   (1, 1)   (2, 1)  
              10  (1, 1)   (1, 1)   (1, 1)   (1, 2)  
              11  (1, 3)   (1, 2)   (1, 2)   (2, 1)  
              12  (1, 3)   (1, 1)   (1, 1)   (2, 1)  
              13  (1, 2)   (1, 2)   (1, 2)   (2, 1)  
              14  (1, 3)   (1, 1)   (2, 3)   (2, 1)  
              15  (0, 0)   (1, 2)   (1, 1)   (1, 2)  
              
              [16 rows x 25 columns])])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="s1">&#39;WASH7P&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;dregions&#39;,
              [[&#39;1&#39;,
                &#39;14361&#39;,
                &#39;29370&#39;,
                &#39;WASH7P&#39;,
                &#39;1.5299877409602128e-06&#39;,
                &#39;1.94345806118021e-06&#39;,
                &#39;1.136044574393209e-06&#39;]]),
             (&#39;dvariants&#39;,
              [[[&#39;1&#39;, 14378, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14429, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14458, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14464, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14469, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14470, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14488, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14521, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14653, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14662, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14677, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14731, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14742, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14747, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14773, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14792, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14843, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14861, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14907, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14930, &#39;WASH7P&#39;],
                [&#39;1&#39;, 14933, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15207, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15219, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15219, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15746, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15773, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15777, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15811, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15835, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15837, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15849, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15913, &#39;WASH7P&#39;],
                [&#39;1&#39;, 15989, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16006, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16068, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16071, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16074, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16079, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16101, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16102, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16103, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16127, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16128, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16158, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16206, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16225, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16280, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16310, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16337, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16360, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16378, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16397, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16443, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16451, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16474, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16487, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16531, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16555, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16633, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16722, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16731, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16731, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16734, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16734, &#39;WASH7P&#39;],
                [&#39;1&#39;, 16911, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17005, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17135, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17146, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17147, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17147, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17151, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17181, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17212, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17213, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17217, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17222, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17223, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17289, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17353, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17358, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17365, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17373, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17375, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17378, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17379, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17385, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17398, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17403, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17406, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17407, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17408, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17452, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17453, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17478, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17479, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17483, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17484, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17492, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17493, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17496, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17501, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17511, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17512, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17517, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17519, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17538, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17556, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17559, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17563, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17569, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17585, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17589, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17594, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17596, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17606, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17614, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17626, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17647, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17672, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17688, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17689, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17695, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17697, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17701, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17709, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17716, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17721, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17722, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17728, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17746, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17747, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17748, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17750, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17753, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17765, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17765, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17767, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17781, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17793, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17805, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17829, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17842, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17843, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17843, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17844, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17853, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17854, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17901, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17904, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17928, &#39;WASH7P&#39;],
                [&#39;1&#39;, 17929, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19190, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19190, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19254, &#39;WASH7P&#39;],
                [&#39;1&#39;, 19535, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20166, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20184, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20191, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20210, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20212, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20217, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20225, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20227, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20227, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20231, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20231, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20235, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20237, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20250, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20251, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20253, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20254, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20273, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20280, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20297, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20316, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20443, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20485, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20496, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20522, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20545, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20547, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20552, &#39;WASH7P&#39;],
                [&#39;1&#39;, 20554, &#39;WASH7P&#39;],
                [&#39;1&#39;, 28588, &#39;WASH7P&#39;],
                [&#39;1&#39;, 28588, &#39;WASH7P&#39;],
                [&#39;1&#39;, 28588, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29278, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29300, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29359, &#39;WASH7P&#39;],
                [&#39;1&#39;, 29368, &#39;WASH7P&#39;]]]),
             (&#39;dfamvaridx&#39;,
              [{&#39;1036&#39;: [3,
                 8,
                 18,
                 19,
                 20,
                 40,
                 50,
                 55,
                 69,
                 79,
                 85,
                 89,
                 122,
                 149,
                 150,
                 156,
                 157,
                 159,
                 162,
                 166,
                 168,
                 175,
                 177,
                 179,
                 181,
                 190],
                &#39;22_1&#39;: [3,
                 8,
                 10,
                 18,
                 19,
                 40,
                 50,
                 55,
                 69,
                 80,
                 85,
                 86,
                 89,
                 94,
                 107,
                 111,
                 122,
                 127,
                 129,
                 140,
                 152,
                 156,
                 157,
                 159,
                 162,
                 166,
                 168,
                 175,
                 181],
                &#39;28_9&#39;: [3,
                 5,
                 8,
                 10,
                 18,
                 19,
                 34,
                 40,
                 50,
                 84,
                 85,
                 90,
                 104,
                 106,
                 115,
                 152,
                 155,
                 157,
                 159,
                 162,
                 163,
                 165,
                 166,
                 168,
                 171,
                 175,
                 180,
                 181,
                 190]}]),
             (&#39;dgeno&#39;,
              [{&#39;28_9_103&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_106&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;00&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;00&#39;,
                 &#39;00&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;28_9_108&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;28_9_109&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;00&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_111&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;28_9_105&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_114&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;28_9_110&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;1036_5&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;1036_99&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;1036_6&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;00&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;1036_4&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;1036_3&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;22_1_2&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;],
                &#39;22_1_3&#39;: [&#39;11&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;22_1_4&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;22_1_5&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;22_1_99&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;1036_1&#39;: [(&#39;1&#39;, &#39;0&#39;), (&#39;1&#39;, &#39;0&#39;)],
                &#39;1036_2&#39;: [(&#39;3&#39;, &#39;0&#39;), (&#39;1&#39;, &#39;0&#39;)],
                &#39;22_1_10&#39;: [(&#39;3&#39;, &#39;1&#39;), (&#39;0&#39;, &#39;0&#39;)],
                &#39;22_1_20&#39;: [(&#39;1&#39;, &#39;2&#39;), (&#39;0&#39;, &#39;0&#39;)]}]),
             (&#39;gss&#39;,
              [Empty DataFrame
               Columns: []
               Index: []]),
             (&#39;hapimp&#39;,
              {&#39;1036&#39;: [&#39;1036&#39;,
                array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V18-14907&#39;, &#39;V19-14930&#39;, &#39;V20-14933&#39;,
                       &#39;V40-16103&#39;, &#39;V50-16378&#39;, &#39;V55-16487&#39;, &#39;V69-17147&#39;, &#39;V79-17358&#39;,
                       &#39;V85-17385&#39;, &#39;V89-17407&#39;, &#39;V122-17697&#39;, &#39;V149-17928&#39;, &#39;V150-17929&#39;,
                       &#39;V156-20184&#39;, &#39;V157-20191&#39;, &#39;V159-20212&#39;, &#39;V162-20227&#39;,
                       &#39;V166-20235&#39;, &#39;V168-20250&#39;, &#39;V175-20316&#39;, &#39;V177-20485&#39;,
                       &#39;V179-20522&#39;, &#39;V181-20547&#39;, &#39;V190-29368&#39;], dtype=&#39;&lt;U10&#39;),
                [14464,
                 14653,
                 14907,
                 14930,
                 14933,
                 16103,
                 16378,
                 16487,
                 17147,
                 17358,
                 17385,
                 17407,
                 17697,
                 17928,
                 17929,
                 20184,
                 20191,
                 20212,
                 20227,
                 20235,
                 20250,
                 20316,
                 20485,
                 20522,
                 20547,
                 29368],
                array([1.977e-01, 3.922e-01, 3.110e-01, 2.629e-01, 1.030e-02, 2.320e-02,
                       4.985e-01, 6.610e-02, 1.000e-05, 1.700e-03, 1.934e-01, 1.790e-02,
                       1.534e-01, 1.470e-02, 1.450e-02, 2.840e-02, 1.115e-01, 1.383e-01,
                       1.008e-01, 4.680e-02, 2.925e-01, 2.719e-01, 6.900e-03, 6.300e-03,
                       2.689e-01, 8.300e-03]),
                array([[&#39;1036&#39;, &#39;1036_1&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_1&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                       [&#39;1036&#39;, &#39;1036_2&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_2&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                        &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                       [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                        &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_99&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A2,1|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;2/&#39;, &#39;A2,1|&#39;,
                        &#39;2|&#39;, &#39;1/&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A1,2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                       [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;]],
                      dtype=&#39;&lt;U7&#39;)],
               &#39;22_1&#39;: [&#39;22_1&#39;,
                array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V10-14677&#39;, &#39;V18-14907&#39;, &#39;V19-14930&#39;,
                       &#39;V40-16103&#39;, &#39;V50-16378&#39;, &#39;V55-16487&#39;, &#39;V69-17147&#39;, &#39;V80-17365&#39;,
                       &#39;V85-17385&#39;, &#39;V86-17398&#39;, &#39;V89-17407&#39;, &#39;V94-17479&#39;, &#39;V107-17559&#39;,
                       &#39;V111-17589&#39;, &#39;V122-17697&#39;, &#39;V127-17722&#39;, &#39;V129-17746&#39;,
                       &#39;V140-17829&#39;, &#39;V152-19190&#39;, &#39;V156-20184&#39;, &#39;V157-20191&#39;,
                       &#39;V159-20212&#39;, &#39;V162-20227&#39;, &#39;V166-20235&#39;, &#39;V168-20250&#39;,
                       &#39;V175-20316&#39;, &#39;V181-20547&#39;], dtype=&#39;&lt;U10&#39;),
                [14464,
                 14653,
                 14677,
                 14907,
                 14930,
                 16103,
                 16378,
                 16487,
                 17147,
                 17365,
                 17385,
                 17398,
                 17407,
                 17479,
                 17559,
                 17589,
                 17697,
                 17722,
                 17746,
                 17829,
                 19190,
                 20184,
                 20191,
                 20212,
                 20227,
                 20235,
                 20250,
                 20316,
                 20547],
                array([1.977e-01, 3.922e-01, 5.000e-02, 3.110e-01, 2.629e-01, 2.320e-02,
                       4.985e-01, 6.610e-02, 1.000e-05, 2.120e-02, 1.934e-01, 5.700e-03,
                       1.790e-02, 1.400e-03, 2.090e-02, 1.600e-03, 1.534e-01, 2.320e-02,
                       6.950e-02, 8.500e-03, 5.000e-04, 2.840e-02, 1.115e-01, 1.383e-01,
                       1.008e-01, 4.680e-02, 2.925e-01, 2.719e-01, 2.689e-01]),
                array([[&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                       [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1/&#39;,
                        &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;,
                        &#39;2|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2/&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2|&#39;,
                        &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1/&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A1,2/&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1\\&#39;, &#39;2|&#39;],
                       [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;]], dtype=&#39;&lt;U7&#39;)],
               &#39;28_9&#39;: [&#39;28_9&#39;,
                array([&#39;V3-14464&#39;, &#39;V5-14470&#39;, &#39;V8-14653&#39;, &#39;V10-14677&#39;, &#39;V18-14907&#39;,
                       &#39;V19-14930&#39;, &#39;V34-16068&#39;, &#39;V40-16103&#39;, &#39;V50-16378&#39;, &#39;V84-17379&#39;,
                       &#39;V85-17385&#39;, &#39;V90-17408&#39;, &#39;V104-17519&#39;, &#39;V106-17556&#39;, &#39;V115-17614&#39;,
                       &#39;V152-19190&#39;, &#39;V155-20166&#39;, &#39;V157-20191&#39;, &#39;V159-20212&#39;,
                       &#39;V162-20227&#39;, &#39;V163-20227&#39;, &#39;V165-20231&#39;, &#39;V166-20235&#39;,
                       &#39;V168-20250&#39;, &#39;V171-20254&#39;, &#39;V175-20316&#39;, &#39;V180-20545&#39;,
                       &#39;V181-20547&#39;, &#39;V190-29368&#39;], dtype=&#39;&lt;U10&#39;),
                [14464,
                 14470,
                 14653,
                 14677,
                 14907,
                 14930,
                 16068,
                 16103,
                 16378,
                 17379,
                 17385,
                 17408,
                 17519,
                 17556,
                 17614,
                 19190,
                 20166,
                 20191,
                 20212,
                 20227,
                 20227,
                 20231,
                 20235,
                 20250,
                 20254,
                 20316,
                 20545,
                 20547,
                 29368],
                array([1.977e-01, 4.000e-03, 3.922e-01, 5.000e-02, 3.110e-01, 2.629e-01,
                       2.200e-03, 2.320e-02, 4.985e-01, 5.800e-03, 1.934e-01, 1.070e-02,
                       3.000e-03, 1.180e-02, 4.790e-02, 5.000e-04, 8.310e-02, 1.115e-01,
                       1.383e-01, 1.008e-01, 4.840e-02, 9.437e-05, 4.680e-02, 2.925e-01,
                       2.290e-02, 2.719e-01, 8.000e-04, 2.689e-01, 8.300e-03]),
                array([[&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;A1,2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;2:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                        &#39;A2,1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;2:&#39;, &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                        &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;?:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                        &#39;1:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;?:&#39;,
                        &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                        &#39;2:&#39;],
                       [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2/&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1\\&#39;, &#39;1|&#39;, &#39;1/&#39;],
                       [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2\\&#39;, &#39;2|&#39;, &#39;1/&#39;],
                       [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;?|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                        &#39;2|&#39;, &#39;2\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                        &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                        &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;],
                       [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;1|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;?|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;?\\&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                        &#39;2|&#39;, &#39;1|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2\\&#39;,
                        &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                        &#39;2|&#39;],
                       [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;?|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1\\&#39;,
                        &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                        &#39;1|&#39;]], dtype=&#39;&lt;U8&#39;)]}),
             (&#39;ld&#39;, []),
             (&#39;coder&#39;,
              {&#39;input&#39;: [{&#39;28_9_103&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_106&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;00&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;00&#39;,
                  &#39;00&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;28_9_108&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;28_9_109&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;00&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_111&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;28_9_105&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_114&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;28_9_110&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;1036_5&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;1036_99&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;1036_6&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;00&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;1036_4&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;1036_3&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;22_1_2&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;],
                 &#39;22_1_3&#39;: [&#39;11&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;22_1_4&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;22_1_5&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;22_1_99&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;1036_1&#39;: [(&#39;1&#39;, &#39;0&#39;), (&#39;1&#39;, &#39;0&#39;)],
                 &#39;1036_2&#39;: [(&#39;3&#39;, &#39;0&#39;), (&#39;1&#39;, &#39;0&#39;)],
                 &#39;22_1_10&#39;: [(&#39;3&#39;, &#39;1&#39;), (&#39;0&#39;, &#39;0&#39;)],
                 &#39;22_1_20&#39;: [(&#39;1&#39;, &#39;2&#39;), (&#39;0&#39;, &#39;0&#39;)]},
                OrderedDict([(&#39;1036&#39;,
                              array([[&#39;1036&#39;, &#39;1036_1&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_1&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                                     [&#39;1036&#39;, &#39;1036_2&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_2&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;,
                                      &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;, &#39;?:&#39;],
                                     [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_6&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                                      &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_99&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A2,1|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;2/&#39;, &#39;A2,1|&#39;,
                                      &#39;2|&#39;, &#39;1/&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;A1,2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;],
                                     [&#39;1036&#39;, &#39;1036_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1:&#39;]],
                                    dtype=&#39;&lt;U7&#39;)),
                             (&#39;22_1&#39;,
                              array([[&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_10&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A1,2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_20&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1/&#39;,
                                      &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_99&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2/&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;2/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_5&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2/&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1/&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_3&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A1,2/&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1\\&#39;, &#39;2|&#39;],
                                     [&#39;22_1&#39;, &#39;22_1_2&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;]], dtype=&#39;&lt;U7&#39;)),
                             (&#39;28_9&#39;,
                              array([[&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_100&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;A1,2:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;A1,2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;2:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;,
                                      &#39;A2,1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;2:&#39;, &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_101&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;?:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;,
                                      &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;?:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;?:&#39;, &#39;2:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;2:&#39;,
                                      &#39;1:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_186&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;A2,1:&#39;, &#39;2:&#39;, &#39;?:&#39;,
                                      &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;A2,1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;,
                                      &#39;2:&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1/&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_114&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2/&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;2:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;A1,2|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1\\&#39;, &#39;1|&#39;, &#39;1/&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_105&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;A2,1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2\\&#39;, &#39;2|&#39;, &#39;1/&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_103&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_111&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;?|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;, &#39;2\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_110&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                                      &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2\\&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_108&#39;, &#39;2:&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1\\&#39;, &#39;1|&#39;,
                                      &#39;?|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2\\&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_109&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;?|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;?\\&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1\\&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2\\&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;2|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;A1,2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;2\\&#39;,
                                      &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;,
                                      &#39;2|&#39;],
                                     [&#39;28_9&#39;, &#39;28_9_106&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;?|&#39;, &#39;2|&#39;, &#39;A2,1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;2|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;A2,1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;2|&#39;, &#39;1|&#39;, &#39;1/&#39;, &#39;1\\&#39;,
                                      &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2|&#39;,
                                      &#39;1|&#39;]], dtype=&#39;&lt;U8&#39;))]),
                OrderedDict([(&#39;1036&#39;,
                              array([1.977e-01, 3.922e-01, 3.110e-01, 2.629e-01, 1.030e-02, 2.320e-02,
                                     4.985e-01, 6.610e-02, 1.000e-05, 1.700e-03, 1.934e-01, 1.790e-02,
                                     1.534e-01, 1.470e-02, 1.450e-02, 2.840e-02, 1.115e-01, 1.383e-01,
                                     1.008e-01, 4.680e-02, 2.925e-01, 2.719e-01, 6.900e-03, 6.300e-03,
                                     2.689e-01, 8.300e-03])),
                             (&#39;22_1&#39;,
                              array([1.977e-01, 3.922e-01, 5.000e-02, 3.110e-01, 2.629e-01, 2.320e-02,
                                     4.985e-01, 6.610e-02, 1.000e-05, 2.120e-02, 1.934e-01, 5.700e-03,
                                     1.790e-02, 1.400e-03, 2.090e-02, 1.600e-03, 1.534e-01, 2.320e-02,
                                     6.950e-02, 8.500e-03, 5.000e-04, 2.840e-02, 1.115e-01, 1.383e-01,
                                     1.008e-01, 4.680e-02, 2.925e-01, 2.719e-01, 2.689e-01])),
                             (&#39;28_9&#39;,
                              array([1.977e-01, 4.000e-03, 3.922e-01, 5.000e-02, 3.110e-01, 2.629e-01,
                                     2.200e-03, 2.320e-02, 4.985e-01, 5.800e-03, 1.934e-01, 1.070e-02,
                                     3.000e-03, 1.180e-02, 4.790e-02, 5.000e-04, 8.310e-02, 1.115e-01,
                                     1.383e-01, 1.008e-01, 4.840e-02, 9.437e-05, 4.680e-02, 2.925e-01,
                                     2.290e-02, 2.719e-01, 8.000e-04, 2.689e-01, 8.300e-03]))]),
                OrderedDict([(&#39;1036&#39;,
                              array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V18-14907&#39;, &#39;V19-14930&#39;, &#39;V20-14933&#39;,
                                     &#39;V40-16103&#39;, &#39;V50-16378&#39;, &#39;V55-16487&#39;, &#39;V69-17147&#39;, &#39;V79-17358&#39;,
                                     &#39;V85-17385&#39;, &#39;V89-17407&#39;, &#39;V122-17697&#39;, &#39;V149-17928&#39;, &#39;V150-17929&#39;,
                                     &#39;V156-20184&#39;, &#39;V157-20191&#39;, &#39;V159-20212&#39;, &#39;V162-20227&#39;,
                                     &#39;V166-20235&#39;, &#39;V168-20250&#39;, &#39;V175-20316&#39;, &#39;V177-20485&#39;,
                                     &#39;V179-20522&#39;, &#39;V181-20547&#39;, &#39;V190-29368&#39;], dtype=&#39;&lt;U10&#39;)),
                             (&#39;22_1&#39;,
                              array([&#39;V3-14464&#39;, &#39;V8-14653&#39;, &#39;V10-14677&#39;, &#39;V18-14907&#39;, &#39;V19-14930&#39;,
                                     &#39;V40-16103&#39;, &#39;V50-16378&#39;, &#39;V55-16487&#39;, &#39;V69-17147&#39;, &#39;V80-17365&#39;,
                                     &#39;V85-17385&#39;, &#39;V86-17398&#39;, &#39;V89-17407&#39;, &#39;V94-17479&#39;, &#39;V107-17559&#39;,
                                     &#39;V111-17589&#39;, &#39;V122-17697&#39;, &#39;V127-17722&#39;, &#39;V129-17746&#39;,
                                     &#39;V140-17829&#39;, &#39;V152-19190&#39;, &#39;V156-20184&#39;, &#39;V157-20191&#39;,
                                     &#39;V159-20212&#39;, &#39;V162-20227&#39;, &#39;V166-20235&#39;, &#39;V168-20250&#39;,
                                     &#39;V175-20316&#39;, &#39;V181-20547&#39;], dtype=&#39;&lt;U10&#39;)),
                             (&#39;28_9&#39;,
                              array([&#39;V3-14464&#39;, &#39;V5-14470&#39;, &#39;V8-14653&#39;, &#39;V10-14677&#39;, &#39;V18-14907&#39;,
                                     &#39;V19-14930&#39;, &#39;V34-16068&#39;, &#39;V40-16103&#39;, &#39;V50-16378&#39;, &#39;V84-17379&#39;,
                                     &#39;V85-17385&#39;, &#39;V90-17408&#39;, &#39;V104-17519&#39;, &#39;V106-17556&#39;, &#39;V115-17614&#39;,
                                     &#39;V152-19190&#39;, &#39;V155-20166&#39;, &#39;V157-20191&#39;, &#39;V159-20212&#39;,
                                     &#39;V162-20227&#39;, &#39;V163-20227&#39;, &#39;V165-20231&#39;, &#39;V166-20235&#39;,
                                     &#39;V168-20250&#39;, &#39;V171-20254&#39;, &#39;V175-20316&#39;, &#39;V180-20545&#39;,
                                     &#39;V181-20547&#39;, &#39;V190-29368&#39;], dtype=&#39;&lt;U10&#39;))]),
                None],
               &#39;output&#39;: [((&#39;1036&#39;,
                  &#39;1036_1&#39;,
                  &#39;2,2,3,2,2,1,1&#39;,
                  &#39;21,221,222,211,2,1,1111111111111&#39;,
                  &#39;0,0,0,0,0,0,0&#39;,
                  &#39;NULL,NULL,NULL,NULL,NULL,NULL,NULL&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_2&#39;,
                  &#39;1,1,1,1,1,2,3&#39;,
                  &#39;11,111,111,111,1,2,2221111111111&#39;,
                  &#39;0,0,0,0,0,0,0&#39;,
                  &#39;NULL,NULL,NULL,NULL,NULL,NULL,NULL&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_6&#39;,
                  &#39;1,1,1,1,1,1,2&#39;,
                  &#39;11,111,111,111,1,1,1111111111121&#39;,
                  &#39;3,2,2,2,2,2,3&#39;,
                  &#39;12,221,121,211,2,2,2221111111111&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_99&#39;,
                  &#39;1,1,1,1,1,2,3&#39;,
                  &#39;11,111,111,111,1,2,2221111111111&#39;,
                  &#39;2,2,3,2,2,1,1&#39;,
                  &#39;21,221,222,211,2,1,1111111111111&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_5&#39;,
                  &#39;1,1,3,1,1,2,1&#39;,
                  &#39;11,111,222,111,1,2,1111111111111&#39;,
                  &#39;1,1,1,1,1,1,2&#39;,
                  &#39;11,111,111,111,1,1,1111111111121&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_4&#39;,
                  &#39;1,1,1,1,1,2,3&#39;,
                  &#39;11,111,111,111,1,2,2221111111111&#39;,
                  &#39;1,2,2,2,2,1,2&#39;,
                  &#39;11,221,121,211,2,1,1111111111121&#39;),
                 (&#39;1036&#39;,
                  &#39;1036_3&#39;,
                  &#39;1,1,1,1,1,2,3&#39;,
                  &#39;11,111,111,111,1,2,2221111111111&#39;,
                  &#39;3,2,2,2,1,1,2&#39;,
                  &#39;12,221,121,211,1,1,1111111111121&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_10&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,1,3,2,2,2,1,1&#39;,
                  &#39;111,21,1,11,1,11,11,1,11,1,222,2,21,112,1,11&#39;,
                  &#39;2,1,2,1,1,2,2,2,1,2,1,1,1,1,1,2&#39;,
                  &#39;121,11,2,11,1,21,21,2,11,2,111,1,11,111,1,21&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_20&#39;,
                  &#39;3,1,2,3,2,3,3,0,2,1,2,1,3,3,2,3&#39;,
                  &#39;222,11,2,22,2,12,12,NULL,22,1,121,1,12,221,2,12&#39;,
                  &#39;2,3,1,2,1,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;121,12,1,21,1,11,11,1,11,1,111,1,11,111,1,11&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_99&#39;,
                  &#39;3,3,1,3,1,1,1,1,1,1,1,1,1,1,2,3&#39;,
                  &#39;222,12,1,22,1,11,11,1,11,1,111,1,11,111,2,12&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,1,3,2,1,1,1,2&#39;,
                  &#39;111,21,1,11,1,11,11,1,11,1,222,2,11,111,1,21&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_5&#39;,
                  &#39;3,1,1,2,2,3,3,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;222,11,1,21,2,12,12,1,11,1,111,1,11,111,1,11&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,1,1,2,2,1,1,2&#39;,
                  &#39;111,21,1,11,1,11,11,1,11,1,111,2,21,111,1,21&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_4&#39;,
                  &#39;2,3,1,2,1,1,1,1,2,1,2,1,1,1,1,1&#39;,
                  &#39;121,12,1,21,1,11,11,1,22,1,121,1,11,111,1,11&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;111,21,1,11,1,11,11,1,11,1,111,1,11,111,1,11&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_3&#39;,
                  &#39;2,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;121,11,2,21,1,11,11,1,11,1,111,1,11,111,1,11&#39;,
                  &#39;2,1,2,1,1,2,2,2,1,2,1,1,1,2,1,1&#39;,
                  &#39;121,11,2,11,1,21,21,2,11,2,111,1,11,112,1,11&#39;),
                 (&#39;22_1&#39;,
                  &#39;22_1_2&#39;,
                  &#39;2,3,1,2,1,3,1,1,1,1,1,1,3,3,2,3&#39;,
                  &#39;121,12,1,21,1,12,11,1,11,1,111,1,12,221,2,12&#39;,
                  &#39;1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1&#39;,
                  &#39;111,21,1,11,1,11,11,1,11,2,111,1,11,111,1,11&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_100&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,11,1,1,1,1,11,1&#39;,
                  &#39;2,1,1,1,1,1,1,1,2,4,1,2,1,2,1,2&#39;,
                  &#39;2,111,11,111,111,11,1,1,2221,22,1,2,1,2,11,2&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_101&#39;,
                  &#39;1,2,4,2,2,1,1,2,1,1,1,1,1,1,2,1&#39;,
                  &#39;1,121,22,122,121,11,1,2,1111,11,1,1,1,1,12,1&#39;,
                  &#39;1,0,3,3,3,2,1,1,3,2,1,2,1,2,3,1&#39;,
                  &#39;1,NULL,21,221,122,12,1,1,2222,12,1,2,1,2,22,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_186&#39;,
                  &#39;2,3,3,0,2,1,2,0,3,3,1,2,2,2,2,1&#39;,
                  &#39;2,212,21,NULL,121,11,2,NULL,2222,21,1,2,2,2,12,1&#39;,
                  &#39;1,1,4,0,4,3,1,1,1,1,2,1,1,1,1,2&#39;,
                  &#39;1,111,22,NULL,221,21,1,1,1111,11,2,1,1,1,11,2&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_114&#39;,
                  &#39;2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1&#39;,
                  &#39;2,111,11,111,111,11,1,1,1111,11,1,1,1,1,11,1&#39;,
                  &#39;1,2,4,2,2,2,1,1,3,2,1,2,1,2,3,1&#39;,
                  &#39;1,121,22,122,121,12,1,1,2222,12,1,2,1,2,22,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_105&#39;,
                  &#39;2,1,1,1,1,1,1,1,2,4,1,2,1,2,1,1&#39;,
                  &#39;2,111,11,111,111,11,1,1,2221,22,1,2,1,2,11,1&#39;,
                  &#39;1,2,4,2,2,1,1,2,1,1,1,1,1,1,3,1&#39;,
                  &#39;1,121,22,122,121,11,1,2,1111,11,1,1,1,1,22,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_103&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,11,1,1,1,1,11,1&#39;,
                  &#39;1,2,4,3,2,1,1,2,1,1,1,1,1,1,2,1&#39;,
                  &#39;1,121,22,221,121,11,1,2,1111,11,1,1,1,1,12,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_111&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,11,1,1,1,1,11,1&#39;,
                  &#39;2,3,3,0,2,1,2,1,1,1,1,2,1,2,2,2&#39;,
                  &#39;2,212,21,NULL,121,11,2,1,1111,11,1,2,1,2,12,2&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_110&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,11,1,1,1,1,11,1&#39;,
                  &#39;2,1,3,0,2,1,1,1,1,1,2,2,2,2,2,1&#39;,
                  &#39;2,111,21,NULL,121,11,1,1,1111,11,2,2,2,2,12,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_108&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,11,1,1,1,1,11,1&#39;,
                  &#39;2,1,3,0,2,3,1,1,1,3,2,1,1,1,1,1&#39;,
                  &#39;2,111,21,NULL,121,21,1,1,1111,21,2,1,1,1,11,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_109&#39;,
                  &#39;1,2,2,4,1,1,1,2,1,1,1,1,1,1,1,1&#39;,
                  &#39;1,121,12,222,111,11,1,2,1111,11,1,1,1,1,11,1&#39;,
                  &#39;1,1,4,0,4,3,1,0,3,1,2,2,2,2,2,1&#39;,
                  &#39;1,111,22,NULL,221,21,1,NULL,2222,11,2,2,2,2,12,1&#39;),
                 (&#39;28_9&#39;,
                  &#39;28_9_106&#39;,
                  &#39;1,2,2,4,1,1,1,1,2,4,1,2,1,2,1,2&#39;,
                  &#39;1,121,12,222,111,11,1,1,2221,22,1,2,1,2,11,2&#39;,
                  &#39;1,0,3,3,3,2,1,1,1,1,1,1,1,1,2,1&#39;,
                  &#39;1,NULL,21,221,122,12,1,1,1111,11,1,1,1,1,12,1&#39;)),
                {&#39;28_9_103&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_106&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;],
                  [&#39;1&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_108&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_109&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;1&#39;,
                   &#39;4&#39;,
                   &#39;0&#39;,
                   &#39;4&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_111&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;]),
                 &#39;28_9_105&#39;: ([&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_114&#39;: ([&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_110&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;]),
                 &#39;1036_5&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;3&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;1&#39;],
                  [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;1036_99&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;2&#39;, &#39;2&#39;, &#39;3&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;]),
                 &#39;1036_6&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;],
                  [&#39;3&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;3&#39;]),
                 &#39;1036_4&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;1&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;1036_3&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;3&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]),
                 &#39;22_1_2&#39;: ([&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;22_1_3&#39;: ([&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;22_1_4&#39;: ([&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;22_1_5&#39;: ([&#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;22_1_99&#39;: ([&#39;3&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;],
                  [&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;1036_1&#39;: ([&#39;2&#39;, &#39;2&#39;, &#39;3&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;],
                  [&#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;]),
                 &#39;1036_2&#39;: ([&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;],
                  [&#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;, &#39;0&#39;]),
                 &#39;22_1_10&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;22_1_20&#39;: ([&#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;],
                  [&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_100&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;],
                  [&#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;]),
                 &#39;28_9_101&#39;: ([&#39;1&#39;,
                   &#39;2&#39;,
                   &#39;4&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;3&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;]),
                 &#39;28_9_186&#39;: ([&#39;2&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;0&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;0&#39;,
                   &#39;3&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;],
                  [&#39;1&#39;,
                   &#39;1&#39;,
                   &#39;4&#39;,
                   &#39;0&#39;,
                   &#39;4&#39;,
                   &#39;3&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;1&#39;,
                   &#39;2&#39;])},
                16,
                OrderedDict([(&#39;1036&#39;,
                              ((0.5286265540286827,
                                0.13026233295708659,
                                0.3411111130142307),
                               (0.8613320900547093, 0.13866790994529055),
                               (0.5010800904732587,
                                0.4980826023946548,
                                0.000837307132086367),
                               (0.99999, 9.999999999954488e-06),
                               (0.9821, 0.017900000000000027),
                               (0.8466, 0.15339999999999998),
                               (0.7310965704069533,
                                0.2688987385890161,
                                4.6910040307397826e-06))),
                             (&#39;22_1&#39;,
                              ((0.6047240370708582,
                                0.3902151486330876,
                                0.005060814296054205),
                               (0.5530830184458694,
                                0.24964995462505854,
                                0.19726702692907214),
                               (0.9768, 0.0232),
                               (0.48440858277158266,
                                0.48151082454961897,
                                0.03408059267879841),
                               (0.99999, 9.99999999995449e-06),
                               (0.7927504201426182,
                                0.01717031968433133,
                                0.19007926017305032),
                               (0.9766016726686623,
                                0.005598541219160628,
                                0.017799786112177054),
                               (0.9986, 0.0013999999999999568),
                               (0.9999657926217794, 3.420737822050703e-05),
                               (0.8466, 0.15339999999999998),
                               (0.9304868324924078,
                                0.06949901650534375,
                                1.4151002248487355e-05),
                               (0.9995, 0.0004999999999999449),
                               (0.8660089037947565,
                                0.02531355791248566,
                                0.10867753829275789),
                               (0.9371286059455748,
                                0.04601093029611084,
                                0.016860463758314376),
                               (0.7075, 0.2925),
                               (0.5743034831820597,
                                0.21446658024612286,
                                0.21122993657181752))),
                             (&#39;28_9&#39;,
                              ((0.8023, 0.1977),
                               (0.6077219248814325,
                                0.39214961983958185,
                                0.00012845527898571837),
                               (0.5078619,
                                0.18113810000000002,
                                0.22923809999999994,
                                0.0817619),
                               (0.976835932494737,
                                0.023062064679197723,
                                5.1154417271776483e-05,
                                5.08484087935804e-05),
                               (0.8040110636455552,
                                0.19277924585798464,
                                0.002085047943677796,
                                0.0011246425527824543),
                               (0.9852702785678613,
                                0.011765016481583481,
                                0.0029647049505552524),
                               (0.9521, 0.047900000000000054),
                               (0.9995, 0.0004999999999999449),
                               (0.9979740648928657,
                                0.0018217208483351528,
                                0.00020421425879913634),
                               (0.951510197508,
                                8.980249200000978e-05,
                                0.048395432492,
                                4.567508000000497e-06),
                               (0.9532, 0.04679999999999995),
                               (0.7075, 0.2925),
                               (0.9771, 0.02290000000000003),
                               (0.7281, 0.27190000000000003),
                               (0.7309426337276147,
                                0.2688421203793674,
                                0.0002152458930179144),
                               (0.9917, 0.008299999999999974)))])]}),
             (&#39;format&#39;,
                 28_9_103 28_9_106 28_9_108 28_9_109 28_9_111 28_9_105 28_9_114 28_9_110  \
              0    (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 2)   (2, 1)   (2, 1)   (1, 2)   
              1    (2, 2)   (2, 0)   (2, 1)   (2, 1)   (2, 3)   (1, 2)   (1, 2)   (2, 1)   
              2    (2, 4)   (2, 3)   (2, 3)   (2, 4)   (2, 3)   (1, 4)   (1, 4)   (2, 3)   
              3    (4, 3)   (4, 3)   (4, 0)   (4, 0)   (4, 0)   (1, 2)   (1, 2)   (4, 0)   
              4    (1, 2)   (1, 3)   (1, 2)   (1, 4)   (1, 2)   (1, 2)   (1, 2)   (1, 2)   
              5    (1, 1)   (1, 2)   (1, 3)   (1, 3)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   
              6    (1, 1)   (1, 1)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   
              7    (2, 2)   (1, 1)   (2, 1)   (2, 0)   (2, 1)   (1, 2)   (1, 1)   (2, 1)   
              8    (1, 1)   (2, 1)   (1, 1)   (1, 3)   (1, 1)   (2, 1)   (1, 3)   (1, 1)   
              9    (1, 1)   (4, 1)   (1, 3)   (1, 1)   (1, 1)   (4, 1)   (1, 2)   (1, 1)   
              10   (1, 1)   (1, 1)   (1, 2)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   (1, 2)   
              11   (1, 1)   (2, 1)   (1, 1)   (1, 2)   (1, 2)   (2, 1)   (1, 2)   (1, 2)   
              12   (1, 1)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   (1, 2)   
              13   (1, 1)   (2, 1)   (1, 1)   (1, 2)   (1, 2)   (2, 1)   (1, 2)   (1, 2)   
              14   (1, 2)   (1, 2)   (1, 1)   (1, 2)   (1, 2)   (1, 3)   (1, 3)   (1, 2)   
              15   (1, 1)   (2, 1)   (1, 1)   (1, 1)   (1, 2)   (1, 1)   (1, 1)   (1, 1)   
              
                  1036_5 1036_99  ...  22_1_4  22_1_5 22_1_99  1036_1  1036_2 22_1_10  \
              0   (1, 1)  (1, 2)  ...  (2, 1)  (3, 1)  (3, 1)  (2, 0)  (1, 0)  (1, 2)   
              1   (1, 1)  (1, 2)  ...  (3, 2)  (1, 2)  (3, 2)  (2, 0)  (1, 0)  (2, 1)   
              2   (3, 1)  (1, 3)  ...  (1, 1)  (1, 1)  (1, 1)  (3, 0)  (1, 0)  (1, 2)   
              3   (1, 1)  (1, 2)  ...  (2, 1)  (2, 1)  (3, 1)  (2, 0)  (1, 0)  (1, 1)   
              4   (1, 1)  (1, 2)  ...  (1, 1)  (2, 1)  (1, 1)  (2, 0)  (1, 0)  (1, 1)   
              5   (2, 1)  (2, 1)  ...  (1, 1)  (3, 1)  (1, 1)  (1, 0)  (2, 0)  (1, 2)   
              6   (1, 2)  (3, 1)  ...  (1, 1)  (3, 1)  (1, 1)  (1, 0)  (3, 0)  (1, 2)   
              7   (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (1, 2)   
              8   (0, 0)  (0, 0)  ...  (2, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (1, 1)   
              9   (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (1, 2)   
              10  (0, 0)  (0, 0)  ...  (2, 1)  (1, 1)  (1, 3)  (0, 0)  (0, 0)  (3, 1)   
              11  (0, 0)  (0, 0)  ...  (1, 1)  (1, 2)  (1, 2)  (0, 0)  (0, 0)  (2, 1)   
              12  (0, 0)  (0, 0)  ...  (1, 1)  (1, 2)  (1, 1)  (0, 0)  (0, 0)  (2, 1)   
              13  (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (1, 1)  (0, 0)  (0, 0)  (2, 1)   
              14  (0, 0)  (0, 0)  ...  (1, 1)  (1, 1)  (2, 1)  (0, 0)  (0, 0)  (1, 1)   
              15  (0, 0)  (0, 0)  ...  (1, 1)  (1, 2)  (3, 2)  (0, 0)  (0, 0)  (1, 2)   
              
                 22_1_20 28_9_100 28_9_101 28_9_186  
              0   (3, 2)   (1, 2)   (1, 1)   (2, 1)  
              1   (1, 3)   (2, 1)   (2, 0)   (3, 1)  
              2   (2, 1)   (2, 1)   (4, 3)   (3, 4)  
              3   (3, 2)   (4, 1)   (2, 3)   (0, 0)  
              4   (2, 1)   (1, 1)   (2, 3)   (2, 4)  
              5   (3, 1)   (1, 1)   (1, 2)   (1, 3)  
              6   (3, 1)   (1, 1)   (1, 1)   (2, 1)  
              7   (0, 1)   (2, 1)   (2, 1)   (0, 1)  
              8   (2, 1)   (1, 2)   (1, 3)   (3, 1)  
              9   (1, 1)   (1, 4)   (1, 2)   (3, 1)  
              10  (2, 1)   (1, 1)   (1, 1)   (1, 2)  
              11  (1, 1)   (1, 2)   (1, 2)   (2, 1)  
              12  (3, 1)   (1, 1)   (1, 1)   (2, 1)  
              13  (3, 1)   (1, 2)   (1, 2)   (2, 1)  
              14  (2, 1)   (1, 1)   (2, 3)   (2, 1)  
              15  (3, 1)   (1, 2)   (1, 1)   (1, 2)  
              
              [16 rows x 25 columns])])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MC1R&#39;</span><span class="p">,</span><span class="s1">&#39;PAPPA2&#39;</span><span class="p">]}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/dtestpy3_fixedcoder_seqtest_20220126.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>

<span class="c1">#with open(&#39;dtestpy3_fixedcoder.pickle&#39;, &#39;rb&#39;) as handle:</span>
<span class="c1">#    b = pickle.load(handle)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MC1R&#39;</span><span class="p">,</span><span class="s1">&#39;PAPPA2&#39;</span><span class="p">]}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dtestpy3.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>

<span class="c1">#with open(&#39;dtestpy3.pickle&#39;, &#39;rb&#39;) as handle:</span>
<span class="c1">#    b = pickle.load(handle)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;MC1R&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;dregions&#39;,
              [[&#39;16&#39;,
                &#39;89984286&#39;,
                &#39;89987385&#39;,
                &#39;MC1R&#39;,
                &#39;133.689089888&#39;,
                &#39;159.050776809&#39;,
                &#39;111.195245154&#39;]]),
             (&#39;dvariants&#39;,
              [[[&#39;16&#39;, 89984370, &#39;MC1R&#39;, 0.00015],
                [&#39;16&#39;, 89984604, &#39;MC1R&#39;, 0.00015],
                [&#39;16&#39;, 89984739, &#39;MC1R&#39;, 0.00015],
                [&#39;16&#39;, 89985940, &#39;MC1R&#39;, 0.085784],
                [&#39;16&#39;, 89986608, &#39;MC1R&#39;, 0.107936],
                [&#39;16&#39;, 89986760, &#39;MC1R&#39;, 0.00015],
                [&#39;16&#39;, 89987201, &#39;MC1R&#39;, 0.00015]]]),
             (&#39;dfamvaridx&#39;,
              [{&#39;1&#39;: [0, 1, 2, 3, 4, 5, 6], &#39;2&#39;: [0, 1, 2, 3, 4, 5, 6]}]),
             (&#39;dgeno&#39;,
              [{&#39;II:2&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;],
                &#39;I:2&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;],
                &#39;I:1&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;],
                &#39;II:3&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;],
                &#39;II:4&#39;: [&#39;20&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;],
                &#39;II:1&#39;: [&#39;22&#39;, &#39;22&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;22&#39;],
                &#39;II:B&#39;: [&#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;],
                &#39;I:B&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;],
                &#39;I:A&#39;: [&#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;22&#39;],
                &#39;II:C&#39;: [&#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;],
                &#39;II:D&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;],
                &#39;II:A&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;]}]),
             (&#39;gss&#39;,
              [{0: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)},
                1: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)},
                2: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)},
                3: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)},
                4: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)},
                5: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)},
                6: {&#39;1&#39;: (&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;, &#39;22&#39;),
                 &#39;2&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;22&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;)}}]),
             (&#39;hapimp&#39;,
              {&#39;1&#39;: [&#39;1&#39;,
                [&#39;V0-89984370&#39;,
                 &#39;V1-89984604&#39;,
                 &#39;V2-89984739&#39;,
                 &#39;V3-89985940&#39;,
                 &#39;V4-89986608&#39;,
                 &#39;V5-89986760&#39;,
                 &#39;V6-89987201&#39;],
                [89984370,
                 89984604,
                 89984739,
                 89985940,
                 89986608,
                 89986760,
                 89987201],
                [0.00015,
                 0.00015,
                 0.00015,
                 0.085784,
                 0.107936,
                 0.00015,
                 0.00015],
                ((&#39;1&#39;, &#39;I:1&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;),
                 (&#39;1&#39;, &#39;I:1&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;),
                 (&#39;1&#39;, &#39;I:2&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;),
                 (&#39;1&#39;, &#39;I:2&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;),
                 (&#39;1&#39;, &#39;II:3&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;),
                 (&#39;1&#39;, &#39;II:3&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;),
                 (&#39;1&#39;, &#39;II:2&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;),
                 (&#39;1&#39;, &#39;II:2&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;),
                 (&#39;1&#39;, &#39;II:1&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;),
                 (&#39;1&#39;, &#39;II:1&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;),
                 (&#39;1&#39;, &#39;II:4&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2\\&#39;, &#39;2|&#39;),
                 (&#39;1&#39;, &#39;II:4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;))],
               &#39;2&#39;: [&#39;2&#39;,
                [&#39;V0-89984370&#39;,
                 &#39;V1-89984604&#39;,
                 &#39;V2-89984739&#39;,
                 &#39;V3-89985940&#39;,
                 &#39;V4-89986608&#39;,
                 &#39;V5-89986760&#39;,
                 &#39;V6-89987201&#39;],
                [89984370,
                 89984604,
                 89984739,
                 89985940,
                 89986608,
                 89986760,
                 89987201],
                [0.00015,
                 0.00015,
                 0.00015,
                 0.085784,
                 0.107936,
                 0.00015,
                 0.00015],
                ((&#39;2&#39;, &#39;I:A&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;),
                 (&#39;2&#39;, &#39;I:A&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;),
                 (&#39;2&#39;, &#39;I:B&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;),
                 (&#39;2&#39;, &#39;I:B&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;),
                 (&#39;2&#39;, &#39;II:D&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;),
                 (&#39;2&#39;, &#39;II:D&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;),
                 (&#39;2&#39;, &#39;II:C&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;),
                 (&#39;2&#39;, &#39;II:C&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;),
                 (&#39;2&#39;, &#39;II:B&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;),
                 (&#39;2&#39;, &#39;II:B&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;),
                 (&#39;2&#39;, &#39;II:A&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;),
                 (&#39;2&#39;, &#39;II:A&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;)),
                {&#39;V0-89984370&#39;: 0.00015,
                 &#39;V1-89984604&#39;: 0.00015,
                 &#39;V2-89984739&#39;: 0.00015,
                 &#39;V3-89985940&#39;: 0.085784,
                 &#39;V4-89986608&#39;: 0.107936,
                 &#39;V5-89986760&#39;: 0.00015,
                 &#39;V6-89987201&#39;: 0.00015}]}),
             (&#39;ld&#39;,
              [[[None],
                [1.0, None],
                [0.2380952380952381, 0.2380952380952381, None],
                [0.2380952380952381, 0.2380952380952381, 1.0, None],
                [0.2380952380952381, 0.2380952380952381, 1.0, 1.0, None],
                [0.5555555555555556,
                 0.5555555555555556,
                 0.42857142857142866,
                 0.42857142857142866,
                 0.42857142857142866,
                 None],
                [0.06666666666666665,
                 0.06666666666666665,
                 0.14285714285714282,
                 0.14285714285714282,
                 0.14285714285714282,
                 0.0,
                 None]],
               [[0, 1], [2, 3, 4], [3, 4]],
               [[&#39;V0-89984370&#39;, &#39;V1-89984604&#39;],
                [&#39;V2-89984739&#39;, &#39;V3-89985940&#39;, &#39;V4-89986608&#39;]]]),
             (&#39;coder&#39;,
              {&#39;input&#39;: [{&#39;II:2&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;],
                 &#39;I:2&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;],
                 &#39;I:1&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;],
                 &#39;II:3&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;],
                 &#39;II:4&#39;: [&#39;20&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;22&#39;],
                 &#39;II:1&#39;: [&#39;22&#39;, &#39;22&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;22&#39;],
                 &#39;II:B&#39;: [&#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;],
                 &#39;I:B&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;],
                 &#39;I:A&#39;: [&#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;22&#39;],
                 &#39;II:C&#39;: [&#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;],
                 &#39;II:D&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;],
                 &#39;II:A&#39;: [&#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;, &#39;12&#39;]},
                OrderedDict([(&#39;1&#39;,
                              [[&#39;1&#39;,
                                &#39;I:1&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;1&#39;,
                                &#39;I:1&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;],
                               [&#39;1&#39;,
                                &#39;I:2&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;],
                               [&#39;1&#39;,
                                &#39;I:2&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;1&#39;,
                                &#39;II:3&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:3&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:2&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:2&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:1&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:1&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:4&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2\\&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:4&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1\\&#39;,
                                &#39;2|&#39;]]),
                             (&#39;2&#39;,
                              [[&#39;2&#39;,
                                &#39;I:A&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;],
                               [&#39;2&#39;,
                                &#39;I:A&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;],
                               [&#39;2&#39;,
                                &#39;I:B&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;I:B&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;II:D&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;II:D&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;],
                               [&#39;2&#39;,
                                &#39;II:C&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;II:C&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;],
                               [&#39;2&#39;,
                                &#39;II:B&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;II:B&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;],
                               [&#39;2&#39;,
                                &#39;II:A&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;II:A&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;]])]),
                {&#39;V0-89984370&#39;: 0.00015,
                 &#39;V1-89984604&#39;: 0.00015,
                 &#39;V2-89984739&#39;: 0.00015,
                 &#39;V3-89985940&#39;: 0.085784,
                 &#39;V4-89986608&#39;: 0.107936,
                 &#39;V5-89986760&#39;: 0.00015,
                 &#39;V6-89987201&#39;: 0.00015},
                {&#39;1&#39;: [&#39;V0-89984370&#39;,
                  &#39;V1-89984604&#39;,
                  &#39;V2-89984739&#39;,
                  &#39;V3-89985940&#39;,
                  &#39;V4-89986608&#39;,
                  &#39;V5-89986760&#39;,
                  &#39;V6-89987201&#39;],
                 &#39;2&#39;: [&#39;V0-89984370&#39;,
                  &#39;V1-89984604&#39;,
                  &#39;V2-89984739&#39;,
                  &#39;V3-89985940&#39;,
                  &#39;V4-89986608&#39;,
                  &#39;V5-89986760&#39;,
                  &#39;V6-89987201&#39;]},
                [[&#39;V0-89984370&#39;, &#39;V1-89984604&#39;],
                 [&#39;V2-89984739&#39;, &#39;V3-89985940&#39;, &#39;V4-89986608&#39;]]],
               &#39;output&#39;: [((&#39;1&#39;, &#39;I:1&#39;, &#39;1,1&#39;, &#39;1111,11&#39;, &#39;2,2&#39;, &#39;2222,12&#39;),
                 (&#39;1&#39;, &#39;I:2&#39;, &#39;2,3&#39;, &#39;2222,22&#39;, &#39;1,1&#39;, &#39;1111,11&#39;),
                 (&#39;1&#39;, &#39;II:3&#39;, &#39;2,3&#39;, &#39;2222,22&#39;, &#39;1,1&#39;, &#39;1111,11&#39;),
                 (&#39;1&#39;, &#39;II:2&#39;, &#39;2,3&#39;, &#39;2222,22&#39;, &#39;1,1&#39;, &#39;1111,11&#39;),
                 (&#39;1&#39;, &#39;II:1&#39;, &#39;2,3&#39;, &#39;2222,22&#39;, &#39;2,2&#39;, &#39;2222,12&#39;),
                 (&#39;1&#39;, &#39;II:4&#39;, &#39;2,3&#39;, &#39;2222,22&#39;, &#39;1,2&#39;, &#39;1111,12&#39;),
                 (&#39;2&#39;, &#39;I:A&#39;, &#39;2&#39;, &#39;111112&#39;, &#39;2&#39;, &#39;111112&#39;),
                 (&#39;2&#39;, &#39;I:B&#39;, &#39;3&#39;, &#39;222221&#39;, &#39;1&#39;, &#39;111111&#39;),
                 (&#39;2&#39;, &#39;II:D&#39;, &#39;3&#39;, &#39;222221&#39;, &#39;2&#39;, &#39;111112&#39;),
                 (&#39;2&#39;, &#39;II:C&#39;, &#39;1&#39;, &#39;111111&#39;, &#39;2&#39;, &#39;111112&#39;),
                 (&#39;2&#39;, &#39;II:B&#39;, &#39;1&#39;, &#39;111111&#39;, &#39;2&#39;, &#39;111112&#39;),
                 (&#39;2&#39;, &#39;II:A&#39;, &#39;3&#39;, &#39;222221&#39;, &#39;2&#39;, &#39;111112&#39;)),
                {&#39;II:2&#39;: ([&#39;2&#39;, &#39;3&#39;], [&#39;2222&#39;, &#39;22&#39;]),
                 &#39;I:2&#39;: ([&#39;2&#39;, &#39;3&#39;], [&#39;2222&#39;, &#39;22&#39;]),
                 &#39;I:1&#39;: ([&#39;1&#39;, &#39;1&#39;], [&#39;1111&#39;, &#39;11&#39;]),
                 &#39;II:3&#39;: ([&#39;2&#39;, &#39;3&#39;], [&#39;2222&#39;, &#39;22&#39;]),
                 &#39;II:4&#39;: ([&#39;2&#39;, &#39;3&#39;], [&#39;2222&#39;, &#39;22&#39;]),
                 &#39;II:1&#39;: ([&#39;2&#39;, &#39;3&#39;], [&#39;2222&#39;, &#39;22&#39;]),
                 &#39;II:B&#39;: ([&#39;1&#39;], [&#39;111111&#39;]),
                 &#39;I:B&#39;: ([&#39;3&#39;], [&#39;222221&#39;]),
                 &#39;I:A&#39;: ([&#39;2&#39;], [&#39;111112&#39;]),
                 &#39;II:C&#39;: ([&#39;1&#39;], [&#39;111111&#39;]),
                 &#39;II:D&#39;: ([&#39;3&#39;], [&#39;222221&#39;]),
                 &#39;II:A&#39;: ([&#39;3&#39;], [&#39;222221&#39;])},
                2,
                OrderedDict([(&#39;1&#39;,
                              ((0.999999999999997, 3.0400071909574507e-15),
                               (0.9995498650574084,
                                0.000449932412250011,
                                2.0253034157679256e-07))),
                             (&#39;2&#39;,
                              ((0.999550067496625,
                                0.0004499325033749946,
                                1.3677980457054751e-18),))])]}),
             (&#39;format&#39;,
              {&#39;II:2&#39;: [(&#39;2&#39;, &#39;2222&#39;), (&#39;3&#39;, &#39;22&#39;)],
               &#39;I:2&#39;: [(&#39;2&#39;, &#39;2222&#39;), (&#39;3&#39;, &#39;22&#39;)],
               &#39;I:1&#39;: [(&#39;1&#39;, &#39;1111&#39;), (&#39;1&#39;, &#39;11&#39;)],
               &#39;II:3&#39;: [(&#39;2&#39;, &#39;2222&#39;), (&#39;3&#39;, &#39;22&#39;)],
               &#39;II:4&#39;: [(&#39;2&#39;, &#39;2222&#39;), (&#39;3&#39;, &#39;22&#39;)],
               &#39;II:1&#39;: [(&#39;2&#39;, &#39;2222&#39;), (&#39;3&#39;, &#39;22&#39;)],
               &#39;II:B&#39;: [(&#39;1&#39;, &#39;111111&#39;), (&#39;0&#39;, &#39;0&#39;)],
               &#39;I:B&#39;: [(&#39;3&#39;, &#39;222221&#39;), (&#39;0&#39;, &#39;0&#39;)],
               &#39;I:A&#39;: [(&#39;2&#39;, &#39;111112&#39;), (&#39;0&#39;, &#39;0&#39;)],
               &#39;II:C&#39;: [(&#39;1&#39;, &#39;111111&#39;), (&#39;0&#39;, &#39;0&#39;)],
               &#39;II:D&#39;: [(&#39;3&#39;, &#39;222221&#39;), (&#39;0&#39;, &#39;0&#39;)],
               &#39;II:A&#39;: [(&#39;3&#39;, &#39;222221&#39;), (&#39;0&#39;, &#39;0&#39;)]})])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;PAPPA2&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;dregions&#39;,
              [[&#39;1&#39;,
                &#39;176432306&#39;,
                &#39;176811970&#39;,
                &#39;PAPPA2&#39;,
                &#39;186.278964324&#39;,
                &#39;238.991541401&#39;,
                &#39;136.402021932&#39;]]),
             (&#39;dvariants&#39;,
              [[[&#39;1&#39;, 176659933, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176660247, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176660371, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176664842, &#39;PAPPA2&#39;, 0.241943],
                [&#39;1&#39;, 176668823, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176671914, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176679384, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176734756, &#39;PAPPA2&#39;, 0.352899],
                [&#39;1&#39;, 176811754, &#39;PAPPA2&#39;, 0.00015],
                [&#39;1&#39;, 176811873, &#39;PAPPA2&#39;, 0.00015]]]),
             (&#39;dfamvaridx&#39;,
              [{&#39;1&#39;: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
                &#39;2&#39;: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]}]),
             (&#39;dgeno&#39;,
              [{&#39;II:2&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;],
                &#39;I:2&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;],
                &#39;I:1&#39;: [&#39;12&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;II:3&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;],
                &#39;II:4&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;11&#39;],
                &#39;II:1&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;],
                &#39;II:B&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;I:B&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;22&#39;,
                 &#39;22&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;I:A&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;II:C&#39;: [&#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;,
                 &#39;11&#39;],
                &#39;II:D&#39;: [&#39;11&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;],
                &#39;II:A&#39;: [&#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;11&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;,
                 &#39;12&#39;]}]),
             (&#39;gss&#39;,
              [{0: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                1: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                2: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                3: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                4: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                5: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                6: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                7: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                8: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)},
                9: {&#39;1&#39;: (&#39;12&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;, &#39;11&#39;, &#39;12&#39;),
                 &#39;2&#39;: (&#39;11&#39;, &#39;12&#39;, &#39;11&#39;, &#39;11&#39;, &#39;12&#39;, &#39;12&#39;)}}]),
             (&#39;hapimp&#39;,
              {&#39;1&#39;: [&#39;1&#39;,
                [&#39;V0-176659933&#39;,
                 &#39;V1-176660247&#39;,
                 &#39;V2-176660371&#39;,
                 &#39;V3-176664842&#39;,
                 &#39;V4-176668823&#39;,
                 &#39;V5-176671914&#39;,
                 &#39;V6-176679384&#39;,
                 &#39;V7-176734756&#39;,
                 &#39;V8-176811754&#39;,
                 &#39;V9-176811873&#39;],
                [176659933,
                 176660247,
                 176660371,
                 176664842,
                 176668823,
                 176671914,
                 176679384,
                 176734756,
                 176811754,
                 176811873],
                [0.00015,
                 0.00015,
                 0.00015,
                 0.241943,
                 0.00015,
                 0.00015,
                 0.00015,
                 0.352899,
                 0.00015,
                 0.00015],
                ((&#39;1&#39;,
                  &#39;I:1&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;),
                 (&#39;1&#39;,
                  &#39;I:1&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;),
                 (&#39;1&#39;,
                  &#39;I:2&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;),
                 (&#39;1&#39;,
                  &#39;I:2&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;),
                 (&#39;1&#39;,
                  &#39;II:4&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;),
                 (&#39;1&#39;,
                  &#39;II:4&#39;,
                  &#39;1:&#39;,
                  &#39;2|&#39;,
                  &#39;2:&#39;,
                  &#39;2|&#39;,
                  &#39;2:&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;),
                 (&#39;1&#39;,
                  &#39;II:3&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;1&#39;,
                  &#39;II:3&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;),
                 (&#39;1&#39;,
                  &#39;II:2&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;1&#39;,
                  &#39;II:2&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;),
                 (&#39;1&#39;,
                  &#39;II:1&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;1&#39;,
                  &#39;II:1&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;))],
               &#39;2&#39;: [&#39;2&#39;,
                [&#39;V0-176659933&#39;,
                 &#39;V1-176660247&#39;,
                 &#39;V2-176660371&#39;,
                 &#39;V3-176664842&#39;,
                 &#39;V4-176668823&#39;,
                 &#39;V5-176671914&#39;,
                 &#39;V6-176679384&#39;,
                 &#39;V7-176734756&#39;,
                 &#39;V8-176811754&#39;,
                 &#39;V9-176811873&#39;],
                [176659933,
                 176660247,
                 176660371,
                 176664842,
                 176668823,
                 176671914,
                 176679384,
                 176734756,
                 176811754,
                 176811873],
                [0.00015,
                 0.00015,
                 0.00015,
                 0.241943,
                 0.00015,
                 0.00015,
                 0.00015,
                 0.352899,
                 0.00015,
                 0.00015],
                ((&#39;2&#39;,
                  &#39;I:A&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;),
                 (&#39;2&#39;,
                  &#39;I:A&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;),
                 (&#39;2&#39;,
                  &#39;I:B&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;),
                 (&#39;2&#39;,
                  &#39;I:B&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;),
                 (&#39;2&#39;,
                  &#39;II:D&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;),
                 (&#39;2&#39;,
                  &#39;II:D&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;2&#39;,
                  &#39;II:C&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;2&#39;,
                  &#39;II:C&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;2&#39;,
                  &#39;II:B&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;2&#39;,
                  &#39;II:B&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;),
                 (&#39;2&#39;,
                  &#39;II:A&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;2:&#39;,
                  &#39;2:&#39;,
                  &#39;1|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;,
                  &#39;2|&#39;),
                 (&#39;2&#39;,
                  &#39;II:A&#39;,
                  &#39;1:&#39;,
                  &#39;2|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1:&#39;,
                  &#39;1:&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;,
                  &#39;1|&#39;)),
                {&#39;V0-176659933&#39;: 0.00015,
                 &#39;V1-176660247&#39;: 0.00015,
                 &#39;V2-176660371&#39;: 0.00015,
                 &#39;V3-176664842&#39;: 0.241943,
                 &#39;V4-176668823&#39;: 0.00015,
                 &#39;V5-176671914&#39;: 0.00015,
                 &#39;V6-176679384&#39;: 0.00015,
                 &#39;V7-176734756&#39;: 0.352899,
                 &#39;V8-176811754&#39;: 0.00015,
                 &#39;V9-176811873&#39;: 0.00015}]}),
             (&#39;ld&#39;,
              [[[None],
                [0.1111111111111111, None],
                [0.022222222222222223, 0.022222222222222223, None],
                [0.1111111111111111,
                 0.1111111111111111,
                 0.022222222222222223,
                 None],
                [0.3333333333333334,
                 0.0,
                 0.6000000000000001,
                 0.3333333333333334,
                 None],
                [0.022222222222222223,
                 0.022222222222222223,
                 0.2177777777777778,
                 0.5555555555555556,
                 0.6000000000000001,
                 None],
                [0.1111111111111111,
                 0.1111111111111111,
                 0.022222222222222223,
                 1.0,
                 0.3333333333333334,
                 0.5555555555555556,
                 None],
                [0.0,
                 0.0,
                 0.6000000000000001,
                 0.0,
                 0.25,
                 0.06666666666666665,
                 0.0,
                 None],
                [0.19999999999999998,
                 0.022222222222222223,
                 0.2177777777777778,
                 0.022222222222222223,
                 0.06666666666666665,
                 0.2177777777777778,
                 0.022222222222222223,
                 0.6000000000000001,
                 None],
                [0.1111111111111111,
                 0.1111111111111111,
                 0.5555555555555556,
                 0.1111111111111111,
                 0.3333333333333334,
                 0.022222222222222223,
                 0.1111111111111111,
                 0.3333333333333334,
                 0.022222222222222223,
                 None]],
               [[3, 6]],
               [[&#39;V3-176664842&#39;, &#39;V6-176679384&#39;]]]),
             (&#39;coder&#39;,
              {&#39;input&#39;: [{&#39;II:2&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;],
                 &#39;I:2&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;],
                 &#39;I:1&#39;: [&#39;12&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;II:3&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;],
                 &#39;II:4&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;11&#39;],
                 &#39;II:1&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;],
                 &#39;II:B&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;I:B&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;22&#39;,
                  &#39;22&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;I:A&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;II:C&#39;: [&#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;,
                  &#39;11&#39;],
                 &#39;II:D&#39;: [&#39;11&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;],
                 &#39;II:A&#39;: [&#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;11&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;,
                  &#39;12&#39;]},
                OrderedDict([(&#39;1&#39;,
                              [[&#39;1&#39;,
                                &#39;I:1&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;],
                               [&#39;1&#39;,
                                &#39;I:1&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;],
                               [&#39;1&#39;,
                                &#39;I:2&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;],
                               [&#39;1&#39;,
                                &#39;I:2&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;1&#39;,
                                &#39;II:4&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:4&#39;,
                                &#39;1:&#39;,
                                &#39;2|&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:3&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:3&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:2&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:2&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;],
                               [&#39;1&#39;,
                                &#39;II:1&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;1&#39;,
                                &#39;II:1&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;]]),
                             (&#39;2&#39;,
                              [[&#39;2&#39;,
                                &#39;I:A&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;I:A&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;I:B&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;],
                               [&#39;2&#39;,
                                &#39;I:B&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;],
                               [&#39;2&#39;,
                                &#39;II:D&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;],
                               [&#39;2&#39;,
                                &#39;II:D&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;2&#39;,
                                &#39;II:C&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;2&#39;,
                                &#39;II:C&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;2&#39;,
                                &#39;II:B&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;2&#39;,
                                &#39;II:B&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;],
                               [&#39;2&#39;,
                                &#39;II:A&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;2:&#39;,
                                &#39;2:&#39;,
                                &#39;1|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;,
                                &#39;2|&#39;],
                               [&#39;2&#39;,
                                &#39;II:A&#39;,
                                &#39;1:&#39;,
                                &#39;2|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1:&#39;,
                                &#39;1:&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;,
                                &#39;1|&#39;]])]),
                {&#39;V0-176659933&#39;: 0.00015,
                 &#39;V1-176660247&#39;: 0.00015,
                 &#39;V2-176660371&#39;: 0.00015,
                 &#39;V3-176664842&#39;: 0.241943,
                 &#39;V4-176668823&#39;: 0.00015,
                 &#39;V5-176671914&#39;: 0.00015,
                 &#39;V6-176679384&#39;: 0.00015,
                 &#39;V7-176734756&#39;: 0.352899,
                 &#39;V8-176811754&#39;: 0.00015,
                 &#39;V9-176811873&#39;: 0.00015},
                {&#39;1&#39;: [&#39;V0-176659933&#39;,
                  &#39;V1-176660247&#39;,
                  &#39;V2-176660371&#39;,
                  &#39;V3-176664842&#39;,
                  &#39;V4-176668823&#39;,
                  &#39;V5-176671914&#39;,
                  &#39;V6-176679384&#39;,
                  &#39;V7-176734756&#39;,
                  &#39;V8-176811754&#39;,
                  &#39;V9-176811873&#39;],
                 &#39;2&#39;: [&#39;V0-176659933&#39;,
                  &#39;V1-176660247&#39;,
                  &#39;V2-176660371&#39;,
                  &#39;V3-176664842&#39;,
                  &#39;V4-176668823&#39;,
                  &#39;V5-176671914&#39;,
                  &#39;V6-176679384&#39;,
                  &#39;V7-176734756&#39;,
                  &#39;V8-176811754&#39;,
                  &#39;V9-176811873&#39;]},
                [[&#39;V3-176664842&#39;, &#39;V6-176679384&#39;]]],
               &#39;output&#39;: [((&#39;1&#39;, &#39;I:1&#39;, &#39;4&#39;, &#39;1222222221&#39;, &#39;3&#39;, &#39;2122212212&#39;),
                 (&#39;1&#39;, &#39;I:2&#39;, &#39;2&#39;, &#39;1111111221&#39;, &#39;1&#39;, &#39;1111111111&#39;),
                 (&#39;1&#39;, &#39;II:4&#39;, &#39;2&#39;, &#39;1111111221&#39;, &#39;4&#39;, &#39;1222222221&#39;),
                 (&#39;1&#39;, &#39;II:3&#39;, &#39;1&#39;, &#39;1111111111&#39;, &#39;3&#39;, &#39;2122212212&#39;),
                 (&#39;1&#39;, &#39;II:2&#39;, &#39;1&#39;, &#39;1111111111&#39;, &#39;3&#39;, &#39;2122212212&#39;),
                 (&#39;1&#39;, &#39;II:1&#39;, &#39;1&#39;, &#39;1111111111&#39;, &#39;3&#39;, &#39;2122212212&#39;),
                 (&#39;2&#39;, &#39;I:A&#39;, &#39;1&#39;, &#39;1111111111&#39;, &#39;2&#39;, &#39;1212112111&#39;),
                 (&#39;2&#39;, &#39;I:B&#39;, &#39;4&#39;, &#39;1121221222&#39;, &#39;3&#39;, &#39;2112222111&#39;),
                 (&#39;2&#39;, &#39;II:D&#39;, &#39;4&#39;, &#39;1121221222&#39;, &#39;1&#39;, &#39;1111111111&#39;),
                 (&#39;2&#39;, &#39;II:C&#39;, &#39;3&#39;, &#39;2112222111&#39;, &#39;1&#39;, &#39;1111111111&#39;),
                 (&#39;2&#39;, &#39;II:B&#39;, &#39;3&#39;, &#39;2112222111&#39;, &#39;1&#39;, &#39;1111111111&#39;),
                 (&#39;2&#39;, &#39;II:A&#39;, &#39;4&#39;, &#39;1121221222&#39;, &#39;2&#39;, &#39;1212112111&#39;)),
                {&#39;II:2&#39;: ([&#39;1&#39;], [&#39;1111111111&#39;]),
                 &#39;I:2&#39;: ([&#39;2&#39;], [&#39;1111111221&#39;]),
                 &#39;I:1&#39;: ([&#39;4&#39;], [&#39;1222222221&#39;]),
                 &#39;II:3&#39;: ([&#39;1&#39;], [&#39;1111111111&#39;]),
                 &#39;II:4&#39;: ([&#39;2&#39;], [&#39;1111111221&#39;]),
                 &#39;II:1&#39;: ([&#39;1&#39;], [&#39;1111111111&#39;]),
                 &#39;II:B&#39;: ([&#39;3&#39;], [&#39;2112222111&#39;]),
                 &#39;I:B&#39;: ([&#39;4&#39;], [&#39;1121221222&#39;]),
                 &#39;I:A&#39;: ([&#39;1&#39;], [&#39;1111111111&#39;]),
                 &#39;II:C&#39;: ([&#39;3&#39;], [&#39;2112222111&#39;]),
                 &#39;II:D&#39;: ([&#39;4&#39;], [&#39;1121221222&#39;]),
                 &#39;II:A&#39;: ([&#39;4&#39;], [&#39;1121221222&#39;])},
                1,
                OrderedDict([(&#39;1&#39;,
                              ((0.9998363838109469,
                                0.00016361618905309718,
                                1.3225147758256331e-20,
                                7.937469761930493e-24),)),
                             (&#39;2&#39;,
                              ((0.9999999928166995,
                                7.183300126057594e-09,
                                3.233697565987606e-16,
                                1.6580038589959425e-19),))])]}),
             (&#39;format&#39;,
              {&#39;II:2&#39;: [(&#39;1&#39;, &#39;1111111111&#39;)],
               &#39;I:2&#39;: [(&#39;2&#39;, &#39;1111111221&#39;)],
               &#39;I:1&#39;: [(&#39;4&#39;, &#39;1222222221&#39;)],
               &#39;II:3&#39;: [(&#39;1&#39;, &#39;1111111111&#39;)],
               &#39;II:4&#39;: [(&#39;2&#39;, &#39;1111111221&#39;)],
               &#39;II:1&#39;: [(&#39;1&#39;, &#39;1111111111&#39;)],
               &#39;II:B&#39;: [(&#39;3&#39;, &#39;2112222111&#39;)],
               &#39;I:B&#39;: [(&#39;4&#39;, &#39;1121221222&#39;)],
               &#39;I:A&#39;: [(&#39;1&#39;, &#39;1111111111&#39;)],
               &#39;II:C&#39;: [(&#39;3&#39;, &#39;2112222111&#39;)],
               &#39;II:D&#39;: [(&#39;4&#39;, &#39;1121221222&#39;)],
               &#39;II:A&#39;: [(&#39;4&#39;, &#39;1121221222&#39;)]})])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="One-region-test">One region test<a class="anchor-link" href="#One-region-test"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">,</span><span class="mi">2234061</span><span class="p">,</span><span class="mi">2234150</span><span class="p">,</span> <span class="s1">&#39;MIR1227&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">region</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">region</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">region</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">,</span><span class="mi">281043</span><span class="p">,</span> <span class="mi">291404</span><span class="p">,</span> <span class="s1">&#39;PLPP2&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;19&#39;,
 281043,
 291404,
 &#39;PLPP2&#39;,
 &#39;1.5299877409602128e-06&#39;,
 &#39;1.94345806118021e-06&#39;,
 &#39;1.136044574393209e-06&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractor</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="n">maker</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">recomb</span><span class="o">=</span><span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="s1">&#39;PLPP2&#39;</span><span class="p">][</span><span class="s1">&#39;coder&#39;</span><span class="p">][</span><span class="s1">&#39;input&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/tmp/2206534.1.plot.q/ipykernel_11087/836524231.py:1: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.
  np.array(list(env.dtest[&#39;PLPP2&#39;][&#39;coder&#39;][&#39;input&#39;][2].values()))
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([array([2.110e-01, 1.600e-03, 5.900e-03, 4.090e-01, 2.050e-02, 1.667e-01,
              8.800e-03, 1.160e-02, 2.000e-04, 2.200e-03, 8.500e-03, 6.690e-01,
              2.879e-01, 2.920e-02, 3.965e-01, 3.831e-01, 3.835e-01, 7.639e-01,
              6.382e-01, 3.000e-04, 7.802e-01, 6.283e-01, 6.351e-01, 5.990e-01,
              6.964e-01, 6.952e-01, 5.411e-01, 5.218e-01, 3.200e-03, 3.876e-01,
              6.406e-01, 1.550e-02, 4.881e-01, 4.506e-01])                     ,
       array([4.540e-02, 4.315e-01, 2.000e-04, 1.549e-05, 2.800e-02, 2.000e-04,
              1.549e-05, 2.000e-04, 2.207e-01, 1.745e-01, 2.000e-04, 2.000e-04,
              2.000e-04, 6.592e-01, 2.233e-01, 1.700e-03, 4.849e-01, 4.817e-01,
              4.818e-01, 8.516e-01, 2.000e-04, 6.285e-01, 1.000e-04, 7.651e-01,
              6.267e-01, 4.661e-05, 6.262e-01, 5.768e-01, 7.025e-01, 7.027e-01,
              6.634e-01, 6.044e-01, 2.762e-01, 2.000e-04, 6.839e-01, 5.495e-01,
              3.786e-01, 6.000e-04])                                           ,
       array([3.465e-01, 4.315e-01, 2.000e-04, 2.800e-02, 2.207e-01, 2.117e-01,
              2.116e-01, 2.000e-04, 6.592e-01, 4.849e-01, 4.817e-01, 4.818e-01,
              8.516e-01, 9.292e-05, 6.285e-01, 7.651e-01, 6.267e-01, 6.262e-01,
              5.768e-01, 7.025e-01, 7.027e-01, 6.634e-01, 6.044e-01, 2.762e-01,
              1.260e-02, 6.839e-01, 5.495e-01, 3.786e-01])                     ],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="s1">&#39;PLPP2&#39;</span><span class="p">][</span><span class="s1">&#39;coder&#39;</span><span class="p">][</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((&#39;1036&#39;, &#39;1036_1&#39;, &#39;9&#39;, &#39;2121222111221111112222222222112122&#39;, &#39;0&#39;, &#39;NULL&#39;),
  (&#39;1036&#39;, &#39;1036_2&#39;, &#39;3&#39;, &#39;2112111121111122211111111111111111&#39;, &#39;0&#39;, &#39;NULL&#39;),
  (&#39;1036&#39;,
   &#39;1036_6&#39;,
   &#39;2&#39;,
   &#39;1111221111121111111111111111211112&#39;,
   &#39;5&#39;,
   &#39;2112111121111122221111111111111111&#39;),
  (&#39;1036&#39;,
   &#39;1036_99&#39;,
   &#39;3&#39;,
   &#39;2112111121111122211111111111111111&#39;,
   &#39;9&#39;,
   &#39;2121222111221111112222222222112122&#39;),
  (&#39;1036&#39;,
   &#39;1036_5&#39;,
   &#39;8&#39;,
   &#39;2112111121111111112112221221111111&#39;,
   &#39;1&#39;,
   &#39;1111111111111122221111111111111111&#39;),
  (&#39;1036&#39;,
   &#39;1036_4&#39;,
   &#39;3&#39;,
   &#39;2112111121111122211111111111111111&#39;,
   &#39;4&#39;,
   &#39;1111221111121111121111111111211112&#39;),
  (&#39;1036&#39;,
   &#39;1036_3&#39;,
   &#39;6&#39;,
   &#39;2112111121111122211111111111111112&#39;,
   &#39;7&#39;,
   &#39;2112111121111122221111111111111112&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_10&#39;,
   &#39;11&#39;,
   &#39;11111111112111112221111122222222211111&#39;,
   &#39;14&#39;,
   &#39;22212212121221221111212211111111112221&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_20&#39;,
   &#39;9&#39;,
   &#39;12122121212111112221111111111111121122&#39;,
   &#39;4&#39;,
   &#39;12111111111112111112121121221111112111&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_4&#39;,
   &#39;8&#39;,
   &#39;12121111211112111112121121221111112111&#39;,
   &#39;5&#39;,
   &#39;11111112121221112111112211111111112211&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_3&#39;,
   &#39;6&#39;,
   &#39;12111121111112111112121121221111112111&#39;,
   &#39;12&#39;,
   &#39;11111111112111221111111121222222212221&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_2&#39;,
   &#39;1&#39;,
   &#39;12111111111111112111111111111111121122&#39;,
   &#39;13&#39;,
   &#39;11212212121221221111211122211111112221&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_99&#39;,
   &#39;7&#39;,
   &#39;12112111111112111112121121221111112111&#39;,
   &#39;10&#39;,
   &#39;11112111112111112221111111112222211221&#39;),
  (&#39;22_1&#39;,
   &#39;22_1_5&#39;,
   &#39;2&#39;,
   &#39;12111111112111112221111111111111111111&#39;,
   &#39;3&#39;,
   &#39;22111111112111112221111111111111111111&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_100&#39;,
   &#39;1&#39;,
   &#39;1211111212221111111111111111&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_101&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;,
   &#39;5&#39;,
   &#39;2122222121112122222222221221&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_186&#39;,
   &#39;2&#39;,
   &#39;1211111212221211111111111111&#39;,
   &#39;3&#39;,
   &#39;1211111212221111111111111112&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_114&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_106&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;,
   &#39;5&#39;,
   &#39;2122222121112122222222221221&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_105&#39;,
   &#39;1&#39;,
   &#39;1211111212221111111111111111&#39;,
   &#39;5&#39;,
   &#39;2122222121112122222222221221&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_103&#39;,
   &#39;1&#39;,
   &#39;1211111212221111111111111111&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_111&#39;,
   &#39;1&#39;,
   &#39;1211111212221111111111111111&#39;,
   &#39;2&#39;,
   &#39;1211111212221211111111111111&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_110&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;,
   &#39;2&#39;,
   &#39;1211111212221211111111111111&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_109&#39;,
   &#39;4&#39;,
   &#39;1211111212221111111111112112&#39;,
   &#39;3&#39;,
   &#39;1211111212221111111111111112&#39;),
  (&#39;28_9&#39;,
   &#39;28_9_108&#39;,
   &#39;1&#39;,
   &#39;1211111212221111111111111111&#39;,
   &#39;2&#39;,
   &#39;1211111212221211111111111111&#39;)),
 {&#39;1036_3&#39;: ([&#39;6&#39;], [&#39;7&#39;]),
  &#39;1036_2&#39;: ([&#39;3&#39;], [&#39;0&#39;]),
  &#39;1036_1&#39;: ([&#39;9&#39;], [&#39;0&#39;]),
  &#39;1036_5&#39;: ([&#39;8&#39;], [&#39;1&#39;]),
  &#39;1036_99&#39;: ([&#39;3&#39;], [&#39;9&#39;]),
  &#39;1036_6&#39;: ([&#39;2&#39;], [&#39;5&#39;]),
  &#39;1036_4&#39;: ([&#39;3&#39;], [&#39;4&#39;]),
  &#39;22_1_20&#39;: ([&#39;9&#39;], [&#39;4&#39;]),
  &#39;22_1_10&#39;: ([&#39;11&#39;], [&#39;14&#39;]),
  &#39;22_1_99&#39;: ([&#39;7&#39;], [&#39;10&#39;]),
  &#39;22_1_5&#39;: ([&#39;2&#39;], [&#39;3&#39;]),
  &#39;22_1_4&#39;: ([&#39;8&#39;], [&#39;5&#39;]),
  &#39;22_1_2&#39;: ([&#39;1&#39;], [&#39;13&#39;]),
  &#39;22_1_3&#39;: ([&#39;6&#39;], [&#39;12&#39;]),
  &#39;28_9_100&#39;: ([&#39;1&#39;], [&#39;4&#39;]),
  &#39;28_9_103&#39;: ([&#39;1&#39;], [&#39;4&#39;]),
  &#39;28_9_110&#39;: ([&#39;4&#39;], [&#39;2&#39;]),
  &#39;28_9_114&#39;: ([&#39;4&#39;], [&#39;4&#39;]),
  &#39;28_9_105&#39;: ([&#39;1&#39;], [&#39;5&#39;]),
  &#39;28_9_111&#39;: ([&#39;1&#39;], [&#39;2&#39;]),
  &#39;28_9_109&#39;: ([&#39;4&#39;], [&#39;3&#39;]),
  &#39;28_9_108&#39;: ([&#39;1&#39;], [&#39;2&#39;]),
  &#39;28_9_106&#39;: ([&#39;4&#39;], [&#39;5&#39;]),
  &#39;28_9_101&#39;: ([&#39;4&#39;], [&#39;5&#39;]),
  &#39;28_9_186&#39;: ([&#39;2&#39;], [&#39;3&#39;])},
 1,
 OrderedDict([(&#39;1036&#39;,
               ((0.9988582547655259,
                 2.7101541759017632e-05,
                 1.1429348691813569e-05,
                 8.768686043927815e-05,
                 3.6979582658519204e-05,
                 9.373979833511457e-06,
                 3.0329450211009742e-05,
                 0.00093884437454053,
                 9.63404332827945e-11),)),
              (&#39;22_1&#39;,
               ((4.2989963980636393e-10,
                 1.015571815650667e-06,
                 4.829976998799529e-08,
                 0.971979975317797,
                 1.1259709621373038e-17,
                 1.5056203038257732e-05,
                 0.02799942315730277,
                 4.263959977599745e-06,
                 1.4546365054026668e-25,
                 1.8369754991003278e-07,
                 1.5331468141280412e-09,
                 3.182970243126734e-08,
                 3.3108365538361685e-34,
                 2.969793793085411e-35),)),
              (&#39;28_9&#39;,
               ((0.27617814911472166,
                 2.566485839438195e-05,
                 0.16826689291090058,
                 0.002147217794892999,
                 0.5533820753210903),))])]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractor</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>      Chr   Start        AF    AF_nfe    AF_afr    AF_amr
2862   19  281113  0.001700  0.000015  0.005500  0.000400
2863   19  281129       NaN       NaN       NaN       NaN
2864   19  281168  0.000300  0.000031  0.000600  0.001200
2865   19  281248  0.001300  0.000700  0.000048  0.000073
2866   19  281267  0.000014  0.000015  0.000024  0.000000
...   ...     ...       ...       ...       ...       ...
3254   19  291232  0.036500  0.000600  0.117600  0.013400
3255   19  291343  0.000044  0.000016  0.000000  0.000000
3256   19  291352  0.000037  0.000065  0.000025  0.000000
3257   19  291365  0.000200  0.000000  0.000800  0.000000
3258   19  291404  0.000048  0.000052  0.000000  0.000200

[397 rows x 6 columns]
0 (397, 6) 19 281043 291405 PLPP2 281113
2 (397, 6) 19 281043 291405 PLPP2 281168
3 (397, 6) 19 281043 291405 PLPP2 281248
4 (397, 6) 19 281043 291405 PLPP2 281267
5 (397, 6) 19 281043 291405 PLPP2 281321
6 (397, 6) 19 281043 291405 PLPP2 281325
7 (397, 6) 19 281043 291405 PLPP2 281360
8 (397, 6) 19 281043 291405 PLPP2 281376
9 (397, 6) 19 281043 291405 PLPP2 281383
11 (397, 6) 19 281043 291405 PLPP2 281405
12 (397, 6) 19 281043 291405 PLPP2 281430
13 (397, 6) 19 281043 291405 PLPP2 281468
14 (397, 6) 19 281043 291405 PLPP2 281508
15 (397, 6) 19 281043 291405 PLPP2 281534
16 (397, 6) 19 281043 291405 PLPP2 281609
17 (397, 6) 19 281043 291405 PLPP2 281622
18 (397, 6) 19 281043 291405 PLPP2 281665
19 (397, 6) 19 281043 291405 PLPP2 281690
20 (397, 6) 19 281043 291405 PLPP2 281720
21 (397, 6) 19 281043 291405 PLPP2 281737
22 (397, 6) 19 281043 291405 PLPP2 281824
23 (397, 6) 19 281043 291405 PLPP2 281838
24 (397, 6) 19 281043 291405 PLPP2 281889
26 (397, 6) 19 281043 291405 PLPP2 281983
27 (397, 6) 19 281043 291405 PLPP2 281986
28 (397, 6) 19 281043 291405 PLPP2 282038
29 (397, 6) 19 281043 291405 PLPP2 282053
30 (397, 6) 19 281043 291405 PLPP2 282093
32 (397, 6) 19 281043 291405 PLPP2 282119
33 (397, 6) 19 281043 291405 PLPP2 282135
34 (397, 6) 19 281043 291405 PLPP2 282151
37 (397, 6) 19 281043 291405 PLPP2 282181
38 (397, 6) 19 281043 291405 PLPP2 282223
39 (397, 6) 19 281043 291405 PLPP2 282224
40 (397, 6) 19 281043 291405 PLPP2 282245
41 (397, 6) 19 281043 291405 PLPP2 282261
42 (397, 6) 19 281043 291405 PLPP2 282266
43 (397, 6) 19 281043 291405 PLPP2 282274
44 (397, 6) 19 281043 291405 PLPP2 282348
45 (397, 6) 19 281043 291405 PLPP2 282391
46 (397, 6) 19 281043 291405 PLPP2 282391
47 (397, 6) 19 281043 291405 PLPP2 282400
49 (397, 6) 19 281043 291405 PLPP2 282404
52 (397, 6) 19 281043 291405 PLPP2 282434
53 (397, 6) 19 281043 291405 PLPP2 282439
54 (397, 6) 19 281043 291405 PLPP2 282439
56 (397, 6) 19 281043 291405 PLPP2 282449
58 (397, 6) 19 281043 291405 PLPP2 282486
59 (397, 6) 19 281043 291405 PLPP2 282486
61 (397, 6) 19 281043 291405 PLPP2 282505
63 (397, 6) 19 281043 291405 PLPP2 282529
65 (397, 6) 19 281043 291405 PLPP2 282534
67 (397, 6) 19 281043 291405 PLPP2 282544
68 (397, 6) 19 281043 291405 PLPP2 282567
69 (397, 6) 19 281043 291405 PLPP2 282582
70 (397, 6) 19 281043 291405 PLPP2 282582
71 (397, 6) 19 281043 291405 PLPP2 282588
72 (397, 6) 19 281043 291405 PLPP2 282614
73 (397, 6) 19 281043 291405 PLPP2 282615
74 (397, 6) 19 281043 291405 PLPP2 282669
75 (397, 6) 19 281043 291405 PLPP2 282714
76 (397, 6) 19 281043 291405 PLPP2 282735
77 (397, 6) 19 281043 291405 PLPP2 282753
78 (397, 6) 19 281043 291405 PLPP2 282795
79 (397, 6) 19 281043 291405 PLPP2 282839
80 (397, 6) 19 281043 291405 PLPP2 282842
81 (397, 6) 19 281043 291405 PLPP2 282844
82 (397, 6) 19 281043 291405 PLPP2 282867
83 (397, 6) 19 281043 291405 PLPP2 282869
84 (397, 6) 19 281043 291405 PLPP2 282875
85 (397, 6) 19 281043 291405 PLPP2 282895
86 (397, 6) 19 281043 291405 PLPP2 283037
87 (397, 6) 19 281043 291405 PLPP2 283085
88 (397, 6) 19 281043 291405 PLPP2 283120
89 (397, 6) 19 281043 291405 PLPP2 283208
90 (397, 6) 19 281043 291405 PLPP2 283302
92 (397, 6) 19 281043 291405 PLPP2 283334
93 (397, 6) 19 281043 291405 PLPP2 283343
94 (397, 6) 19 281043 291405 PLPP2 283409
95 (397, 6) 19 281043 291405 PLPP2 283480
96 (397, 6) 19 281043 291405 PLPP2 283487
97 (397, 6) 19 281043 291405 PLPP2 283518
99 (397, 6) 19 281043 291405 PLPP2 283617
100 (397, 6) 19 281043 291405 PLPP2 283624
101 (397, 6) 19 281043 291405 PLPP2 283684
102 (397, 6) 19 281043 291405 PLPP2 283771
104 (397, 6) 19 281043 291405 PLPP2 283784
105 (397, 6) 19 281043 291405 PLPP2 283788
107 (397, 6) 19 281043 291405 PLPP2 283855
108 (397, 6) 19 281043 291405 PLPP2 283908
109 (397, 6) 19 281043 291405 PLPP2 283917
110 (397, 6) 19 281043 291405 PLPP2 283968
111 (397, 6) 19 281043 291405 PLPP2 284003
112 (397, 6) 19 281043 291405 PLPP2 284045
113 (397, 6) 19 281043 291405 PLPP2 284066
114 (397, 6) 19 281043 291405 PLPP2 284076
115 (397, 6) 19 281043 291405 PLPP2 284089
116 (397, 6) 19 281043 291405 PLPP2 284110
117 (397, 6) 19 281043 291405 PLPP2 284113
118 (397, 6) 19 281043 291405 PLPP2 284122
119 (397, 6) 19 281043 291405 PLPP2 284148
120 (397, 6) 19 281043 291405 PLPP2 284152
121 (397, 6) 19 281043 291405 PLPP2 284171
122 (397, 6) 19 281043 291405 PLPP2 284182
123 (397, 6) 19 281043 291405 PLPP2 284199
124 (397, 6) 19 281043 291405 PLPP2 284308
125 (397, 6) 19 281043 291405 PLPP2 284318
126 (397, 6) 19 281043 291405 PLPP2 284341
127 (397, 6) 19 281043 291405 PLPP2 284350
128 (397, 6) 19 281043 291405 PLPP2 284350
129 (397, 6) 19 281043 291405 PLPP2 284350
130 (397, 6) 19 281043 291405 PLPP2 284350
131 (397, 6) 19 281043 291405 PLPP2 284377
132 (397, 6) 19 281043 291405 PLPP2 284455
133 (397, 6) 19 281043 291405 PLPP2 284476
134 (397, 6) 19 281043 291405 PLPP2 284486
135 (397, 6) 19 281043 291405 PLPP2 284491
136 (397, 6) 19 281043 291405 PLPP2 284510
137 (397, 6) 19 281043 291405 PLPP2 284522
138 (397, 6) 19 281043 291405 PLPP2 284675
141 (397, 6) 19 281043 291405 PLPP2 284848
142 (397, 6) 19 281043 291405 PLPP2 284892
144 (397, 6) 19 281043 291405 PLPP2 284976
145 (397, 6) 19 281043 291405 PLPP2 285009
147 (397, 6) 19 281043 291405 PLPP2 285150
148 (397, 6) 19 281043 291405 PLPP2 285162
149 (397, 6) 19 281043 291405 PLPP2 285175
150 (397, 6) 19 281043 291405 PLPP2 285189
151 (397, 6) 19 281043 291405 PLPP2 285203
152 (397, 6) 19 281043 291405 PLPP2 285231
153 (397, 6) 19 281043 291405 PLPP2 285325
154 (397, 6) 19 281043 291405 PLPP2 285330
155 (397, 6) 19 281043 291405 PLPP2 285355
156 (397, 6) 19 281043 291405 PLPP2 285370
157 (397, 6) 19 281043 291405 PLPP2 285407
158 (397, 6) 19 281043 291405 PLPP2 285427
159 (397, 6) 19 281043 291405 PLPP2 285435
160 (397, 6) 19 281043 291405 PLPP2 285435
161 (397, 6) 19 281043 291405 PLPP2 285441
162 (397, 6) 19 281043 291405 PLPP2 285444
163 (397, 6) 19 281043 291405 PLPP2 285455
164 (397, 6) 19 281043 291405 PLPP2 285489
165 (397, 6) 19 281043 291405 PLPP2 285523
166 (397, 6) 19 281043 291405 PLPP2 285531
167 (397, 6) 19 281043 291405 PLPP2 285539
168 (397, 6) 19 281043 291405 PLPP2 285561
169 (397, 6) 19 281043 291405 PLPP2 285562
170 (397, 6) 19 281043 291405 PLPP2 285584
171 (397, 6) 19 281043 291405 PLPP2 285598
172 (397, 6) 19 281043 291405 PLPP2 285598
173 (397, 6) 19 281043 291405 PLPP2 285598
174 (397, 6) 19 281043 291405 PLPP2 285598
175 (397, 6) 19 281043 291405 PLPP2 285611
176 (397, 6) 19 281043 291405 PLPP2 285613
177 (397, 6) 19 281043 291405 PLPP2 285646
178 (397, 6) 19 281043 291405 PLPP2 285655
179 (397, 6) 19 281043 291405 PLPP2 285655
180 (397, 6) 19 281043 291405 PLPP2 285655
181 (397, 6) 19 281043 291405 PLPP2 285700
182 (397, 6) 19 281043 291405 PLPP2 285756
183 (397, 6) 19 281043 291405 PLPP2 285784
184 (397, 6) 19 281043 291405 PLPP2 285821
185 (397, 6) 19 281043 291405 PLPP2 285828
186 (397, 6) 19 281043 291405 PLPP2 285830
187 (397, 6) 19 281043 291405 PLPP2 285842
188 (397, 6) 19 281043 291405 PLPP2 285878
190 (397, 6) 19 281043 291405 PLPP2 285948
191 (397, 6) 19 281043 291405 PLPP2 286016
192 (397, 6) 19 281043 291405 PLPP2 286059
193 (397, 6) 19 281043 291405 PLPP2 286081
194 (397, 6) 19 281043 291405 PLPP2 286089
195 (397, 6) 19 281043 291405 PLPP2 286112
196 (397, 6) 19 281043 291405 PLPP2 286113
197 (397, 6) 19 281043 291405 PLPP2 286151
198 (397, 6) 19 281043 291405 PLPP2 286151
199 (397, 6) 19 281043 291405 PLPP2 286164
200 (397, 6) 19 281043 291405 PLPP2 286164
201 (397, 6) 19 281043 291405 PLPP2 286164
202 (397, 6) 19 281043 291405 PLPP2 286243
203 (397, 6) 19 281043 291405 PLPP2 286306
204 (397, 6) 19 281043 291405 PLPP2 286309
205 (397, 6) 19 281043 291405 PLPP2 286315
206 (397, 6) 19 281043 291405 PLPP2 286342
207 (397, 6) 19 281043 291405 PLPP2 286349
208 (397, 6) 19 281043 291405 PLPP2 286360
209 (397, 6) 19 281043 291405 PLPP2 286431
210 (397, 6) 19 281043 291405 PLPP2 286431
211 (397, 6) 19 281043 291405 PLPP2 286471
212 (397, 6) 19 281043 291405 PLPP2 286507
213 (397, 6) 19 281043 291405 PLPP2 286574
214 (397, 6) 19 281043 291405 PLPP2 286649
215 (397, 6) 19 281043 291405 PLPP2 286725
216 (397, 6) 19 281043 291405 PLPP2 286791
217 (397, 6) 19 281043 291405 PLPP2 286799
218 (397, 6) 19 281043 291405 PLPP2 286799
219 (397, 6) 19 281043 291405 PLPP2 286799
220 (397, 6) 19 281043 291405 PLPP2 286842
221 (397, 6) 19 281043 291405 PLPP2 286869
222 (397, 6) 19 281043 291405 PLPP2 286907
223 (397, 6) 19 281043 291405 PLPP2 286921
224 (397, 6) 19 281043 291405 PLPP2 286947
225 (397, 6) 19 281043 291405 PLPP2 287072
226 (397, 6) 19 281043 291405 PLPP2 287072
227 (397, 6) 19 281043 291405 PLPP2 287129
228 (397, 6) 19 281043 291405 PLPP2 287225
229 (397, 6) 19 281043 291405 PLPP2 287270
230 (397, 6) 19 281043 291405 PLPP2 287272
231 (397, 6) 19 281043 291405 PLPP2 287322
233 (397, 6) 19 281043 291405 PLPP2 287361
234 (397, 6) 19 281043 291405 PLPP2 287432
235 (397, 6) 19 281043 291405 PLPP2 287482
237 (397, 6) 19 281043 291405 PLPP2 287562
238 (397, 6) 19 281043 291405 PLPP2 287698
239 (397, 6) 19 281043 291405 PLPP2 287698
240 (397, 6) 19 281043 291405 PLPP2 287703
242 (397, 6) 19 281043 291405 PLPP2 287720
243 (397, 6) 19 281043 291405 PLPP2 287749
244 (397, 6) 19 281043 291405 PLPP2 287786
245 (397, 6) 19 281043 291405 PLPP2 287805
246 (397, 6) 19 281043 291405 PLPP2 287814
247 (397, 6) 19 281043 291405 PLPP2 287818
248 (397, 6) 19 281043 291405 PLPP2 287825
249 (397, 6) 19 281043 291405 PLPP2 287906
250 (397, 6) 19 281043 291405 PLPP2 287927
251 (397, 6) 19 281043 291405 PLPP2 287946
252 (397, 6) 19 281043 291405 PLPP2 287970
253 (397, 6) 19 281043 291405 PLPP2 288036
254 (397, 6) 19 281043 291405 PLPP2 288062
257 (397, 6) 19 281043 291405 PLPP2 288086
258 (397, 6) 19 281043 291405 PLPP2 288109
259 (397, 6) 19 281043 291405 PLPP2 288123
261 (397, 6) 19 281043 291405 PLPP2 288164
262 (397, 6) 19 281043 291405 PLPP2 288180
263 (397, 6) 19 281043 291405 PLPP2 288246
264 (397, 6) 19 281043 291405 PLPP2 288320
265 (397, 6) 19 281043 291405 PLPP2 288329
267 (397, 6) 19 281043 291405 PLPP2 288367
268 (397, 6) 19 281043 291405 PLPP2 288374
269 (397, 6) 19 281043 291405 PLPP2 288440
270 (397, 6) 19 281043 291405 PLPP2 288465
271 (397, 6) 19 281043 291405 PLPP2 288466
272 (397, 6) 19 281043 291405 PLPP2 288467
273 (397, 6) 19 281043 291405 PLPP2 288491
275 (397, 6) 19 281043 291405 PLPP2 288578
276 (397, 6) 19 281043 291405 PLPP2 288620
277 (397, 6) 19 281043 291405 PLPP2 288633
279 (397, 6) 19 281043 291405 PLPP2 288677
280 (397, 6) 19 281043 291405 PLPP2 288690
281 (397, 6) 19 281043 291405 PLPP2 288730
282 (397, 6) 19 281043 291405 PLPP2 288738
284 (397, 6) 19 281043 291405 PLPP2 288771
285 (397, 6) 19 281043 291405 PLPP2 288786
286 (397, 6) 19 281043 291405 PLPP2 288799
287 (397, 6) 19 281043 291405 PLPP2 288800
288 (397, 6) 19 281043 291405 PLPP2 288808
289 (397, 6) 19 281043 291405 PLPP2 288833
290 (397, 6) 19 281043 291405 PLPP2 288837
291 (397, 6) 19 281043 291405 PLPP2 288881
292 (397, 6) 19 281043 291405 PLPP2 288885
293 (397, 6) 19 281043 291405 PLPP2 288929
294 (397, 6) 19 281043 291405 PLPP2 288965
295 (397, 6) 19 281043 291405 PLPP2 288970
296 (397, 6) 19 281043 291405 PLPP2 288980
297 (397, 6) 19 281043 291405 PLPP2 289014
298 (397, 6) 19 281043 291405 PLPP2 289040
299 (397, 6) 19 281043 291405 PLPP2 289047
300 (397, 6) 19 281043 291405 PLPP2 289116
302 (397, 6) 19 281043 291405 PLPP2 289190
303 (397, 6) 19 281043 291405 PLPP2 289244
304 (397, 6) 19 281043 291405 PLPP2 289255
305 (397, 6) 19 281043 291405 PLPP2 289282
306 (397, 6) 19 281043 291405 PLPP2 289294
307 (397, 6) 19 281043 291405 PLPP2 289311
308 (397, 6) 19 281043 291405 PLPP2 289342
309 (397, 6) 19 281043 291405 PLPP2 289364
310 (397, 6) 19 281043 291405 PLPP2 289374
311 (397, 6) 19 281043 291405 PLPP2 289396
312 (397, 6) 19 281043 291405 PLPP2 289397
313 (397, 6) 19 281043 291405 PLPP2 289399
314 (397, 6) 19 281043 291405 PLPP2 289457
315 (397, 6) 19 281043 291405 PLPP2 289464
316 (397, 6) 19 281043 291405 PLPP2 289464
317 (397, 6) 19 281043 291405 PLPP2 289464
318 (397, 6) 19 281043 291405 PLPP2 289491
319 (397, 6) 19 281043 291405 PLPP2 289498
320 (397, 6) 19 281043 291405 PLPP2 289516
321 (397, 6) 19 281043 291405 PLPP2 289527
322 (397, 6) 19 281043 291405 PLPP2 289532
323 (397, 6) 19 281043 291405 PLPP2 289547
324 (397, 6) 19 281043 291405 PLPP2 289580
325 (397, 6) 19 281043 291405 PLPP2 289595
326 (397, 6) 19 281043 291405 PLPP2 289656
327 (397, 6) 19 281043 291405 PLPP2 289657
328 (397, 6) 19 281043 291405 PLPP2 289661
329 (397, 6) 19 281043 291405 PLPP2 289681
330 (397, 6) 19 281043 291405 PLPP2 289692
331 (397, 6) 19 281043 291405 PLPP2 289708
332 (397, 6) 19 281043 291405 PLPP2 289708
333 (397, 6) 19 281043 291405 PLPP2 289725
334 (397, 6) 19 281043 291405 PLPP2 289754
335 (397, 6) 19 281043 291405 PLPP2 289763
336 (397, 6) 19 281043 291405 PLPP2 289805
337 (397, 6) 19 281043 291405 PLPP2 289857
338 (397, 6) 19 281043 291405 PLPP2 289877
339 (397, 6) 19 281043 291405 PLPP2 289895
340 (397, 6) 19 281043 291405 PLPP2 289902
341 (397, 6) 19 281043 291405 PLPP2 289918
342 (397, 6) 19 281043 291405 PLPP2 289919
343 (397, 6) 19 281043 291405 PLPP2 289922
344 (397, 6) 19 281043 291405 PLPP2 289923
345 (397, 6) 19 281043 291405 PLPP2 289946
347 (397, 6) 19 281043 291405 PLPP2 289987
348 (397, 6) 19 281043 291405 PLPP2 290013
349 (397, 6) 19 281043 291405 PLPP2 290013
350 (397, 6) 19 281043 291405 PLPP2 290024
351 (397, 6) 19 281043 291405 PLPP2 290050
352 (397, 6) 19 281043 291405 PLPP2 290083
353 (397, 6) 19 281043 291405 PLPP2 290090
354 (397, 6) 19 281043 291405 PLPP2 290095
355 (397, 6) 19 281043 291405 PLPP2 290108
356 (397, 6) 19 281043 291405 PLPP2 290112
357 (397, 6) 19 281043 291405 PLPP2 290157
358 (397, 6) 19 281043 291405 PLPP2 290203
359 (397, 6) 19 281043 291405 PLPP2 290239
360 (397, 6) 19 281043 291405 PLPP2 290305
361 (397, 6) 19 281043 291405 PLPP2 290307
362 (397, 6) 19 281043 291405 PLPP2 290355
363 (397, 6) 19 281043 291405 PLPP2 290380
364 (397, 6) 19 281043 291405 PLPP2 290440
365 (397, 6) 19 281043 291405 PLPP2 290466
366 (397, 6) 19 281043 291405 PLPP2 290470
367 (397, 6) 19 281043 291405 PLPP2 290472
368 (397, 6) 19 281043 291405 PLPP2 290539
369 (397, 6) 19 281043 291405 PLPP2 290614
370 (397, 6) 19 281043 291405 PLPP2 290620
371 (397, 6) 19 281043 291405 PLPP2 290642
372 (397, 6) 19 281043 291405 PLPP2 290676
373 (397, 6) 19 281043 291405 PLPP2 290719
374 (397, 6) 19 281043 291405 PLPP2 290760
375 (397, 6) 19 281043 291405 PLPP2 290766
376 (397, 6) 19 281043 291405 PLPP2 290805
378 (397, 6) 19 281043 291405 PLPP2 290841
379 (397, 6) 19 281043 291405 PLPP2 290841
380 (397, 6) 19 281043 291405 PLPP2 290865
381 (397, 6) 19 281043 291405 PLPP2 290886
382 (397, 6) 19 281043 291405 PLPP2 290898
383 (397, 6) 19 281043 291405 PLPP2 290947
384 (397, 6) 19 281043 291405 PLPP2 290961
385 (397, 6) 19 281043 291405 PLPP2 290979
386 (397, 6) 19 281043 291405 PLPP2 290990
387 (397, 6) 19 281043 291405 PLPP2 291126
388 (397, 6) 19 281043 291405 PLPP2 291181
389 (397, 6) 19 281043 291405 PLPP2 291184
390 (397, 6) 19 281043 291405 PLPP2 291192
391 (397, 6) 19 281043 291405 PLPP2 291197
392 (397, 6) 19 281043 291405 PLPP2 291232
393 (397, 6) 19 281043 291405 PLPP2 291343
394 (397, 6) 19 281043 291405 PLPP2 291352
395 (397, 6) 19 281043 291405 PLPP2 291365
396 (397, 6) 19 281043 291405 PLPP2 291404
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Family 28_9 (12 bits) -  Singlepoint:  53%                    </pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                                                                      </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;1036_3&#39;: [(&#39;6&#39;, &#39;7&#39;)],
 &#39;1036_2&#39;: [(&#39;3&#39;, &#39;0&#39;)],
 &#39;1036_1&#39;: [(&#39;9&#39;, &#39;0&#39;)],
 &#39;1036_5&#39;: [(&#39;8&#39;, &#39;1&#39;)],
 &#39;1036_99&#39;: [(&#39;3&#39;, &#39;9&#39;)],
 &#39;1036_6&#39;: [(&#39;2&#39;, &#39;5&#39;)],
 &#39;1036_4&#39;: [(&#39;3&#39;, &#39;4&#39;)],
 &#39;22_1_20&#39;: [(&#39;9&#39;, &#39;4&#39;)],
 &#39;22_1_10&#39;: [(&#39;11&#39;, &#39;14&#39;)],
 &#39;22_1_99&#39;: [(&#39;7&#39;, &#39;10&#39;)],
 &#39;22_1_5&#39;: [(&#39;2&#39;, &#39;3&#39;)],
 &#39;22_1_4&#39;: [(&#39;8&#39;, &#39;5&#39;)],
 &#39;22_1_2&#39;: [(&#39;1&#39;, &#39;13&#39;)],
 &#39;22_1_3&#39;: [(&#39;6&#39;, &#39;12&#39;)],
 &#39;28_9_100&#39;: [(&#39;1&#39;, &#39;4&#39;)],
 &#39;28_9_103&#39;: [(&#39;1&#39;, &#39;4&#39;)],
 &#39;28_9_110&#39;: [(&#39;4&#39;, &#39;2&#39;)],
 &#39;28_9_114&#39;: [(&#39;4&#39;, &#39;4&#39;)],
 &#39;28_9_105&#39;: [(&#39;1&#39;, &#39;5&#39;)],
 &#39;28_9_111&#39;: [(&#39;1&#39;, &#39;2&#39;)],
 &#39;28_9_109&#39;: [(&#39;4&#39;, &#39;3&#39;)],
 &#39;28_9_108&#39;: [(&#39;1&#39;, &#39;2&#39;)],
 &#39;28_9_106&#39;: [(&#39;4&#39;, &#39;5&#39;)],
 &#39;28_9_101&#39;: [(&#39;4&#39;, &#39;5&#39;)],
 &#39;28_9_186&#39;: [(&#39;2&#39;, &#39;3&#39;)]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">maf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;1036&#39;, ((1.0,),)), (&#39;22_1&#39;, ((1.0,),)), (&#39;28_9&#39;, ((1.0,),))])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">##Per fam per variant</span>
<span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>maker._MarkerMaker__Haplotype(data, haplotypes, mafs, varnames)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">new_trim_ped</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/new_trim_ped.csv&#39;</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">new_trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">index</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">&lt;=</span><span class="mi">24</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>25_7:0       24
10R_R57:0    24
27_131:0     24
285:0        23
10R_R95:0    23
             ..
4_3832:0      4
4_3758:1      4
990:0         4
3761:5        3
216:2         3
Name: fid, Length: 578, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="o">&lt;=</span><span class="mi">24</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;10R_R114:0&#39;</span><span class="p">)</span>
<span class="n">items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;10R_R57:0&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_trim_ped</span><span class="p">[</span><span class="n">new_trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fid</th>
      <th>iid</th>
      <th>fathid</th>
      <th>mothid</th>
      <th>sex</th>
      <th>ad</th>
      <th>vcf</th>
      <th>depth</th>
      <th>trim</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1559</th>
      <td>257:0</td>
      <td>257_1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>-9</td>
      <td>False</td>
      <td>1</td>
      <td>False</td>
      <td>257:0</td>
    </tr>
    <tr>
      <th>1560</th>
      <td>257:0</td>
      <td>257_27</td>
      <td>257_21</td>
      <td>257_5</td>
      <td>1</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
      <td>False</td>
      <td>257:0</td>
    </tr>
    <tr>
      <th>1561</th>
      <td>257:0</td>
      <td>257_41</td>
      <td>257_21</td>
      <td>257_5</td>
      <td>2</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
      <td>False</td>
      <td>257:0</td>
    </tr>
    <tr>
      <th>1562</th>
      <td>257:0</td>
      <td>257_28</td>
      <td>257_21</td>
      <td>257_5</td>
      <td>1</td>
      <td>1</td>
      <td>True</td>
      <td>3</td>
      <td>False</td>
      <td>257:0</td>
    </tr>
    <tr>
      <th>1563</th>
      <td>257:0</td>
      <td>257_22</td>
      <td>257_21</td>
      <td>257_5</td>
      <td>1</td>
      <td>2</td>
      <td>True</td>
      <td>3</td>
      <td>False</td>
      <td>257:0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4519</th>
      <td>694:0</td>
      <td>694_9</td>
      <td>694_1</td>
      <td>694_2</td>
      <td>1</td>
      <td>2</td>
      <td>False</td>
      <td>2</td>
      <td>False</td>
      <td>694:0</td>
    </tr>
    <tr>
      <th>4520</th>
      <td>694:0</td>
      <td>694_1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>-9</td>
      <td>False</td>
      <td>1</td>
      <td>False</td>
      <td>694:0</td>
    </tr>
    <tr>
      <th>4521</th>
      <td>694:0</td>
      <td>694_2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>-9</td>
      <td>False</td>
      <td>1</td>
      <td>False</td>
      <td>694:0</td>
    </tr>
    <tr>
      <th>4522</th>
      <td>694:0</td>
      <td>694_25</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>-9</td>
      <td>False</td>
      <td>1</td>
      <td>False</td>
      <td>694:0</td>
    </tr>
    <tr>
      <th>4523</th>
      <td>694:0</td>
      <td>694_11</td>
      <td>694_1</td>
      <td>694_2</td>
      <td>1</td>
      <td>2</td>
      <td>True</td>
      <td>2</td>
      <td>False</td>
      <td>694:0</td>
    </tr>
  </tbody>
</table>
<p>101 rows Ã— 10 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.2-Debug-of-failing-to-phase-haplotypes(10R_R114:0)">4.2 Debug of failing to phase haplotypes(10R_R114:0)<a class="anchor-link" href="#4.2-Debug-of-failing-to-phase-haplotypes(10R_R114:0)"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="remove-the-children-without-vcf">remove the children without vcf<a class="anchor-link" href="#remove-the-children-without-vcf"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="s1">&#39;10R_R114:0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;10R_R114_10&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="s1">&#39;10R_R114:0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;10R_R114_11&#39;</span><span class="p">)</span>
<span class="c1">#data.tfam.families[&#39;10R_R114:0&#39;].remove(&#39;10R_R114_6&#39;)</span>
<span class="c1">#data.tfam.families[&#39;10R_R114:0&#39;].remove(&#39;10R_R114_8&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families_sorted</span><span class="p">[</span><span class="s1">&#39;10R_R114:0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;10R_R114_10&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families_sorted</span><span class="p">[</span><span class="s1">&#39;10R_R114:0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;10R_R114_11&#39;</span><span class="p">)</span>
<span class="c1">#data.tfam.families_sorted[&#39;10R_R114:0&#39;].remove(&#39;10R_R114_6&#39;)</span>
<span class="c1">#data.tfam.families_sorted[&#39;10R_R114:0&#39;].remove(&#39;10R_R114_8&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;10R_R114:0&#39;</span><span class="p">,</span><span class="s1">&#39;10R_R57:0&#39;</span><span class="p">]:</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;here&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="n">maker</span><span class="o">.</span><span class="n">missings</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>            0            1           2           3  4   5   6   7   8   9   \
0   10R_R114:0   10R_R114_2           0           0  1  00  00  00  00  00   
1   10R_R114:0   10R_R114_3           0           0  2  00  00  00  00  00   
2   10R_R114:0  10R_R114_42  10R_R114_2  10R_R114_3  2  11  11  11  11  11   
3   10R_R114:0  10R_R114_16  10R_R114_2  10R_R114_3  1  12  11  12  11  12   
4   10R_R114:0   10R_R114_1  10R_R114_2  10R_R114_3  2  12  11  11  12  12   
5   10R_R114:0   10R_R114_4  10R_R114_2  10R_R114_3  2  11  11  12  12  11   
6   10R_R114:0   10R_R114_9  10R_R114_2  10R_R114_3  2  11  12  12  11  12   
7   10R_R114:0  10R_R114_12  10R_R114_2  10R_R114_3  2  12  11  12  11  12   
8   10R_R114:0  10R_R114_14  10R_R114_2  10R_R114_3  2  11  11  12  11  11   
9   10R_R114:0  10R_R114_18  10R_R114_2  10R_R114_3  2  11  11  12  11  12   
10  10R_R114:0  10R_R114_15  10R_R114_2  10R_R114_3  1  11  11  12  11  12   
11  10R_R114:0   10R_R114_5  10R_R114_2  10R_R114_3  2  11  11  12  11  12   
12  10R_R114:0  10R_R114_20  10R_R114_2  10R_R114_3  2  11  11  12  11  12   
13  10R_R114:0   10R_R114_6  10R_R114_2  10R_R114_3  2  00  00  00  00  00   
14  10R_R114:0   10R_R114_8  10R_R114_2  10R_R114_3  2  00  00  00  00  00   

    ...  36  37  38  39  40  41  42  43  44  45  
0   ...  00  00  00  00  00  00  00  00  00  00  
1   ...  00  00  00  00  00  00  00  00  00  00  
2   ...  11  11  11  11  11  11  12  11  12  00  
3   ...  12  12  11  12  11  12  11  12  12  00  
4   ...  11  11  12  11  11  12  11  12  12  11  
5   ...  11  11  11  11  12  12  11  12  12  00  
6   ...  11  11  11  11  11  11  11  11  11  11  
7   ...  00  00  00  11  11  00  11  11  12  00  
8   ...  11  11  11  11  11  11  12  11  11  00  
9   ...  12  12  11  11  11  12  11  12  11  11  
10  ...  12  12  11  11  11  12  12  12  11  12  
11  ...  11  11  11  11  11  11  11  11  12  00  
12  ...  12  12  11  11  11  12  11  12  11  00  
13  ...  00  00  00  00  00  00  00  00  00  00  
14  ...  00  00  00  00  00  00  00  00  00  00  

[15 rows x 46 columns]
           0           1           2           3  4   5   6   7   8   9   ...  \
0   10R_R57:0   10R_R57_3           0           0  2  00  00  00  00  00  ...   
1   10R_R57:0  10R_R57_41           0           0  2  00  00  00  00  00  ...   
2   10R_R57:0   10R_R57_4           0           0  1  00  00  00  00  00  ...   
3   10R_R57:0  10R_R57_10   10R_R57_4   10R_R57_3  1  11  11  11  12  12  ...   
4   10R_R57:0  10R_R57_14   10R_R57_4   10R_R57_3  1  00  00  00  00  00  ...   
5   10R_R57:0  10R_R57_43  10R_R57_14  10R_R57_41  2  11  11  11  11  11  ...   
6   10R_R57:0  10R_R57_15   10R_R57_4   10R_R57_3  2  11  11  11  11  11  ...   
7   10R_R57:0  10R_R57_19   10R_R57_4   10R_R57_3  1  11  11  11  11  11  ...   
8   10R_R57:0  10R_R57_13   10R_R57_4   10R_R57_3  2  00  00  00  00  00  ...   
9   10R_R57:0   10R_R57_6   10R_R57_4   10R_R57_3  2  00  00  00  00  00  ...   
10  10R_R57:0   10R_R57_7   10R_R57_4   10R_R57_3  2  00  00  00  00  00  ...   
11  10R_R57:0  10R_R57_16   10R_R57_4   10R_R57_3  1  12  11  11  12  12  ...   
12  10R_R57:0   10R_R57_1   10R_R57_4   10R_R57_3  2  11  11  11  11  11  ...   
13  10R_R57:0  10R_R57_12   10R_R57_4   10R_R57_3  2  11  11  11  12  12  ...   
14  10R_R57:0  10R_R57_38           0           0  1  00  00  00  00  00  ...   
15  10R_R57:0  10R_R57_40  10R_R57_38   10R_R57_6  2  11  11  11  12  11  ...   
16  10R_R57:0  10R_R57_36           0           0  1  00  00  00  00  00  ...   
17  10R_R57:0  10R_R57_37  10R_R57_36  10R_R57_13  1  11  12  11  11  11  ...   
18  10R_R57:0  10R_R57_24           0           0  2  00  00  00  00  00  ...   
19  10R_R57:0  10R_R57_25  10R_R57_10  10R_R57_24  1  11  12  11  11  11  ...   
20  10R_R57:0  10R_R57_28  10R_R57_10  10R_R57_24  2  11  11  11  12  11  ...   
21  10R_R57:0  10R_R57_29  10R_R57_10  10R_R57_24  2  11  12  12  11  11  ...   
22  10R_R57:0  10R_R57_30           0           0  1  00  00  00  00  00  ...   
23  10R_R57:0  10R_R57_32  10R_R57_30   10R_R57_7  2  11  11  11  12  11  ...   

    40  41  42  43  44  45  46  47  48  49  
0   00  00  00  00  00  00  00  00  00  00  
1   00  00  00  00  00  00  00  00  00  00  
2   00  00  00  00  00  00  00  00  00  00  
3   11  11  11  11  11  11  12  12  12  11  
4   00  00  00  00  00  00  00  00  00  00  
5   11  12  12  11  11  11  12  12  11  11  
6   11  11  11  11  11  11  12  12  12  12  
7   11  12  11  11  11  11  11  12  11  11  
8   00  00  00  00  00  00  00  00  00  00  
9   00  00  00  00  00  00  00  00  00  00  
10  00  00  00  00  00  00  00  00  00  00  
11  11  11  11  11  11  12  12  22  12  11  
12  11  11  11  11  11  12  11  11  11  11  
13  11  11  11  12  12  12  12  12  12  11  
14  00  00  00  00  00  00  00  00  00  00  
15  12  12  12  11  11  12  12  12  12  11  
16  00  00  00  00  00  00  00  00  00  00  
17  12  12  12  11  12  11  12  12  12  11  
18  00  00  00  00  00  00  00  00  00  00  
19  11  11  11  11  11  12  11  12  12  11  
20  11  11  11  11  11  12  11  11  11  12  
21  12  12  12  11  11  11  12  12  12  11  
22  00  00  00  00  00  00  00  00  00  00  
23  11  11  11  12  11  11  11  11  11  11  

[24 rows x 50 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.3-write-out-the-input-of-haplotyper">4.3 write out the input of haplotyper<a class="anchor-link" href="#4.3-write-out-the-input-of-haplotyper"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="4.3.1-10R_R114:0-family">4.3.1 10R_R114:0 family<a class="anchor-link" href="#4.3.1-10R_R114:0-family"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="s1">&#39;10R_R114:0&#39;</span>
<span class="c1">#for item in data.families:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;running family&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
<span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="n">maker</span><span class="o">.</span><span class="n">rsq</span><span class="p">]</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/test_haplotyper_10R_R114:0_removed2.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running family 10R_R114:0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="4.3.2-all-families">4.3.2 all families<a class="anchor-link" href="#4.3.2-all-families"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span><span class="p">,</span><span class="n">positions</span><span class="p">,</span><span class="n">vcf_mafs</span><span class="p">,</span><span class="n">geno</span> <span class="o">=</span> <span class="p">{},{},{},{}</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
    <span class="n">geno</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="n">varnames</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span><span class="p">,</span><span class="n">geno</span><span class="p">]</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../data/test_haplotyper_all_families.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>587</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="s1">&#39;10R_R114:0&#39;</span>
<span class="c1">#for item in data.families:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;running family&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
<span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;here&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="n">maker</span><span class="o">.</span><span class="n">missings</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
    <span class="n">tmp_log_output</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
    <span class="n">maker</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="n">maker</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">tmp_log_output</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;530:0&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;10J_109:0&#39;, &#39;10J_109_5&#39;, &#39;0&#39;, &#39;0&#39;, &#39;2&#39;, &#39;00&#39;, &#39;00&#39;],
 [&#39;10J_109:0&#39;, &#39;10J_109_6&#39;, &#39;0&#39;, &#39;0&#39;, &#39;1&#39;, &#39;00&#39;, &#39;00&#39;],
 [&#39;10J_109:0&#39;, &#39;10J_109_1&#39;, &#39;10J_109_6&#39;, &#39;10J_109_5&#39;, &#39;1&#39;, &#39;22&#39;, &#39;12&#39;],
 [&#39;10J_109:0&#39;, &#39;10J_109_4&#39;, &#39;10J_109_6&#39;, &#39;10J_109_5&#39;, &#39;1&#39;, &#39;11&#39;, &#39;11&#39;],
 [&#39;10J_109:0&#39;, &#39;10J_109_3&#39;, &#39;10J_109_6&#39;, &#39;10J_109_5&#39;, &#39;1&#39;, &#39;00&#39;, &#39;00&#39;],
 [&#39;10J_109:0&#39;, &#39;10J_109_2&#39;, &#39;10J_109_6&#39;, &#39;10J_109_5&#39;, &#39;1&#39;, &#39;00&#39;, &#39;00&#39;],
 [&#39;10J_109:0&#39;, &#39;10J_109_7&#39;, &#39;10J_109_6&#39;, &#39;10J_109_5&#39;, &#39;1&#39;, &#39;11&#39;, &#39;11&#39;]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">vcf_mafs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
            <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span> <span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">]):</span>
        <span class="c1"># all families have only one variant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__AssignSNVHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># calculate LD clusters using founder haplotypes</span>
        <span class="c1">#clusters = self.__ClusterByLD(data, haplotypes, varnames)</span>
        <span class="n">clusters</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#print(&#39;clusters:&#39;,clusters)</span>
        <span class="c1"># recoding the genotype of the region</span>
        <span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;coder&#39;</span><span class="p">][</span><span class="s1">&#39;input&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">clusters</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__CodeHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">dtest</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;coder&#39;</span><span class="p">][</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetHaplotypes</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">,</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">)]</span>
<span class="c1">#except Exception as e:</span>
<span class="c1">#    return -1</span>
<span class="bp">self</span><span class="o">.</span><span class="n">__FormatHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
        <span class="k">continue</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># haplotyping</span>
    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">prephased</span><span class="p">:</span>
            <span class="c1">#with stdoutRedirect(to = env.tmp_log + str(os.getpid()) + &#39;.log&#39;):</span>
            <span class="c1">#    haplotypes[item] = self.haplotyper.Execute(data.chrom, varnames[item],</span>
            <span class="c1">#                                           sorted(positions), data.getFamSamples(item))[0]</span>
            <span class="n">tmp_log_output</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
            <span class="c1">#with stdoutRedirect(to = tmp_log_output + &#39;.log&#39;):</span>
            <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span>
                                                           <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">tmp_log_output</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PedToHaplotype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># C++ haplotyping implementation failed</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
            <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># either use privided MAF or computer MAF</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">vcf_mafs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># count founder alleles</span>
        <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">idxv</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                    <span class="c1"># [#alt, #haplotypes]</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">gt</span> <span class="o">=</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">gt</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span><span class="p">:</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gtconv</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
<span class="c1">#</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__Haplotype</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test3">Test3<a class="anchor-link" href="#Test3"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> tri-allelic loci were ignored&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> variants ignored due to having MAF &gt; </span><span class="si">{}</span><span class="s1"> and other specified constraints&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units ignored due to absence in VCF file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units ignored due to absence of variation in samples&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 1 units ignored due to absence in VCF file</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fatal_errors</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Error msg from C++ extension</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cat </span><span class="si">{}</span><span class="s2">/*.* &gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="p">))</span>
    <span class="n">fatal_errors</span> <span class="o">=</span> <span class="n">wordCount</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="p">)[</span><span class="s1">&#39;fatal&#39;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:,d}</span><span class="s2"> regional markers failed to be generated due to haplotyping failures!&quot;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="k">if</span> <span class="n">fatal_errors</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:,d}</span><span class="s2"> or more regional markers failed to be generated due to runtime errors!&quot;</span><span class="o">.</span>\
              <span class="nb">format</span><span class="p">(</span><span class="n">fatal_errors</span><span class="p">))</span>
<span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Archiving regional marker data to directory [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
<span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;CACHE&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">jobs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>cat: &#39;./seqlinkage-example/tmprst/SEQLinkage_tmp_wk92qcpq/*.*&#39;: No such file or directory
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Archiving regional marker data to directory [./seqlinkage-example/cache]</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./seqlinkage-example/tmprst/SEQLinkage_tmp_wk92qcpq/CACHE&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;tsq20211129.chr1.freq&#39;, &#39;tsq20211129.chr1.tped&#39;, &#39;tsq20211129.tfam&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">jobs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>16</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/2206534.1.plot.q/ipykernel_985/4167063990.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>env<span class="ansi-blue-fg">.</span>tmp_cache

<span class="ansi-red-fg">NameError</span>: name &#39;env&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tpeds</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.tped&#39;</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">:</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading </span><span class="si">{}</span><span class="s1"> data from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units will be converted to </span><span class="si">{}</span><span class="s1"> format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">format_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">format</span><span class="p">(</span><span class="n">tpeds</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.tfam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)),</span>
               <span class="n">args</span><span class="o">.</span><span class="n">prevalence</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">wild_pen</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">muta_pen</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span>
               <span class="n">args</span><span class="o">.</span><span class="n">inherit_mode</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units successfully converted to </span><span class="si">{}</span><span class="s1"> format</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">format_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">skipped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="c1"># FIXME: perhaps we need to rephrase this message?</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> region - family pairs skipped&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">skipped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Archiving </span><span class="si">{}</span><span class="s1"> format to directory [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                    <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">mkpath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 2 units will be converted to MERLIN format</span>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>16
16
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 1 units successfully converted to MERLIN format</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Archiving MERLIN format to directory [./seqlinkage-example/cache]</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 2 units will be converted to LINKAGE format</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 1 units successfully converted to LINKAGE format</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Archiving LINKAGE format to directory [./seqlinkage-example/cache]</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Testing-run_linkage">2. Testing run_linkage<a class="anchor-link" href="#2.-Testing-run_linkage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">output</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;LINKAGE&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">?</span>cache.load
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Signature:</span> cache<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span>target_dir<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> names<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span> &lt;no docstring&gt;
<span class="ansi-red-fg">File:</span>      /mnt/mfs/statgen/yin/Github/linkage/SEQpy3/SEQLinkage/Utils.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">cache_name</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/cache/LINKAGE.cache&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fmt</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;data/genemap.hg38.txt&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.05</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">theta_max</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">output_limit</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span><span class="p">:</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading linkage analysis result from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;heatmap&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Running linkage analysis ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">run_linkage</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Linkage analysis succesfully performed for </span><span class="si">{:,d}</span><span class="s1"> units</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;makeped&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;pedcheck&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;unknown&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;mlink&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">html</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Saving data to [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Running linkage analysis ...</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Linkage analysis succesfully performed for 1 units</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 2 &#34;pedcheck&#34; runtime errors occurred</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Report for [tsq20211129] is generated in HTML format</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Saving data to [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Saving data to [/mnt/mfs/statgen/yin/Github/linkage/SEQpy2/testseqlink]</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing-main">Testing main<a class="anchor-link" href="#Testing-main"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">no_save</span><span class="p">:</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">NoCache</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">Cache</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
<span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;vcf&#39;</span><span class="p">)</span>
<span class="c1"># STEP 1: write encoded data to TPED format</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading regional marker data from archive ...&#39;</span><span class="p">)</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CACHE&#39;</span><span class="p">])</span>
    <span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">fileLinesCount</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/*.tped&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">))))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">batch</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># load VCF file header</span>
    <span class="n">checkVCFBundle</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">)</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vs</span> <span class="o">=</span> <span class="n">cstatgen</span><span class="o">.</span><span class="n">VCFstream</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">samples_vcf</span> <span class="o">=</span> <span class="n">vs</span><span class="o">.</span><span class="n">GetSampleNames</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Fail to extract samples from [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">),</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> samples found in [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">),</span> <span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">))</span>
    <span class="n">samples_not_vcf</span> <span class="o">=</span> <span class="n">checkSamples</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">,</span> <span class="n">getColumn</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">tfam</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># load sample info</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">RData</span><span class="p">(</span><span class="n">samples_vcf</span><span class="p">,</span> <span class="n">TFAMParser</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">tfam</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No valid family to process. &#39;</span> \
                  <span class="s1">&#39;Families have to be at least trio with at least one member in VCF file.&#39;</span><span class="p">,</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No valid sample to process. &#39;</span> \
                  <span class="s1">&#39;Samples have to be in families, and present in both TFAM and VCF files.&#39;</span><span class="p">,</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">rewriteFamfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.tfam&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)),</span>
                   <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="n">samples_not_vcf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">single_markers</span><span class="p">:</span>
        <span class="n">regions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vs</span><span class="o">.</span><span class="n">GetGenomeCoordinates</span><span class="p">()]</span>
        <span class="n">args</span><span class="o">.</span><span class="n">blueprint</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># load blueprint</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading marker map from [</span><span class="si">{}</span><span class="s1">] ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot load regional marker blueprint [</span><span class="si">{}</span><span class="s2">]. &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">),</span> <span class="n">exit</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> families with a total of </span><span class="si">{:,d}</span><span class="s1"> samples will be scanned for </span><span class="si">{:,d}</span><span class="s1"> pre-defined units&#39;</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">jobs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">regions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">faulthandler</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="s1">&#39;.SEGV&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">EncoderWorker</span><span class="p">(</span>
            <span class="n">queue</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">),</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">RegionExtractor</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">,</span> <span class="n">chr_prefix</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">chr_prefix</span><span class="p">,</span> <span class="n">allele_freq_info</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">freq</span><span class="p">),</span>
            <span class="n">MarkerMaker</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">bin</span><span class="p">,</span> <span class="n">maf_cutoff</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">),</span>
            <span class="n">LinkageWriter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples_not_vcf</span><span class="p">))</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
            <span class="n">j</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
            <span class="n">j</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">faulthandler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="c1"># FIXME: need to properly close all jobs</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Use &#39;killall </span><span class="si">{}</span><span class="s2">&#39; to properly terminate all processes!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">prog</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units (from </span><span class="si">{:,d}</span><span class="s1"> variants) processed; &#39;</span>\
            <span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> Mendelian inconsistencies and </span><span class="si">{:,d}</span><span class="s1"> recombination events handled</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                   <span class="n">env</span><span class="o">.</span><span class="n">variants_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                   <span class="n">env</span><span class="o">.</span><span class="n">mendelerror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                   <span class="n">env</span><span class="o">.</span><span class="n">recomb_counter</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> tri-allelic loci were ignored&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> variants ignored due to having MAF &gt; </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units ignored due to absence in VCF file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units ignored due to absence of variation in samples&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">fatal_errors</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Error msg from C++ extension</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cat </span><span class="si">{}</span><span class="s2">/*.* &gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="p">))</span>
            <span class="n">fatal_errors</span> <span class="o">=</span> <span class="n">wordCount</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="p">)[</span><span class="s1">&#39;fatal&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:,d}</span><span class="s2"> regional markers failed to be generated due to haplotyping failures!&quot;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fatal_errors</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:,d}</span><span class="s2"> or more regional markers failed to be generated due to runtime errors!&quot;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">fatal_errors</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Archiving regional marker data to directory [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;CACHE&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">jobs</span>
<span class="c1"># STEP 2: write to PLINK or mega2 format</span>
<span class="n">tpeds</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.tped&#39;</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading </span><span class="si">{}</span><span class="s1"> data from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units will be converted to </span><span class="si">{}</span><span class="s1"> format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">format_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">format</span><span class="p">(</span><span class="n">tpeds</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.tfam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)),</span>
               <span class="n">args</span><span class="o">.</span><span class="n">prevalence</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">wild_pen</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">muta_pen</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span>
               <span class="n">args</span><span class="o">.</span><span class="n">inherit_mode</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units successfully converted to </span><span class="si">{}</span><span class="s1"> format</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">format_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">skipped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="c1"># FIXME: perhaps we need to rephrase this message?</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> region - family pairs skipped&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">skipped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Archiving </span><span class="si">{}</span><span class="s1"> format to directory [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                    <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">mkpath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">)</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span><span class="p">:</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading linkage analysis result from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;heatmap&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Running linkage analysis ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">run_linkage</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Linkage analysis succesfully performed for </span><span class="si">{:,d}</span><span class="s1"> units</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;makeped&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;pedcheck&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;unknown&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;mlink&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">html</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Saving data to [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3,479 samples found in [/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/data/first1000snp_full_samples.vcf.gz]</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 7 samples found in FAM file but not in VCF file:
28_9_101, 28_9_100, 28_9_186, 1036_2, 22_1_20, 1036_1, 22_1_10</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3,461 samples in VCF file will be ignored due to absence in FAM file</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Loading marker map from [data/genemap.hg38.txt] ...</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 families with a total of 18 samples will be scanned for 28,325 pre-defined units</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 0 units processed {5.65%} ...</span>                                       </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>in Haplotype</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 0 units processed {19.76%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Estimating allele frequencies... [using maximum likelihood]0
   V8-13273 V12-13302 V17-13417 V22-13687 

V8-13273: 0 0.707106 0.292894 
total familyCount:1
V12-13302: 0 0.75 0.25 
total familyCount:1
V17-13417: 0 0.75 0.25 
total familyCount:1
V22-13687: 0 0.75 0.25 
total familyCount:1
in Haplotype</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 0 units processed {14.12%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>in Haplotype</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 0 units processed {11.29%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>


running familyrunning family running family1036  
10361036
running familyrunning familyrunning family
 22_1 
22_1 running family
 running family22_1Estimating allele frequencies... [using maximum likelihood]0
   V8-13273 V12-13302 V17-13417 V22-13687 

V8-13273: 0 0.707106 0.292894 
total familyCount:1
V12-13302: 0 0.75 0.25 
total familyCount:1
V17-13417: 0 0.75 0.25 
total familyCount:1
V22-13687: 0 0.75 0.25 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V4-17385 V8-17407 

V4-17385: 0 1 
total familyCount:1
V8-17407: 0 0.5 0.5 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V8-13273 V15-13380 V17-13417 

V8-13273: 0 0.744757 0.255243 
total familyCount:1
V15-13380: 0 0.744757 0.255243 
total familyCount:1
V17-13417: 0 0.744757 0.255243 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V4-17385 V5-17398 V8-17407 

V4-17385: 0 0.739454 0.260546 
total familyCount:1
V5-17398: 0 0.744757 0.255243 
total familyCount:1
V8-17407: 0 0.744757 0.255243 
total familyCount:1

28_9running family
 28_9 28_9

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 units processed {36.70%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Estimating allele frequencies... [using maximum likelihood]0
   V8-13273 V15-13380 V17-13417 

V8-13273: 0 0.744757 0.255243 
total familyCount:1
V15-13380: 0 0.744757 0.255243 
total familyCount:1
V17-13417: 0 0.744757 0.255243 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V3-17379 V4-17385 V9-17408 

V3-17379: 0 0.824706 0.175294 
total familyCount:1
V4-17385: 0 0.5 0.5 
total familyCount:1
V9-17408: 0 0.824706 0.175294 
total familyCount:1
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 units processed {73.39%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>in Haplotype
running family 1036
running family 22_1</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 units processed {79.04%} ...</span></pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
running family </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 units processed {81.86%} ...</span></pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>28_9</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 3 units processed {81.86%} ...</span></pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 4 units processed {93.15%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Estimating allele frequencies... [using maximum likelihood]0
   V3-14464 V8-14653 V18-14907 V19-14930 V20-14933 V40-16103 V50-16378 
   V55-16487 V69-17147 V79-17358 V85-17385 V89-17407 V124-17697 V151-17928 
   V152-17929 V159-20184 V160-20191 V162-20212 V165-20227 V169-20235 
   V171-20250 V178-20316 V180-20485 V182-20522 V184-20547 V194-29368 

V3-14464: 0 0.75 0.25 
total familyCount:1
V8-14653: 0 0.75 0.25 
total familyCount:1
V18-14907: 0 0.5 0.5 
total familyCount:1
V19-14930: 0 0.5 0.5 
total familyCount:1
V20-14933: 0 1 
total familyCount:1
V40-16103: 0 0.707106 0.292894 
total familyCount:1
V50-16378: 0 0.5 0.5 
total familyCount:1
V55-16487: 0 0.75 0.25 
total familyCount:1
V69-17147: 0 0.5 0.5 
total familyCount:1
V79-17358: 0 1 
total familyCount:1
V85-17385: 0 1 
total familyCount:1
V89-17407: 0 0.5 0.5 
total familyCount:1
V124-17697: 0 0.5 0.5 
total familyCount:1
V151-17928: 0 0.5 0.5 
total familyCount:1
V152-17929: 0 0.5 0.5 
total familyCount:1
V159-20184: 0 0.5 0.5 
total familyCount:1
V160-20191: 0 1 
total familyCount:1
V162-20212: 0 1 
total familyCount:1
V165-20227: 0 1 
total familyCount:1
V169-20235: 0 1 
total familyCount:1
V171-20250: 0 1 
total familyCount:1
V178-20316: 0 1 
total familyCount:1
V180-20485: 0 1 
total familyCount:1
V182-20522: 0 1 
total familyCount:1
V184-20547: 0 0.75 0.25 
total familyCount:1
V194-29368: 0 1 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V3-14464 V8-14653 V10-14677 V18-14907 V19-14930 V40-16103 V50-16378 
   V55-16487 V69-17147 V80-17365 V85-17385 V86-17398 V89-17407 V95-17479 
   V108-17559 V112-17589 V124-17697 V129-17722 V131-17746 V142-17829 
   V155-19190 V159-20184 V160-20191 V162-20212 V165-20227 V169-20235 
   V171-20250 V178-20316 V184-20547 

V3-14464: 0 0.739454 0.260546 
total familyCount:1
V8-14653: 0 0.707103 0.292897 
total familyCount:1
V10-14677: 0 0.739454 0.260546 
total familyCount:1
V18-14907: 0 0.707103 0.292897 
total familyCount:1
V19-14930: 0 0.728713 0.271287 
total familyCount:1
V40-16103: 0 0.5 0.5 
total familyCount:1
V50-16378: 0 0.5 0.5 
total familyCount:1
V55-16487: 0 0.744757 0.255243 
total familyCount:1
V69-17147: 0 0.744757 0.255243 
total familyCount:1
V80-17365: 0 0.744757 0.255243 
total familyCount:1
V85-17385: 0 0.739454 0.260546 
total familyCount:1
V86-17398: 0 0.744757 0.255243 
total familyCount:1
V89-17407: 0 0.744757 0.255243 
total familyCount:1
V95-17479: 0 0.744757 0.255243 
total familyCount:1
V108-17559: 0 0.744757 0.255243 
total familyCount:1
V112-17589: 0 0.744757 0.255243 
total familyCount:1
V124-17697: 0 0.739454 0.260546 
total familyCount:1
V129-17722: 0 0.744757 0.255243 
total familyCount:1
V131-17746: 0 0.739454 0.260546 
total familyCount:1
V142-17829: 0 0.744757 0.255243 
total familyCount:1
V155-19190: 0 0.739454 0.260546 
total familyCount:1
V159-20184: 0 0.744757 0.255243 
total familyCount:1
V160-20191: 0 0.744757 0.255243 
total familyCount:1
V162-20212: 0 0.744757 0.255243 
total familyCount:1
V165-20227: 0 0.744757 0.255243 
total familyCount:1
V169-20235: 0 0.744757 0.255243 
total familyCount:1
V171-20250: 0 0.739454 0.260546 
total familyCount:1
V178-20316: 0 0.739454 0.260546 
total familyCount:1
V184-20547: 0 0.739454 0.260546 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V3-14464 V5-14470 V8-14653 V10-14677 V18-14907 V19-14930 V34-16068 
   V40-16103 V50-16378 V84-17379 V85-17385 V90-17408 V105-17519 V107-17556 
   V116-17614 V155-19190 V158-20166 V160-20191 V162-20212 V165-20227 
   V166-20227 V168-20231 V169-20235 V171-20250 V174-20254 V178-20316 
   V183-20545 V184-20547 V194-29368 

V3-14464: 0 0.646634 0.353366 
total familyCount:1
V5-14470: 0 0.824706 0.175294 
total familyCount:1
V8-14653: 0 0.452863 0.547137 
total familyCount:1
V10-14677: 0 0.656432 0.343568 
total familyCount:1
V18-14907: 0 0.5 0.5 
total familyCount:1
V19-14930: 0 0.628665 0.371335 
total familyCount:1
V34-16068: 0 0.5 0.5 
total familyCount:1
V40-16103: 0 0.628667 0.371333 
total familyCount:1
V50-16378: 0 0.617751 0.382249 
total familyCount:1
V84-17379: 0 0.824706 0.175294 
total familyCount:1
V85-17385: 0 0.5 0.5 
total familyCount:1
V90-17408: 0 0.824706 0.175294 
total familyCount:1
V105-17519: 0 0.824706 0.175294 
total familyCount:1
V107-17556: 0 0.820231 0.179769 
total familyCount:1
V116-17614: 0 0.824706 0.175294 
total familyCount:1
V155-19190: 0 0.6 0.4 
total familyCount:1
V158-20166: 0 0.628665 0.371335 
total familyCount:1
V160-20191: 0 0.628665 0.371335 
total familyCount:1
V162-20212: 0 0.628665 0.371335 
total familyCount:1
V165-20227: 0 0.656432 0.343568 
total familyCount:1
V166-20227: 0 0.646634 0.353366 
total familyCount:1
V168-20231: 0 0.811255 0.188745 
total familyCount:1
V169-20235: 0 0.824706 0.175294 
total familyCount:1
V171-20250: 0 0.628665 0.371335 
total familyCount:1
V174-20254: 0 0.824706 0.175294 
total familyCount:1
V178-20316: 0 0.628665 0.371335 
total familyCount:1
V183-20545: 0 0.820231 0.179769 
total familyCount:1
V184-20547: 0 0.617751 0.382249 
total familyCount:1
V194-29368: 0 0.656432 0.343568 
total familyCount:1
                                                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 4 units processed {99.94%} ...</span>                                      </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Estimating allele frequencies... [using maximum likelihood]0
   V8-13273 V12-13302 V17-13417 V22-13687 

V8-13273: 0 0.707106 0.292894 
total familyCount:1
V12-13302: 0 0.75 0.25 
total familyCount:1
V17-13417: 0 0.75 0.25 
total familyCount:1
V22-13687: 0 0.75 0.25 
total familyCount:1
Estimating allele frequencies... [using maximum likelihood]0
   V8-13273 V15-13380 V17-13417 

V8-13273: 0 0.744757 0.255243 
total familyCount:1
V15-13380: 0 0.744757 0.255243 
total familyCount:1
V17-13417: 0 0.744757 0.255243 
total familyCount:1
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 4 units (from 256 variants) processed; 24 Mendelian inconsistencies and 116 recombination events handled</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 28,321 units ignored due to absence in VCF file</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Archiving regional marker data to directory [/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/cache]</span>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>merlin
16
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 4 units will be converted to MERLIN format</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 4 units successfully converted to MERLIN format</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Archiving MERLIN format to directory [/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/cache]</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Saving data to [/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/LINKAGE]</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;69090&#39;</span><span class="p">,</span> <span class="s1">&#39;70008&#39;</span><span class="p">,</span> <span class="s1">&#39;OR4F5&#39;</span><span class="p">,</span> <span class="s1">&#39;4.866641545668504e-06&#39;</span><span class="p">,</span> <span class="s1">&#39;6.181823219621424e-06&#39;</span><span class="p">,</span> <span class="s1">&#39;3.6135725636621673e-06&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractor</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="n">maker</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">##Per fam per variant</span>
<span class="n">uniq_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">exclude_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">recombPos</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">extractor</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__Haplotype</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">,</span><span class="n">exclude_vars</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span><span class="p">[</span><span class="s1">&#39;668&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__ClusterByLD</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__CodeHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clusters</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">clusters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
<span class="n">maker</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">haplotypes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="p">[[</span><span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">],</span> <span class="n">clusters_idx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Print</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">ld</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[[</span><span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span><span class="p">[</span><span class="s1">&#39;668&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-clusterbyld">Test clusterbyld<a class="anchor-link" href="#Test-clusterbyld"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">freq</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">variants</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__Haplotype</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span> <span class="o">=</span><span class="s1">&#39;1036&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recombPos</span><span class="o">=</span><span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
<span class="n">recombPos</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">var_for_haplotype</span><span class="o">=</span><span class="p">[]</span>
<span class="n">positions_for_haplotype</span><span class="o">=</span><span class="p">[]</span>
<span class="n">output_sample</span><span class="o">=</span><span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">gnomAD_estimate</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">freq</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">positions</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var_for_haplotype</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
<span class="n">positions_for_haplotype</span><span class="o">=</span><span class="n">positions</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">famid</span> <span class="o">=</span><span class="n">item</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">S_no_parents</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">famid</span><span class="p">])</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">famid</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">S_no_parents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">famid</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">graph</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">while</span><span class="p">(</span><span class="n">S_no_parents</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">S_no_parents</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">sorted_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">offsprings</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">offsprings</span><span class="p">:</span>
        <span class="n">father</span><span class="p">,</span> <span class="n">mother</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">get_parents</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">father</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span> <span class="ow">and</span> <span class="n">mother</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>
            <span class="n">S_no_parents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="k">if</span> <span class="n">graph</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;There is a loop in the pedigree: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">sorted_names</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">tfam</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">sort_family</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
    <span class="n">output_sample</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
    <span class="n">last_ele</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">output_sample</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">person</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">var_for_haplotype</span><span class="p">:</span>
            <span class="n">idx</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">marker</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;00&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_for_haplotype</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">sort_family</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">output_sample</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp_log_output</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
<span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">maker</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">var_for_haplotype</span><span class="p">,</span> <span class="n">positions_for_haplotype</span><span class="p">,</span> <span class="n">output_sample</span><span class="p">,</span> <span class="n">maker</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">tmp_log_output</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var_for_haplotype</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">positions_for_haplotype</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var_for_haplotype</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">positions_for_haplotype</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output_sample</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">rsq</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">hap_idx</span><span class="p">,</span><span class="n">haploid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">vidx</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haploid</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vidx</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">postvar_name</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">vidx</span><span class="p">]</span>
            <span class="n">prevar_name</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">vidx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">recomb_pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">prevar_name</span><span class="p">,</span><span class="n">postvar_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;run this&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">recombPos</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">recomb_pair</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hap_idx</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">recombPos</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">recomb_pair</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">hap_idx</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haploid</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">var</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recombPos</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">uniq_vars</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exclude_vars</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">rsq</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">person</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># either use privided MAF or computer MAF</span>
<span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">vcf_mafs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;run this&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
            <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># count founder alleles</span>
    <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">idxv</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                <span class="c1"># [#alt, #haplotypes]</span>
                <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">gt</span> <span class="o">=</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">gt</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span><span class="p">:</span>
                <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gtconv</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span>
                <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vcf_mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">mafs</span><span class="p">[</span><span class="s1">&#39;V0-176659933&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">maf_cutoff</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exclude_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mafs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maker</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">:</span>
        <span class="n">exclude_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">listit</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> \
          <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span> <span class="k">if</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_vars</span><span class="p">]</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_vars</span><span class="p">]</span>
    <span class="c1"># handle trivial data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
        <span class="k">del</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp_exclude_vars</span><span class="o">=</span><span class="n">exclude_vars</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp_exclude_vars</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recombPos</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">uniq_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">i</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
<span class="k">for</span> <span class="n">tmp_var</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">tmp_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">uniq_vars</span><span class="p">:</span>
             <span class="n">uniq_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_var</span><span class="p">)</span>
<span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span> <span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">]):</span>
        <span class="c1"># all families have only one variant</span>
        <span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__AssignSNVHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;run this&#39;</span><span class="p">)</span>
        <span class="c1"># calculate LD clusters using founder haplotypes</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__ClusterByLD</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">varnames</span><span class="p">)</span>
        <span class="c1"># recoding the genotype of the region</span>
        <span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__CodeHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clusters</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="def-__ClusterByLD(self,-data,-haplotypes,-varnames):">def __ClusterByLD(self, data, haplotypes, varnames):<a class="anchor-link" href="#def-__ClusterByLD(self,-data,-haplotypes,-varnames):"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([(&#39;1&#39;,
              [[&#39;1&#39;, &#39;I:1&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
               [&#39;1&#39;, &#39;I:1&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;],
               [&#39;1&#39;, &#39;I:2&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;, &#39;2:&#39;],
               [&#39;1&#39;, &#39;I:2&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
               [&#39;1&#39;, &#39;II:3&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;],
               [&#39;1&#39;, &#39;II:3&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;],
               [&#39;1&#39;, &#39;II:2&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;],
               [&#39;1&#39;, &#39;II:2&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;],
               [&#39;1&#39;, &#39;II:1&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2|&#39;, &#39;2|&#39;],
               [&#39;1&#39;, &#39;II:1&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;2|&#39;],
               [&#39;1&#39;, &#39;II:4&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2\\&#39;, &#39;2|&#39;],
               [&#39;1&#39;, &#39;II:4&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1\\&#39;, &#39;2|&#39;]]),
             (&#39;2&#39;,
              [[&#39;2&#39;, &#39;I:A&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;],
               [&#39;2&#39;, &#39;I:A&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;2:&#39;],
               [&#39;2&#39;, &#39;I:B&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;2:&#39;, &#39;1:&#39;],
               [&#39;2&#39;, &#39;I:B&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;],
               [&#39;2&#39;, &#39;II:D&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;],
               [&#39;2&#39;, &#39;II:D&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;],
               [&#39;2&#39;, &#39;II:C&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;],
               [&#39;2&#39;, &#39;II:C&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;],
               [&#39;2&#39;, &#39;II:B&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1:&#39;],
               [&#39;2&#39;, &#39;II:B&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;],
               [&#39;2&#39;, &#39;II:A&#39;, &#39;2:&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;2|&#39;, &#39;1:&#39;],
               [&#39;2&#39;, &#39;II:A&#39;, &#39;1:&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;1|&#39;, &#39;2:&#39;]])])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">r2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">markers</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gtt</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">founder_haplotypes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">markers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">varnames</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ihap</span><span class="p">,</span> <span class="n">hap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">continue</span>
        <span class="n">gt</span> <span class="o">=</span> <span class="p">[</span><span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;?&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">markers</span><span class="p">]</span>
        <span class="n">founder_haplotypes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ihap</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gt</span><span class="p">])))</span>
        <span class="n">gtt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ihap</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gt</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">founder_haplotypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;I:1-0&#39;, &#39;1111111&#39;),
 (&#39;I:1-1&#39;, &#39;2211112&#39;),
 (&#39;I:2-0&#39;, &#39;2211122&#39;),
 (&#39;I:2-1&#39;, &#39;1111111&#39;),
 (&#39;I:A-0&#39;, &#39;1111112&#39;),
 (&#39;I:A-1&#39;, &#39;1111112&#39;),
 (&#39;I:B-0&#39;, &#39;2222221&#39;),
 (&#39;I:B-1&#39;, &#39;1111111&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">egglib</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">matrix_LD</span><span class="p">(</span><span class="n">Align</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">founder_haplotypes</span><span class="p">,</span><span class="n">egglib</span><span class="o">.</span><span class="n">Alphabet</span><span class="p">(</span><span class="n">cat</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span><span class="n">expl</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">],</span><span class="n">miss</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)),(</span><span class="s1">&#39;rsq&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0],
 [[None],
  [1.0, None],
  [0.2380952380952381, 0.2380952380952381, None],
  [0.2380952380952381, 0.2380952380952381, 1.0, None],
  [0.2380952380952381, 0.2380952380952381, 1.0, 1.0, None],
  [0.5555555555555556,
   0.5555555555555556,
   0.42857142857142866,
   0.42857142857142866,
   0.42857142857142866,
   None],
  [0.06666666666666665,
   0.06666666666666665,
   0.14285714285714282,
   0.14285714285714282,
   0.14285714285714282,
   0.0,
   None]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gtt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;I:1-0&#39;, [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;]],
 [&#39;I:1-1&#39;, [&#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]],
 [&#39;I:2-0&#39;, [&#39;2&#39;, &#39;2&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;, &#39;2&#39;]],
 [&#39;I:2-1&#39;, [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;]],
 [&#39;I:A-0&#39;, [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]],
 [&#39;I:A-1&#39;, [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;2&#39;]],
 [&#39;I:B-0&#39;, [&#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;2&#39;, &#39;1&#39;]],
 [&#39;I:B-1&#39;, [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;]]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">egglib</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;, &#39;1:&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ldi</span><span class="p">,</span><span class="n">ld</span> <span class="o">=</span> <span class="n">egglib</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">matrix_LD</span><span class="p">(</span><span class="n">Align</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">gtt</span><span class="p">,</span><span class="n">egglib</span><span class="o">.</span><span class="n">Alphabet</span><span class="p">(</span><span class="n">cat</span><span class="o">=</span><span class="s1">&#39;char&#39;</span><span class="p">,</span><span class="n">expl</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">],</span><span class="n">miss</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)),(</span><span class="s1">&#39;rsq&#39;</span><span class="p">))</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ldi</span><span class="p">)):</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ldi</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">ld</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maker</span><span class="o">.</span><span class="n">r2</span><span class="p">:</span>
            <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="p">[[</span><span class="n">markers</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">connected_components</span><span class="p">(</span><span class="n">blocks</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clusters</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;V0-89984370&#39;, &#39;V1-89984604&#39;], [&#39;V2-89984739&#39;, &#39;V3-89985940&#39;, &#39;V4-89986608&#39;]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;1&#39;: [&#39;V0-89984370&#39;,
  &#39;V1-89984604&#39;,
  &#39;V2-89984739&#39;,
  &#39;V3-89985940&#39;,
  &#39;V4-89986608&#39;,
  &#39;V5-89986760&#39;,
  &#39;V6-89987201&#39;],
 &#39;2&#39;: [&#39;V0-89984370&#39;,
  &#39;V1-89984604&#39;,
  &#39;V2-89984739&#39;,
  &#39;V3-89985940&#39;,
  &#39;V4-89986608&#39;,
  &#39;V5-89986760&#39;,
  &#39;V6-89987201&#39;]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ld</span> <span class="o">=</span> <span class="n">Align</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">founder_haplotypes</span><span class="p">)</span><span class="o">.</span><span class="n">matrixLD</span><span class="p">(</span><span class="n">validCharacters</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">)[</span><span class="s2">&quot;r2&quot;</span><span class="p">]</span>
<span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ld</span><span class="p">:</span>
    <span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ld</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">ld</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maker</span><span class="o">.</span><span class="n">r2</span><span class="p">:</span>
            <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<span class="c1"># get LD clusters</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="p">[[</span><span class="n">markers</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">connected_components</span><span class="p">(</span><span class="n">blocks</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ld</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">block</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">connected_components</span><span class="p">([]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">connected_components</span><span class="p">(</span><span class="n">blocks</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clusters</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="def-__CodeHaplotypes(self,-data,-haplotypes,-mafs,-varnames,-clusters):">def __CodeHaplotypes(self, data, haplotypes, mafs, varnames, clusters):<a class="anchor-link" href="#def-__CodeHaplotypes(self,-data,-haplotypes,-mafs,-varnames,-clusters):"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">clusters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clusters_idx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">haplotypes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="p">[[</span><span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">],</span> <span class="n">clusters_idx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">maker</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetHaplotypes</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="c1"># this sample is not in VCF file. Every variant site should be missing</span>
        <span class="c1"># they have to be skipped for now</span>
        <span class="k">continue</span>
    <span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span> <span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
        
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">maker</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetAlleleFrequencies</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span>
                      <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">maf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">_MarkerMaker__FormatHaplotypes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">varnames</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;I:1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">haplotypes</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
            <span class="c1"># when only wild-type haplotypes are present in a family, still code them instead of ignoring the family</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
                <span class="n">pop</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
                <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span>
            <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="n">tmp_person</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="p">,</span> <span class="n">person</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;00&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]:</span>
                    <span class="n">tmp_person</span><span class="o">+=</span><span class="p">[</span><span class="s1">&#39;?:&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tmp_person</span><span class="o">+=</span><span class="p">[</span><span class="s1">&#39;1:&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_person</span><span class="p">)</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_person</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
            <span class="n">nonvar_hap_flag</span><span class="o">=</span><span class="kc">False</span>
            <span class="c1">#determine if wild-type haplotype is present in a family</span>
            <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="n">tmp_genes</span><span class="o">=</span><span class="p">[]</span>
                <span class="k">for</span> <span class="n">tmpa</span> <span class="ow">in</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
                    <span class="k">if</span> <span class="s1">&#39;A&#39;</span> <span class="ow">in</span> <span class="n">tmpa</span> <span class="ow">or</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">tmpa</span><span class="p">:</span>
                        <span class="n">tmp_genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpa</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmp_genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpa</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">tmp_genes</span><span class="p">)</span><span class="o">==</span><span class="nb">set</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">]):</span>
                    <span class="c1">#non variant haplotype</span>
                    <span class="n">nonvar_hap_flag</span><span class="o">=</span><span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nonvar_hap_flag</span><span class="p">:</span>
                <span class="c1">#if family don&#39;t have wild-type haplotype, add a fake one to ensure correct coding</span>
                <span class="n">var_num</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                <span class="n">fake_person</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;FAKEPERSON&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;1:&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">var_num</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fake_person</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">hidx</span><span class="p">,</span><span class="n">hap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">missing_persons</span><span class="p">:</span>
                    <span class="n">missing_person</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="p">,</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;?:&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
                    <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">hidx</span><span class="p">]</span><span class="o">=</span><span class="n">missing_person</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">clusters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">clusters_idx</span> <span class="o">=</span> <span class="p">[[[]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hap</span><span class="si">{0}</span><span class="se">\t</span><span class="si">{1}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]),</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">haplotypes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="p">[[</span><span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">],</span> <span class="n">clusters_idx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">clusters</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Family LD clusters: &quot;</span><span class="p">,</span> <span class="n">clusters_idx</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">Print</span><span class="p">()</span>
    <span class="c1"># line: [fid, sid, hap1, hap2]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetHaplotypes</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="c1"># this sample is not in VCF file. Every variant site should be missing</span>
            <span class="c1"># they have to be skipped for now</span>
            <span class="k">continue</span>
        <span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="c1">#sub-region count for each sample individual</span>
        <span class="n">superMarkerCount</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">superMarkerCount</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">t_Marker</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">superMarkerCount</span><span class="p">):</span>
            <span class="n">t_pat1</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="n">t_Marker</span><span class="p">]</span>
            <span class="n">t_pat2</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="n">t_Marker</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">t_pat1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_pat1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">t_pat2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">patterns</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">t_Marker</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_pat2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># get MAF</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;0&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">,[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">superMarkerCount</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coder</span><span class="o">.</span><span class="n">GetAlleleFrequencies</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">continue</span>
        <span class="n">data</span><span class="o">.</span><span class="n">varnames_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="n">wt_maf</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">wt_maf</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wt_maf</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
        <span class="n">tmp_data_maf</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">tmp_data_maf</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">tmp_ratio</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">wt_maf</span><span class="p">)</span>
                    <span class="n">tmp_list</span><span class="o">=</span><span class="p">[</span><span class="n">wt_maf</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">tmp_ratio</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">tmp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">wt_maf</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">tmpv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                            <span class="n">tmp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpv</span><span class="o">/</span><span class="n">tmp_ratio</span><span class="p">)</span>
                    <span class="n">tmp_data_maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmp_list</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tmp_data_maf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmp_data_maf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;marker freqs = &quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">maf</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missings</span>
        <span class="k">continue</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># haplotyping</span>
    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">prephased</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">stdoutRedirect</span><span class="p">(</span><span class="n">to</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39;.log&#39;</span><span class="p">):</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span>
                                                       <span class="nb">sorted</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PedToHaplotype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># C++ haplotyping implementation failed</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
            <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># either use privided MAF or computer MAF</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">vcf_mafs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># count founder alleles</span>
        <span class="k">for</span> <span class="n">hap</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">is_founder</span><span class="p">(</span><span class="n">hap</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">idxv</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
                    <span class="c1"># [#alt, #haplotypes]</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">gt</span> <span class="o">=</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="n">hap</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">idxv</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">gt</span> <span class="o">==</span> <span class="s2">&quot;?&quot;</span><span class="p">:</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gtconv</span><span class="p">[</span><span class="n">gt</span><span class="p">]</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maker</span><span class="o">.</span><span class="n">haplotyper</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
    <span class="n">tmp1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
    <span class="c1">#tmp2.apply(dd)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">aa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="_MarkerMaker__Haplotype">_MarkerMaker__Haplotype<a class="anchor-link" href="#_MarkerMaker__Haplotype"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">##Per fam per variant</span>
<span class="n">uniq_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">exclude_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">recombPos</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">markers</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
def __Haplotype(self, data, haplotypes, mafs, varnames,recombPos,uniq_vars,exclude_vars):
'''genetic haplotyping. haplotypes stores per family data'''
# FIXME: it is SWIG's (2.0.12) fault not to properly destroy the object "Pedigree" in "Execute()"
# So there is a memory leak here which I tried to partially handle on C++
#
# Per family haplotyping
#
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp_mafs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
    <span class="c1">## if families are from different populations</span>
    <span class="c1">## estimate MAF by different population</span>
    <span class="n">fam_to_analyze</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">fam</span><span class="p">,</span><span class="n">pop</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">pop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fam_to_analyze</span><span class="p">:</span>
            <span class="n">fam_to_analyze</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">fam</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fam_to_analyze</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fam</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
    <span class="c1">## estimate MAF by counting founder alleles</span>
    <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
        <span class="n">local_count_mafs</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">fam_to_analyze</span><span class="p">:</span>
            <span class="n">local_count_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="n">tmp1</span><span class="o">.</span><span class="n">_MarkerMaker__computefounderfreq</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">fam_to_analyze</span><span class="p">[</span><span class="n">pop</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">local_count_mafs</span><span class="o">=</span><span class="n">tmp1</span><span class="o">.</span><span class="n">_MarkerMaker__computefounderfreq</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;run here&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_count_mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">mle</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">mle</span><span class="p">:</span>
    <span class="c1">## estimate MLE allele frequency using all fam</span>
    <span class="n">local_mle_mafs</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">fam_to_analyze</span><span class="p">:</span>
            <span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">markers_to_analyze</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">pos_all</span><span class="o">=</span><span class="p">[]</span>
            <span class="n">markers_analyzed</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="n">pop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">tmpv</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]:</span>
                    <span class="n">markers_analyzed</span><span class="p">[</span><span class="n">tmpv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">tmpv</span><span class="p">]</span>
            <span class="n">output_log</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="o">+</span><span class="s2">&quot;AF_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">.log&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span><span class="n">tmp1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">popidx</span><span class="o">=</span><span class="n">tmp1</span><span class="o">.</span><span class="n">af_info</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
            <span class="n">variants_in_fams</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">fam_to_analyze</span><span class="p">[</span><span class="n">pop</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">tmpvar</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">tmpvar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">variants_in_fams</span><span class="p">:</span>
                        <span class="n">variants_in_fams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpvar</span><span class="p">)</span>
            <span class="n">variants_in_fams</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">variants_in_fams</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">variants_in_fams</span><span class="p">:</span>
                <span class="n">idx</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">popidx</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">markers_analyzed</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="c1">#if variant has been analyzed</span>
                        <span class="n">vname</span><span class="o">=</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">vname</span><span class="p">]</span><span class="o">=</span><span class="n">markers_analyzed</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#variant not analyzed before</span>
                        <span class="n">markers_to_analyze</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="n">pos_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">tmp_mle_mafs</span><span class="o">=</span><span class="n">tmp1</span><span class="o">.</span><span class="n">_MarkerMaker__getMLEfreq</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">markers_to_analyze</span><span class="p">,</span> <span class="n">pos_all</span><span class="p">,</span> <span class="n">fam_to_analyze</span><span class="p">[</span><span class="n">pop</span><span class="p">],</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">output_log</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_mle_mafs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">vname</span><span class="p">,</span><span class="n">vmaf</span> <span class="ow">in</span> <span class="n">tmp_mle_mafs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">vname</span><span class="p">]</span><span class="o">=</span><span class="n">vmaf</span>
                    <span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">vname</span><span class="p">]</span><span class="o">=</span><span class="n">vmaf</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Homogeneous families</span>
        <span class="n">markers_to_analyze</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">pos_all</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">markers_analyzed</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">tmpv</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">:</span>
            <span class="n">markers_analyzed</span><span class="p">[</span><span class="n">tmpv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">[</span><span class="n">tmpv</span><span class="p">]</span>
        <span class="n">variants_in_fams</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">var_per_fam</span><span class="o">=</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">tmpvar</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmpvar</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">)]</span>
            <span class="n">variants_in_fams</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">var_per_fam</span><span class="o">+</span><span class="n">variants_in_fams</span><span class="p">))</span>
        <span class="n">variants_in_fams</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">tmpvar</span><span class="p">)</span> <span class="k">for</span> <span class="n">tmpvar</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">variants_in_fams</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">variants_in_fams</span><span class="p">:</span>
            <span class="n">idx</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">variants</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">af_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">markers_analyzed</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="c1">#if variant has been analyzed</span>
                    <span class="n">vname</span><span class="o">=</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span><span class="o">=</span><span class="n">markers_analyzed</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#variant not analyzed before</span>
                    <span class="n">markers_to_analyze</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;V</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="n">pos_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">output_log</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="o">+</span><span class="s2">&quot;AF_</span><span class="si">{}</span><span class="s2">.log&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tmp1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">tmp_mle_mafs</span><span class="o">=</span><span class="n">tmp1</span><span class="o">.</span><span class="n">_MarkerMaker__getMLEfreq</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">markers_to_analyze</span><span class="p">,</span> <span class="n">pos_all</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">output_log</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_mle_mafs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">vname</span><span class="p">,</span> <span class="n">vmaf</span> <span class="ow">in</span> <span class="n">tmp_mle_mafs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">data</span><span class="o">.</span><span class="n">mle_mafs</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span><span class="o">=</span><span class="n">vmaf</span>
                <span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span><span class="o">=</span><span class="n">vmaf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp_mle_mafs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">varnames</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">families</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;map&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">famvaridx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">famsampidx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gnomAD_pop</span><span class="o">=</span><span class="kc">None</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">:</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">positions</span><span class="p">,</span> <span class="n">vcf_mafs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamVariants</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;map&quot;</span><span class="p">)</span>
    <span class="n">recombPos</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">var_for_haplotype</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">positions_for_haplotype</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">output_sample</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">repr</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># either use privided MAF or compute MAF</span>
    <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
        <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">tfreq_fam</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">gnomAD_estimate</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">tfreq_fam</span><span class="p">:</span>
                <span class="n">gnomAD_pop</span><span class="o">=</span><span class="n">pop</span>
                <span class="k">break</span>
    <span class="k">elif</span> <span class="n">gnomAD_pop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">gnomAD_estimate</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="p">:</span>
                <span class="n">gnomAD_pop</span><span class="o">=</span><span class="n">pop</span>
                <span class="k">break</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
        <span class="n">tmp_maf_var</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">af_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#no vcf freq column specified</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">mle</span><span class="p">:</span>
                <span class="c1">#use MLE freq for all variants</span>
                    <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="c1">#estimate MAF based on founder counts if MLE not specified</span>
                    <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">local_count_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                <span class="n">tmp_maf_var</span><span class="o">=</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">af_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#if vcf freq column is specified</span>
            <span class="c1">#use vcf_mafs if possible</span>
            <span class="k">if</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                <span class="n">tmp_maf_var</span><span class="o">=</span><span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
                        <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">vcf_mafs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#if variants do not have valid vcf_mafs values if specified</span>
                <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gnomAD_pop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gnomAD_estimate</span><span class="p">[</span><span class="n">gnomAD_pop</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">mle</span><span class="p">:</span>
                            <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]][</span><span class="n">v</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                            <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">local_count_mafs</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]][</span><span class="n">v</span><span class="p">]</span>
                    <span class="n">tmp_maf_var</span><span class="o">=</span><span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">gnomAD_pop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gnomAD_estimate</span><span class="p">[</span><span class="n">gnomAD_pop</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">mle</span><span class="p">:</span>
                            <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">local_mle_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                            <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">local_count_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                    <span class="n">tmp_maf_var</span><span class="o">=</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">rvhaplo</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tmp_maf_var</span><span class="o">&lt;=</span><span class="n">tmp1</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">:</span>
                <span class="n">var_for_haplotype</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">positions_for_haplotype</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">rvhaplo</span><span class="p">:</span>
        <span class="n">var_for_haplotype</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="n">positions_for_haplotype</span><span class="o">=</span><span class="n">positions</span>
    <span class="c1">#collect sample+genotypes</span>
    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">sort_family</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">output_sample</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">last_ele</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">output_sample</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tfam</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">person</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">samples</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">var_for_haplotype</span><span class="p">:</span>
                <span class="n">idx</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">marker</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">genotype_all</span><span class="p">[</span><span class="n">person</span><span class="p">][</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_sample</span><span class="p">[</span><span class="n">last_ele</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;00&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_for_haplotype</span><span class="p">))</span>
    <span class="c1"># haplotyping</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_for_haplotype</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">varnames</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1">#for person in data.families[item]:</span>
        <span class="c1">#    data[person] = tmp1.missings</span>
        <span class="k">continue</span>
    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">output_sample</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">person</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span><span class="o">==</span><span class="nb">set</span><span class="p">([</span><span class="s1">&#39;00&#39;</span><span class="p">]):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">missing_persons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="o">.</span><span class="n">prephased</span><span class="p">:</span>
            <span class="n">tmp_log_output</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
            <span class="k">with</span> <span class="n">stdoutRedirect</span><span class="p">(</span><span class="n">to</span> <span class="o">=</span> <span class="n">tmp_log_output</span> <span class="o">+</span> <span class="s1">&#39;.log&#39;</span><span class="p">):</span>
                <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">haplotyper</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chrom</span><span class="p">,</span> <span class="n">var_for_haplotype</span><span class="p">,</span> <span class="n">positions_for_haplotype</span><span class="p">,</span> <span class="n">output_sample</span><span class="p">,</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span> <span class="n">tmp_log_output</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">__PedToHaplotype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getFamSamples</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># C++ haplotyping implementation failed</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
            <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">var_for_haplotype</span>
    
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">hap_idx</span><span class="p">,</span><span class="n">haploid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">item</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">vidx</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haploid</span><span class="p">[</span><span class="mi">2</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">vidx</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">postvar_name</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">vidx</span><span class="p">]</span>
                <span class="n">prevar_name</span><span class="o">=</span><span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">vidx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">recomb_pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">prevar_name</span><span class="p">,</span><span class="n">postvar_name</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">recombPos</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">recomb_pair</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hap_idx</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">recombPos</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">recomb_pair</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">hap_idx</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># Compute founder MAFs</span>
<span class="c1">#</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_mafs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">v</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>
<span class="c1">## Make mafs consistent in structure regardless of freq_by_fam</span>
<span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
        <span class="n">popname</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">popname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">:</span>
            <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">popname</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tmp_mafs</span><span class="p">[</span><span class="n">popname</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                    <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">tmp_mafs</span><span class="p">[</span><span class="n">popname</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="p">:</span>
        <span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">=</span><span class="n">tmp_mafs</span>
<span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;variant mafs = &quot;</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="c1">##</span>
<span class="c1">#</span>
<span class="c1"># Drop some variants if maf is greater than given threshold</span>
<span class="c1">#</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">maf_cutoff</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">single_markers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
        <span class="n">exclude_vars</span><span class="o">=</span><span class="p">[[]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">haplotypes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
            <span class="n">pop_idx</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">tmp_exclude_vars</span><span class="o">=</span><span class="n">exclude_vars</span><span class="p">[</span><span class="n">pop_idx</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tmp_exclude_vars</span><span class="o">=</span><span class="n">exclude_vars</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mafs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">maf_cutoff</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mafs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">maf_cutoff</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">include_vars</span><span class="p">:</span>
                    <span class="n">tmp_exclude_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">single_markers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">include_vars</span><span class="p">:</span>
                    <span class="n">tmp_exclude_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">listit</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">tmp_remain_vars</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span><span class="p">]</span>
        <span class="n">recomb_remain_vars</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_remain_vars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1">#extend recombination signal to neighbouring RVs</span>
                <span class="c1">#if the original variant is to be excluded</span>
                <span class="c1">#Only allow a maximum of one recombination event between one pair of consecutive markers</span>
                <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">tmp_remain_vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">recomb_remain_vars</span><span class="p">:</span>
                            <span class="n">recomb_remain_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pair</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">tmp_remain_vars</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="c1">#last variant</span>
                            <span class="k">del</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pair</span><span class="p">]</span>
                            <span class="k">continue</span>
                        <span class="k">for</span> <span class="n">tmp_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                            <span class="k">if</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">tmp_idx</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">tmp_remain_vars</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">tmp_idx</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                                    <span class="c1">#delete recombination pair if the recombination was marked to the first remaining variant</span>
                                    <span class="k">del</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pair</span><span class="p">]</span>
                                    <span class="k">break</span>
                                <span class="k">for</span> <span class="n">tmp_hap</span> <span class="ow">in</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pair</span><span class="p">]:</span>
                                    <span class="n">tmp_var</span><span class="o">=</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">tmp_hap</span><span class="p">][</span><span class="n">tmp_idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
                                    <span class="k">if</span> <span class="n">tmp_var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">tmp_var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">):</span>
                                        <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">tmp_hap</span><span class="p">][</span><span class="n">tmp_idx</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">tmp_var</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
                                <span class="k">if</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">tmp_idx</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">recomb_remain_vars</span><span class="p">:</span>
                                    <span class="n">recomb_remain_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">tmp_idx</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">del</span> <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">pair</span><span class="p">]</span>
                                <span class="k">break</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
            <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> \
              <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span> <span class="k">if</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tmp_var</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">tmp_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">uniq_vars</span><span class="p">:</span>
                     <span class="n">uniq_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_var</span><span class="p">)</span>
        <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tmp_exclude_vars</span><span class="p">]</span>
        <span class="c1"># handle trivial data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">&gt;</span><span class="n">tmp1</span><span class="o">.</span><span class="n">recomb_max</span><span class="p">:</span>
            <span class="c1">#treat as missing if recombination events occurred more than speicified times</span>
            <span class="n">recombPos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">families</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">person</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">missings</span>
            <span class="k">del</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">haplotypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># count how many variants are removed</span>
    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
            <span class="n">tmp_ex_vars</span><span class="o">=</span><span class="p">[</span><span class="n">tmp_var</span> <span class="k">for</span> <span class="n">tmp_vars</span> <span class="ow">in</span> <span class="n">exclude_vars</span> <span class="k">for</span> <span class="n">tmp_var</span> <span class="ow">in</span> <span class="n">tmp_vars</span><span class="p">]</span>
            <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tmp_ex_vars</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exclude_vars</span><span class="p">)</span>
    <span class="c1"># get total observed variants</span>
    <span class="k">if</span> <span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">:</span>
            <span class="n">pop</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">pop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
                <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="n">pop</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
            <span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">tmaf</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span><span class="o">*=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">tmaf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">[</span><span class="n">item</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">=</span><span class="n">mafs</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">tmaf</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">total_mafs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span><span class="o">*=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">tmaf</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">total_varnames</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">??</span>cstatgen.HaplotypingEngine<span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">wt_maf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">variants</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">aa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">_MarkerMaker__Haplotype</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">count</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">mle</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">rvhaplo</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
<span class="n">tmp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">freq_by_fam</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">count</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">prephased</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">haplotypes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">mafs</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">##Per fam per variant</span>
<span class="n">uniq_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">exclude_vars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">varnames</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">recombPos</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">tmp1</span><span class="o">.</span><span class="n">_MarkerMaker__Haplotype</span><span class="p">(</span><span class="n">dd</span><span class="p">,</span> <span class="n">haplotypes</span><span class="p">,</span> <span class="n">mafs</span><span class="p">,</span> <span class="n">varnames</span><span class="p">,</span><span class="n">recombPos</span><span class="p">,</span><span class="n">uniq_vars</span><span class="p">,</span><span class="n">exclude_vars</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tm</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">recomb_perfam</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">variants</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">include_vars</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">variants</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp1</span><span class="o">.</span><span class="n">getRegion</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">tmp1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span><span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">variants</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">chrom</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">variants</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">vcf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">??</span>EncoderWorker
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">total_counter</span><span class="o">.</span><span class="n">value</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">jobs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
    <span class="n">j</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
    <span class="n">j</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="n">faulthandler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">faulthandler</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span> <span class="o">+</span> <span class="s1">&#39;.SEGV&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">freq_by_fam_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">freq_by_fam</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;haha&#39;</span><span class="p">)</span>
            <span class="n">freq_by_fam_flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">)</span> <span class="k">as</span> <span class="n">freq_fh</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">freq_line</span> <span class="ow">in</span> <span class="n">freq_fh</span><span class="p">:</span>
                    <span class="n">tmp_eles</span><span class="o">=</span><span class="n">freq_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>   <span class="c1">#Fam and Population</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="p">[</span><span class="n">tmp_eles</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">tmp_eles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">freq_by_fam</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">freq</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="p">[</span><span class="n">EncoderWorker</span><span class="p">(</span>
            <span class="n">queue</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">),</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">RegionExtractor</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">vcf</span><span class="p">,</span> <span class="n">chr_prefix</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">chr_prefix</span><span class="p">,</span> <span class="n">allele_freq_info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">include_vars_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">include_vars</span><span class="p">),</span>
            <span class="n">MarkerMaker</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">bin</span><span class="p">,</span> <span class="n">maf_cutoff</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">,</span><span class="n">single_markers</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">single_markers</span><span class="p">,</span><span class="n">recomb_max</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">recomb_max</span><span class="p">,</span><span class="n">af_info</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span><span class="n">freq_by_fam</span><span class="o">=</span><span class="n">freq_by_fam_flag</span><span class="p">,</span><span class="n">rsq</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">rsq</span><span class="p">,</span><span class="n">mle</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">mle</span><span class="p">,</span> <span class="n">rvhaplo</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">rvhaplo</span><span class="p">,</span> <span class="n">recomb_perfam</span><span class="o">=</span><span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">recomb_cross_fam</span><span class="p">),</span>
            <span class="n">LinkageWriter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples_not_vcf</span><span class="p">))</span>
            <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
            <span class="n">j</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
            <span class="n">j</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">faulthandler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="c1"># FIXME: need to properly close all jobs</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Use &#39;killall </span><span class="si">{}</span><span class="s2">&#39; to properly terminate all processes!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">prog</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units (from </span><span class="si">{:,d}</span><span class="s1"> variants) processed; &#39;</span>\
            <span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> Mendelian inconsistencies and </span><span class="si">{:,d}</span><span class="s1"> recombination events handled</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                   <span class="n">env</span><span class="o">.</span><span class="n">variants_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                   <span class="n">env</span><span class="o">.</span><span class="n">mendelerror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                   <span class="n">env</span><span class="o">.</span><span class="n">recomb_counter</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> tri-allelic loci were ignored&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">triallelic_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> variants ignored due to having MAF &gt; </span><span class="si">{}</span><span class="s1"> and other specified constraints&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">commonvar_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">maf_cutoff</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units ignored due to absence in VCF file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">null_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units ignored due to absence of variation in samples&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">trivial_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">fatal_errors</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Error msg from C++ extension</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;cat </span><span class="si">{}</span><span class="s2">/*.* &gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="p">))</span>
            <span class="n">fatal_errors</span> <span class="o">=</span> <span class="n">wordCount</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_log</span><span class="p">)[</span><span class="s1">&#39;fatal&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:,d}</span><span class="s2"> regional markers failed to be generated due to haplotyping failures!&quot;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">chperror_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fatal_errors</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:,d}</span><span class="s2"> or more regional markers failed to be generated due to runtime errors!&quot;</span><span class="o">.</span>\
                      <span class="nb">format</span><span class="p">(</span><span class="n">fatal_errors</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Archiving regional marker data to directory [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;CACHE&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">jobs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tpeds</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.tped&#39;</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">:</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading </span><span class="si">{}</span><span class="s1"> data from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units will be converted to </span><span class="si">{}</span><span class="s1"> format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">format_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">format</span><span class="p">(</span><span class="n">tpeds</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.tfam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)),</span>
               <span class="n">args</span><span class="o">.</span><span class="n">prevalence</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">wild_pen</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">muta_pen</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span>
               <span class="n">args</span><span class="o">.</span><span class="n">inherit_mode</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:,d}</span><span class="s1"> units successfully converted to </span><span class="si">{}</span><span class="s1"> format</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">format_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">skipped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="c1"># FIXME: perhaps we need to rephrase this message?</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> region - family pairs skipped&#39;</span><span class="o">.</span>\
                    <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">skipped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Archiving </span><span class="si">{}</span><span class="s1"> format to directory [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                    <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">mkpath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">)</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span><span class="p">:</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading linkage analysis result from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;heatmap&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Running linkage analysis ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">run_linkage</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Linkage analysis succesfully performed for </span><span class="si">{:,d}</span><span class="s1"> units</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;makeped&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;pedcheck&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;unknown&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;mlink&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">html</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Saving data to [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Args</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

