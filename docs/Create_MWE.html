---

title: 1.read fam


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/06_Create_MWE.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_Create_MWE.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">gzip</span>

<span class="k">def</span> <span class="nf">get_vcf_names</span><span class="p">(</span><span class="n">vcf_path</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">vcf_path</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ifile</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#CHROM&quot;</span><span class="p">):</span>
                <span class="n">vcf_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)]</span>
                <span class="k">break</span>
    <span class="n">ifile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">vcf_names</span>

<span class="k">def</span> <span class="nf">read_vcf_chunk</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">chunksize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">get_vcf_names</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vcf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">vcf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vcf</span><span class="o">.</span><span class="n">get_chunk</span><span class="p">(</span><span class="n">chunksize</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">read_anno_chunk</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="n">chunksize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vcf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">vcf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vcf</span><span class="o">.</span><span class="n">get_chunk</span><span class="p">(</span><span class="n">chunksize</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/nodp_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">,</span><span class="s1">&#39;iid&#39;</span><span class="p">,</span><span class="s1">&#39;fathid&#39;</span><span class="p">,</span><span class="s1">&#39;mothid&#39;</span><span class="p">,</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span><span class="s1">&#39;ad&#39;</span><span class="p">,</span><span class="s1">&#39;vcf&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/nodp_fam.fam&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.1-Normal-family">1.1 Normal family<a class="anchor-link" href="#1.1-Normal-family"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;22_1&#39;</span><span class="p">,</span><span class="s1">&#39;1036&#39;</span><span class="p">,</span><span class="s1">&#39;28_9&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_normal_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="p">))),</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="nb">sum</span><span class="p">(</span><span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vcf</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="p">)]),</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="nb">sum</span><span class="p">(</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="p">)])])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fid&#39;</span><span class="p">,</span><span class="s1">&#39;vcf&#39;</span><span class="p">,</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;per&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">vcf</span><span class="o">/</span><span class="n">tmp</span><span class="o">.</span><span class="n">tol</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;per&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fid</th>
      <th>vcf</th>
      <th>tol</th>
      <th>per</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>37</th>
      <td>4_649</td>
      <td>2</td>
      <td>373</td>
      <td>0.005362</td>
    </tr>
    <tr>
      <th>36</th>
      <td>535</td>
      <td>1</td>
      <td>62</td>
      <td>0.016129</td>
    </tr>
    <tr>
      <th>761</th>
      <td>8_64024</td>
      <td>1</td>
      <td>43</td>
      <td>0.023256</td>
    </tr>
    <tr>
      <th>734</th>
      <td>10R_R81</td>
      <td>1</td>
      <td>43</td>
      <td>0.023256</td>
    </tr>
    <tr>
      <th>115</th>
      <td>4_715</td>
      <td>1</td>
      <td>41</td>
      <td>0.02439</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>264</th>
      <td>1999</td>
      <td>6</td>
      <td>9</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>225</th>
      <td>22_1</td>
      <td>5</td>
      <td>7</td>
      <td>0.714286</td>
    </tr>
    <tr>
      <th>735</th>
      <td>1036</td>
      <td>5</td>
      <td>7</td>
      <td>0.714286</td>
    </tr>
    <tr>
      <th>3</th>
      <td>28_9</td>
      <td>8</td>
      <td>11</td>
      <td>0.727273</td>
    </tr>
    <tr>
      <th>434</th>
      <td>10R_R107</td>
      <td>8</td>
      <td>10</td>
      <td>0.8</td>
    </tr>
  </tbody>
</table>
<p>818 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.2-Multi-group-family">1.2 Multi-group family<a class="anchor-link" href="#1.2-Multi-group-family"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;27_104&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_multi_group_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.3-In-law-family">1.3 In-law family<a class="anchor-link" href="#1.3-In-law-family"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;4_461&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_in_law_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.4">1.4<a class="anchor-link" href="#1.4"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;1005&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_the_1005_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.5">1.5<a class="anchor-link" href="#1.5"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ok_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ok_plot.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ok_plot</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="mi">10</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_ok_plot_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.6-4_364-family">1.6 4_364 family<a class="anchor-link" href="#1.6-4_364-family"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f4_364</span> <span class="o">=</span> <span class="n">fam</span><span class="p">[</span><span class="n">fam</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;4_364&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f4_364</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_the_4_364_all_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f4_364</span><span class="p">[</span><span class="o">~</span><span class="n">f4_364</span><span class="o">.</span><span class="n">iid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;4_364_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">20</span><span class="p">)])]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_the_4_364_rm_4-5layers_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f4_364</span><span class="p">[</span><span class="o">~</span><span class="n">f4_364</span><span class="o">.</span><span class="n">iid</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;4_364_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">20</span><span class="p">)])]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_the_4_364_rm_5layers_fam.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.read-ped">1.read ped<a class="anchor-link" href="#1.read-ped"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ped</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/nodp_ped_with_depth_trim.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ped</span><span class="p">[</span><span class="n">ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">trim_smry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">trim_smry</span><span class="o">.</span><span class="n">before</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_3layers.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trim_ped</span> <span class="o">=</span> <span class="n">ped</span><span class="p">[</span><span class="n">ped</span><span class="o">.</span><span class="n">trim</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trim_smry</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">ped</span><span class="o">.</span><span class="n">depth</span><span class="p">[</span><span class="n">ped</span><span class="o">.</span><span class="n">fid</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">unique</span><span class="p">()],[</span><span class="n">trim_ped</span><span class="o">.</span><span class="n">depth</span><span class="p">[</span><span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">unique</span><span class="p">()]])</span>
<span class="n">trim_smry</span> <span class="o">=</span> <span class="n">trim_smry</span><span class="o">.</span><span class="n">T</span>
<span class="n">trim_smry</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">trim_smry</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;before&#39;</span><span class="p">,</span><span class="s1">&#39;after&#39;</span><span class="p">]</span>
<span class="n">trim_smry</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;before&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;after&#39;}&gt;]], dtype=object)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Output-families-with-pedigree-less-than-4">Output families with pedigree less than 4<a class="anchor-link" href="#Output-families-with-pedigree-less-than-4"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trim_ped</span><span class="p">[</span><span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">trim_smry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">trim_smry</span><span class="o">.</span><span class="n">after</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">])]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_trimed_3layers.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trim_lay3</span> <span class="o">=</span> <span class="n">trim_ped</span><span class="p">[</span><span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">trim_smry</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">trim_smry</span><span class="o">.</span><span class="n">after</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trim_faml20_fid</span> <span class="o">=</span> <span class="n">trim_lay3</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">20</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trim_ped</span><span class="p">[</span><span class="n">trim_ped</span><span class="o">.</span><span class="n">fid</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">trim_faml20_fid</span><span class="p">[</span><span class="n">trim_faml20_fid</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/mwe_trimed_3layers_faml20.csv&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.read-vcf-and-annotation">2.read vcf and annotation<a class="anchor-link" href="#2.read-vcf-and-annotation"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vcf</span> <span class="o">=</span> <span class="n">read_vcf_chunk</span><span class="p">(</span><span class="s1">&#39;/mnt/mfs/statgen/alzheimers-family/linkage_files/geno/full_sample/vcf/full_sample.vcf.gz&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vcf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#CHROM</th>
      <th>POS</th>
      <th>ID</th>
      <th>REF</th>
      <th>ALT</th>
      <th>QUAL</th>
      <th>FILTER</th>
      <th>INFO</th>
      <th>FORMAT</th>
      <th>4_364_99</th>
      <th>...</th>
      <th>8_64039_20</th>
      <th>8_64039_25</th>
      <th>8_64039_3</th>
      <th>25_6_107C</th>
      <th>25_22_491C</th>
      <th>26_EGH_EGH64401</th>
      <th>26_SW_SW27020</th>
      <th>10R_R111_16</th>
      <th>10R_R114_16</th>
      <th>10R_R114_20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>10140</td>
      <td>chr1:10140:ACCCTAAC:A</td>
      <td>ACCCTAAC</td>
      <td>A</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>10146</td>
      <td>chr1:10146:AC:A</td>
      <td>AC</td>
      <td>A</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/1</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/1</td>
      <td>0/0</td>
      <td>1/1</td>
      <td>0/1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>10146</td>
      <td>chr1:10146:ACC:*</td>
      <td>ACC</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>10150</td>
      <td>chr1:10150:CT:C</td>
      <td>CT</td>
      <td>C</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>./.</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>10172</td>
      <td>chr1:10172:CCCTAA:C</td>
      <td>CCCTAA</td>
      <td>C</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>./.</td>
      <td>...</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>./.</td>
      <td>0/0</td>
      <td>./.</td>
      <td>./.</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>1</td>
      <td>66479</td>
      <td>chr1:66479:TATTTATAG:*</td>
      <td>TATTTATAG</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>./.</td>
      <td>0/0</td>
      <td>./.</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>996</th>
      <td>1</td>
      <td>66480</td>
      <td>chr1:66480:AT:A</td>
      <td>AT</td>
      <td>A</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>./.</td>
      <td>0/0</td>
      <td>./.</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>997</th>
      <td>1</td>
      <td>66480</td>
      <td>chr1:66480:ATTT:*</td>
      <td>ATTT</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>./.</td>
      <td>0/0</td>
      <td>./.</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>998</th>
      <td>1</td>
      <td>66481</td>
      <td>chr1:66481:TTTATAGA:*</td>
      <td>TTTATAGA</td>
      <td>*</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>./.</td>
      <td>0/0</td>
      <td>./.</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>./.</td>
    </tr>
    <tr>
      <th>999</th>
      <td>1</td>
      <td>66481</td>
      <td>chr1:66481:TTTATAGA:T</td>
      <td>TTTATAGA</td>
      <td>T</td>
      <td>.</td>
      <td>.</td>
      <td>PR</td>
      <td>GT</td>
      <td>0/0</td>
      <td>...</td>
      <td>./.</td>
      <td>0/0</td>
      <td>./.</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>./.</td>
      <td>0/0</td>
      <td>0/0</td>
      <td>./.</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 3488 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.1merge-vcf-and-annotation">2.1merge vcf and annotation<a class="anchor-link" href="#2.1merge-vcf-and-annotation"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anno</span> <span class="o">=</span> <span class="n">read_anno_chunk</span><span class="p">(</span><span class="s1">&#39;/home/yl4604/project/alzheimers-family/SMMAT/20210802/annotation/EFIGA_NIALOAD_chr1.hg38.hg38_multianno.csv&#39;</span><span class="p">,</span><span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">af</span> <span class="o">=</span> <span class="n">anno</span><span class="o">.</span><span class="n">AF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">af</span> <span class="o">=</span> <span class="n">af</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="mf">0.00001</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">af</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vcf</span><span class="o">.</span><span class="n">INFO</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AF=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">af</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vcf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/first1000snp_full_samples.vcf&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
bgzip first1000snp_full_samples.vcf 
tabix first1000snp_full_samples.vcf.gz
</div>
 

