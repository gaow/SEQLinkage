---

title: Runner module


keywords: fastai
sidebar: home_sidebar

summary: "API details."
description: "API details."
nb_path: "nbs/01_Runner.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_Runner.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format" class="doc_header"><code>format</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format</code>(<strong><code>tpeds</code></strong>, <strong><code>tfam</code></strong>, <strong><code>prev</code></strong>=<em><code>None</code></em>, <strong><code>wild_pen</code></strong>=<em><code>None</code></em>, <strong><code>muta_pen</code></strong>=<em><code>None</code></em>, <strong><code>out_format</code></strong>=<em><code>'MERLIN'</code></em>, <strong><code>inherit_mode</code></strong>=<em><code>None</code></em>, <strong><code>theta_max</code></strong>=<em><code>None</code></em>, <strong><code>theta_inc</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_plink" class="doc_header"><code>format_plink</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_plink</code>(<strong><code>tped</code></strong>, <strong><code>tfam</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_mega2" class="doc_header"><code>format_mega2</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_mega2</code>(<strong><code>tped</code></strong>, <strong><code>tfam</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_merlin" class="doc_header"><code>format_merlin</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L97" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_merlin</code>(<strong><code>tped</code></strong>, <strong><code>tfam</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="format_linkage" class="doc_header"><code>format_linkage</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L141" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>format_linkage</code>(<strong><code>tped</code></strong>, <strong><code>tfam</code></strong>, <strong><code>prev</code></strong>, <strong><code>wild_pen</code></strong>, <strong><code>muta_pen</code></strong>, <strong><code>inherit_mode</code></strong>, <strong><code>theta_max</code></strong>, <strong><code>theta_inc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parse_tfam" class="doc_header"><code>parse_tfam</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L218" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parse_tfam</code>(<strong><code>fh</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Pedigree" class="doc_header"><code>class</code> <code>Pedigree</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L229" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Pedigree</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="run_linkage" class="doc_header"><code>run_linkage</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L278" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>run_linkage</code>(<strong><code>blueprint</code></strong>, <strong><code>theta_inc</code></strong>, <strong><code>theta_max</code></strong>, <strong><code>to_plot</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="linkage_worker" class="doc_header"><code>linkage_worker</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L287" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>linkage_worker</code>(<strong><code>blueprint</code></strong>, <strong><code>workdir</code></strong>, <strong><code>theta_inc</code></strong>, <strong><code>theta_max</code></strong>, <strong><code>errfile</code></strong>, <strong><code>to_plot</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hinton" class="doc_header"><code>hinton</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L408" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hinton</code>(<strong><code>filename</code></strong>, <strong><code>max_weight</code></strong>=<em><code>None</code></em>, <strong><code>ax</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="heatmap" class="doc_header"><code>heatmap</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L431" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>heatmap</code>(<strong><code>file</code></strong>, <strong><code>theta_inc</code></strong>, <strong><code>theta_max</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hlod_fun" class="doc_header"><code>hlod_fun</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L457" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hlod_fun</code>(<strong><code>Li</code></strong>, <strong><code>sign</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="html" class="doc_header"><code>html</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L462" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>html</code>(<strong><code>theta_inc</code></strong>, <strong><code>theta_max</code></strong>, <strong><code>limit</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="html_img" class="doc_header"><code>html_img</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L540" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>html_img</code>(<strong><code>ltype</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="html_table" class="doc_header"><code>html_table</code><a href="https://github.com/changebio/SEQLinkage/tree/master/SEQLinkage/Runner.py#L546" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>html_table</code>(<strong><code>type</code></strong>, <strong><code>theta_inc</code></strong>, <strong><code>theta_max</code></strong>, <strong><code>limit</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing-runner">Testing runner<a class="anchor-link" href="#Testing-runner"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-parameters">1. parameters<a class="anchor-link" href="#1.-parameters"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">SEQLinkage.Main</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">SEQLinkage.Utils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">Queue</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">faulthandler</span><span class="o">,</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">cstatgen</span> <span class="kn">import</span> <span class="n">cstatgen_py2</span> <span class="k">as</span> <span class="n">cstatgen</span>
    <span class="kn">from</span> <span class="nn">cstatgen.egglib</span> <span class="kn">import</span> <span class="n">Align</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">cstatgen</span> <span class="kn">import</span> <span class="n">cstatgen_py3</span> <span class="k">as</span> <span class="n">cstatgen</span>
    <span class="kn">import</span> <span class="nn">egglib</span>
    <span class="kn">from</span> <span class="nn">egglib</span> <span class="kn">import</span> <span class="n">Align</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">&#39;--fam data/mwe_normal_fam.csv --vcf data/first1000snp_full_samples.vcf.gz -f MERLIN --blueprint data/genemap.hg38.txt --freq AF --run-linkage -K 0.001 --moi AD -W 0 -M 1 --theta-max 0.5 --theta-inc 0.05&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Namespace(bin=0.8, blueprint=&#39;data/genemap.hg38.txt&#39;, single_markers=False, tfam=&#39;data/mwe_normal_fam.csv&#39;, vcf=&#39;data/first1000snp_full_samples.vcf.gz&#39;, build=&#39;hg19&#39;, prephased=False, freq=&#39;AF&#39;, freq_by_fam=None, mle=False, rvhaplo=False, recomb_max=1, recomb_cross_fam=False, rsq=0.0, include_vars=None, maf_cutoff=1.0, chr_prefix=None, output=None, format=[&#39;MERLIN&#39;], prevalence=0.001, inherit_mode=&#39;AD&#39;, wild_pen=0.0, muta_pen=1.0, theta_max=0.5, theta_inc=0.05, run_linkage=True, output_limit=10, jobs=16, tempdir=None, vanilla=True, quiet=False, debug=False, no_save=False, func=&lt;function main at 0x2b7a3363e1f0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">checkParams</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Binary trait detected in [/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/data/mwe_normal_fam.csv]</span>
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">no_save</span><span class="p">:</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">NoCache</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">Cache</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
<span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;vcf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Testing-run_linkage">2. Testing run_linkage<a class="anchor-link" href="#2.-Testing-run_linkage"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">output</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;LINKAGE&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">?</span>cache.load
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Signature:</span> cache<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span>target_dir<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> names<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span> &lt;no docstring&gt;
<span class="ansi-red-fg">File:</span>      /mnt/mfs/statgen/yin/Github/linkage/SEQpy3/SEQLinkage/Utils.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cache</span><span class="o">.</span><span class="n">cache_name</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;/mnt/mfs/statgen/yin/Github/linkage/SEQpy3/cache/LINKAGE.cache&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fmt</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;data/genemap.hg38.txt&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.05</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">theta_max</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">args</span><span class="o">.</span><span class="n">output_limit</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">??</span>run_linkage
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-fg">Signature:</span> run_linkage<span class="ansi-blue-fg">(</span>blueprint<span class="ansi-blue-fg">,</span> theta_inc<span class="ansi-blue-fg">,</span> theta_max<span class="ansi-blue-fg">,</span> to_plot<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span> &lt;no docstring&gt;
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-green-fg">def</span> run_linkage<span class="ansi-blue-fg">(</span>blueprint<span class="ansi-blue-fg">,</span> theta_inc<span class="ansi-blue-fg">,</span> theta_max<span class="ansi-blue-fg">,</span> to_plot <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
        remove_tree<span class="ansi-blue-fg">(</span>os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span>env<span class="ansi-blue-fg">.</span>outdir<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;heatmap&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">except</span> OSError<span class="ansi-blue-fg">:</span>
        <span class="ansi-green-fg">pass</span>
    <span class="ansi-green-fg">with</span> open<span class="ansi-blue-fg">(</span>os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span>env<span class="ansi-blue-fg">.</span>tmp_dir<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;LinkageRuntimeError.txt&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;w&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> runtime_err<span class="ansi-blue-fg">:</span>
        workdirs <span class="ansi-blue-fg">=</span> glob<span class="ansi-blue-fg">.</span>glob<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;{}/LINKAGE/{}.chr*&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>env<span class="ansi-blue-fg">.</span>tmp_dir<span class="ansi-blue-fg">,</span> env<span class="ansi-blue-fg">.</span>output<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        parmap<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">lambda</span> x<span class="ansi-blue-fg">:</span> linkage_worker<span class="ansi-blue-fg">(</span>blueprint<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">,</span> theta_inc<span class="ansi-blue-fg">,</span> theta_max<span class="ansi-blue-fg">,</span> runtime_err<span class="ansi-blue-fg">,</span> to_plot<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">,</span> workdirs<span class="ansi-blue-fg">,</span> env<span class="ansi-blue-fg">.</span>jobs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      /tmp/2206534.1.plot.q/ipykernel_30528/2972776299.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LINKAGE</span><span class="o">/</span><span class="n">LINKAGE</span><span class="err">$</span> <span class="n">head</span> <span class="n">LINKAGE</span><span class="o">.</span><span class="n">chr1</span><span class="o">/</span><span class="n">DDX11L1</span><span class="o">/</span><span class="mi">1036</span><span class="o">/*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span> <span class="o">=</span> <span class="s1">&#39;./LINKAGE&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="o">=</span><span class="mi">8</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">blueprint</span><span class="p">,</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">,</span> <span class="n">to_plot</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">--</span><span class="n">fam</span> <span class="n">data</span><span class="o">/</span><span class="n">mwe_normal_fam</span><span class="o">.</span><span class="n">csv</span> <span class="o">--</span><span class="n">vcf</span> <span class="n">data</span><span class="o">/</span><span class="n">first1000snp_full_samples</span><span class="o">.</span><span class="n">vcf</span><span class="o">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">f</span> <span class="n">LINKAGE</span> <span class="o">--</span><span class="n">blueprint</span> <span class="n">data</span><span class="o">/</span><span class="n">genemap</span><span class="o">.</span><span class="n">hg38</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">freq</span> <span class="n">AF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;./LINKAGE&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env</span><span class="o">.</span><span class="n">output</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;LINKAGE&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="s1">&#39;LinkageRuntimeError.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runtime_err</span><span class="p">:</span>
    <span class="n">workdirs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/LINKAGE/</span><span class="si">{}</span><span class="s1">.chr*&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">workdirs</span><span class="p">)</span>
    <span class="n">linkage_worker</span><span class="p">(</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">workdirs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">,</span> <span class="n">runtime_err</span><span class="p">,</span> <span class="n">to_plot</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;./LINKAGE/LINKAGE/LINKAGE.chr1&#39;]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_values([1, 2])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">run_linkage</span><span class="p">(</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">,</span> <span class="n">to_plot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">remove_tree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="s1">&#39;LinkageRuntimeError.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runtime_err</span><span class="p">:</span>
        <span class="n">workdirs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/LINKAGE/</span><span class="si">{}</span><span class="s1">.chr*&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">))</span>
        <span class="n">parmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">linkage_worker</span><span class="p">(</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">,</span> <span class="n">runtime_err</span><span class="p">,</span> <span class="n">to_plot</span><span class="p">)</span> <span class="p">,</span> <span class="n">workdirs</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">linkage_worker</span><span class="p">(</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">workdir</span><span class="p">,</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">,</span> <span class="n">errfile</span><span class="p">,</span> <span class="n">to_plot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="c1">#env.log(&quot;Start running LINKAGE for {} ...&quot;.format(workdir), flush=True)</span>
    <span class="c1">#hash genes into genemap</span>
    <span class="n">genemap</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">blueprint</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">blueprint</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                <span class="n">chrID</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">gene</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">genemap</span><span class="p">[</span><span class="n">gene</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">chrID</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">end</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tped</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">tmp_cache</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdir</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.tped&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tped</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                <span class="n">items</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">chrID</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gene</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">genemap</span><span class="p">[</span><span class="n">gene</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">chrID</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
        <span class="n">mkpath</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">))</span>
    <span class="n">lods_fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.lods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdir</span><span class="p">)),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">hlods_fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.hlods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdir</span><span class="p">)),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">famlods_fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.family-lods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdir</span><span class="p">)),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">genes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">genemap</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">basename</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">workdir</span> <span class="o">+</span> <span class="s1">&#39;/*&#39;</span><span class="p">))))</span>
    <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">genes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">genemap</span><span class="p">[</span><span class="n">g</span><span class="p">]):</span>
        <span class="n">lods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">hlods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fams</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">basename</span><span class="p">,</span> <span class="nb">filter</span><span class="p">(</span><span class="n">isdir</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/*&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span> <span class="n">gene</span><span class="p">))))</span>
        <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">fams</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">cd</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">workdir</span><span class="p">,</span> <span class="n">gene</span><span class="p">,</span> <span class="n">fam</span><span class="p">)):</span>
                <span class="n">units</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(\d+?)\.PRE$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">,</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.PRE&#39;</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
                    <span class="n">copy_file</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.LOC&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="s1">&#39;datafile.dat&#39;</span><span class="p">)</span>
                    <span class="n">copy_file</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.PRE&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="s1">&#39;pedfile.pre&#39;</span><span class="p">)</span>

                    <span class="n">step1</span> <span class="o">=</span> <span class="n">runCommand</span><span class="p">([</span><span class="s1">&#39;makeped&#39;</span><span class="p">,</span> <span class="s1">&#39;pedfile.pre&#39;</span><span class="p">,</span> <span class="s1">&#39;pedfile.ped&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">],</span>
                                       <span class="n">show_stderr</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_zero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">step1</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;makeped error:&quot;</span><span class="p">,</span> <span class="n">step1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                            <span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                            <span class="n">errfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">step1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">continue</span>
                    <span class="n">step2</span> <span class="o">=</span> <span class="n">runCommand</span><span class="p">([</span><span class="s1">&#39;pedcheck&#39;</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;pedfile.ped&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;datafile.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">],</span>
                                       <span class="n">show_stderr</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_zero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">step2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">step2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                                 <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> lines&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)))</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                                <span class="n">errfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">step2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                                <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pedcheck error:&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">copy_file</span><span class="p">(</span><span class="s1">&#39;zeroout.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;pedfile.dat&#39;</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                            <span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>
                    <span class="n">step3</span> <span class="o">=</span> <span class="n">runCommand</span><span class="p">(</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="n">show_stderr</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_zero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">step3</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unkn error:&quot;</span><span class="p">,</span> <span class="n">step3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                            <span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                            <span class="n">errfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">step3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">continue</span>
                    <span class="n">step4</span> <span class="o">=</span> <span class="n">runCommand</span><span class="p">(</span><span class="s1">&#39;mlink&#39;</span><span class="p">,</span> <span class="n">show_stderr</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_zero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">step4</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                            <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mlink error:&quot;</span><span class="p">,</span> <span class="n">step4</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                            <span class="n">errfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">step4</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">copy_file</span><span class="p">(</span><span class="s1">&#39;outfile.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.out&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unit</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
                            <span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>
                    <span class="c1">#clean linkage tmp files</span>
                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.dat&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;ped*&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;names.tmp&#39;</span><span class="p">]):</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="c1">#collect lod scores of different thelta for the fam</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.out&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">unit</span><span class="p">))</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
                        <span class="n">raw</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^THETAS\s+(0\.\d+)(?:\n.+?)</span><span class="si">{7}</span><span class="s1">LOD SCORE =\s+(-?\d+\.\d+)&#39;</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">):</span>
                            <span class="n">theta</span><span class="p">,</span> <span class="n">lod</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
                            <span class="c1">#if float(lod) &lt; 1e-6:</span>
                            <span class="c1">#    lod = 0</span>
                            <span class="k">if</span> <span class="n">theta</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lods</span><span class="p">:</span>
                                <span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">fam</span><span class="p">:</span> <span class="n">lod</span><span class="p">}</span>
                            <span class="k">elif</span> <span class="n">fam</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span> <span class="ow">or</span> <span class="n">lod</span> <span class="o">&gt;</span> <span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">][</span><span class="n">fam</span><span class="p">]:</span>
                                <span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">][</span><span class="n">fam</span><span class="p">]</span> <span class="o">=</span> <span class="n">lod</span>
        <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lods</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">lods_fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gene</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">genemap</span><span class="p">[</span><span class="n">gene</span><span class="p">])),</span> <span class="n">theta</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
            <span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]:</span>
                <span class="n">famlods_fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fam</span><span class="p">,</span> <span class="n">gene</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">genemap</span><span class="p">[</span><span class="n">gene</span><span class="p">])),</span> <span class="n">theta</span><span class="p">,</span> <span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">][</span><span class="n">fam</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">hlod_fun</span><span class="p">(</span><span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bounded&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xatol&#39;</span><span class="p">:</span><span class="mf">1e-8</span><span class="p">})</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
            <span class="n">hlods_fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gene</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">genemap</span><span class="p">[</span><span class="n">gene</span><span class="p">])),</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">hlod_fun</span><span class="p">(</span><span class="n">lods</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())(</span><span class="n">a</span><span class="p">)))</span>
        <span class="k">with</span> <span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">get_lock</span><span class="p">():</span>
            <span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span> <span class="o">%</span> <span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">batch</span> <span class="o">*</span> <span class="n">env</span><span class="o">.</span><span class="n">jobs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Linkage analysis for </span><span class="si">{:,d}</span><span class="s1"> units completed {{</span><span class="si">{:.2%}</span><span class="s1">}} ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">/</span><span class="n">env</span><span class="o">.</span><span class="n">success_counter</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lods_fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">hlods_fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">famlods_fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">to_plot</span><span class="p">:</span>
        <span class="n">heatmap</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.lods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdir</span><span class="p">)),</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">)</span>
        <span class="n">heatmap</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.hlods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdir</span><span class="p">)),</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">)</span>
    <span class="c1">#env.log(&quot;Finished running LINKAGE for {}.&quot;.format(workdir), flush=True)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run_linkage</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">subprocess</span><span class="o">,</span> <span class="nn">shutil</span><span class="o">,</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">shlex</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">hashlib</span><span class="o">,</span> <span class="nn">tempfile</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">cStringIO</span> <span class="kn">import</span> <span class="n">StringIO</span> <span class="c1">## for Python 2</span>
    <span class="kn">import</span> <span class="nn">urlparse</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span> <span class="c1">## for Python 3</span>
    <span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span><span class="p">,</span> <span class="n">Process</span><span class="p">,</span> <span class="n">Queue</span><span class="p">,</span> <span class="n">Lock</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">cpu_count</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span><span class="p">,</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">rmtree</span> <span class="k">as</span> <span class="n">remove_tree</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cpu_count</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>32</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">parmap</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">nprocs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()):</span>
    <span class="k">def</span> <span class="nf">spawn</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">q_in</span><span class="p">,</span><span class="n">q_out</span><span class="p">):</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">q_in</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">q_out</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">fun</span>
    <span class="c1">#</span>
    <span class="n">q_in</span>   <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">q_out</span>  <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
    <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">spawn</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">q_in</span><span class="p">,</span><span class="n">q_out</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nprocs</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">proc</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">sent</span> <span class="o">=</span> <span class="p">[</span><span class="n">q_in</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">q_in</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nprocs</span><span class="p">)]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">q_out</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">))]</span>
    <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">proc</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">res</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">run_linkage</span><span class="p">:</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="s1">&#39;analysis&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">vanilla</span> <span class="ow">and</span> <span class="n">cache</span><span class="o">.</span><span class="n">check</span><span class="p">():</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Loading linkage analysis result from archive ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;heatmap&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Running linkage analysis ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">run_linkage</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">blueprint</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Linkage analysis succesfully performed for </span><span class="si">{:,d}</span><span class="s1"> units</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span>\
                <span class="nb">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">run_counter</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()),</span> <span class="n">flush</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;makeped&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">makeped_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;pedcheck&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">pedcheck_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;unknown&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">unknown_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &quot;mlink&quot; runtime errors occurred&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">mlink_counter</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arcroot</span> <span class="o">=</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">,</span> <span class="n">source_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;heatmap&#39;</span><span class="p">),</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">html</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">theta_inc</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">theta_max</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_limit</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Saving data to [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Running linkage analysis ...</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Linkage analysis succesfully performed for 1 units</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: 2 &#34;pedcheck&#34; runtime errors occurred</span>
<span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Report for [tsq20211129] is generated in HTML format</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    <span class="n">env</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Saving data to [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">)))</span>
    <span class="n">cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target_dir</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">format</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-green-intense-fg ansi-black-bg ansi-bold">MESSAGE: Saving data to [/mnt/mfs/statgen/yin/Github/linkage/SEQpy2/testseqlink]</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.Testing-heatmap">3.Testing heatmap<a class="anchor-link" href="#3.Testing-heatmap"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">hinton</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">max_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">max_weight</span><span class="p">:</span>
        <span class="n">max_weight</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
    <span class="n">chrID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\.chr([0-9XY]+)\.&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chromosome </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chrID</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">w</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;black&#39;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">([</span><span class="n">x</span> <span class="o">-</span> <span class="n">size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span> <span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span>
                             <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">heatmap</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">):</span>
    <span class="c1">#env.log(&quot;Start ploting heatmap for {} ...&quot;.format(file), flush=True)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hinton</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        <span class="k">return</span>
    <span class="n">lods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">theta</span><span class="p">,</span><span class="n">lod</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
            <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">theta_max</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">lods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lod</span><span class="p">)</span>
        <span class="c1">#add random number.</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">lods</span><span class="p">)</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">lods</span><span class="p">):</span>
            <span class="c1">#env.log(&#39;Max equals Min for [{}], No real heatmap will be generated.&#39;.format(file))</span>
            <span class="n">hinton</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="n">Num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">theta_max</span><span class="o">/</span><span class="n">theta_inc</span><span class="p">))</span>
        <span class="n">lods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">lods</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Num</span><span class="p">))</span>
        <span class="n">chrID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\.chr([0-9XY]+)\.&#39;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chromosome </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chrID</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">lods</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span>
                       <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lods</span><span class="p">),</span>
                       <span class="n">yticklabels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Num</span><span class="p">))</span> <span class="o">*</span> <span class="n">theta_inc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="s1">&#39;Sequential&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_colormap</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta_inc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.05</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Num</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">theta_max</span><span class="o">/</span><span class="n">theta_inc</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Num</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;0.0&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lods</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Num</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lods</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(4, 10)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">lods</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lods</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Num</span><span class="p">))</span> <span class="o">*</span> <span class="n">theta_inc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="s1">&#39;Sequential&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_colormap</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/2206534.1.plot.q/ipykernel_30528/241223039.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>brewer2mpl<span class="ansi-blue-fg">.</span>get_map<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Blues&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;Sequential&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">9</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mpl_colormap<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">TypeError</span>: &#39;LinearSegmentedColormap&#39; object is not subscriptable</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lods</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.QuadMesh at 0x2b7a0b1f2be0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span>

<span class="c1"># generate 2 2d grids for the x &amp; y bounds</span>
<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dy</span><span class="p">),</span>
                <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">lods</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">cmap</span><span class="o">=</span><span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="s1">&#39;Sequential&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_colormap</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.QuadMesh at 0x2b7a0b397370&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXsAAAD8CAYAAACW/ATfAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8/fFQqAAAACXBIWXMAAAsTAAALEwEAmpwYAAAPP0lEQVR4nO3dbYxcZ32G8ev2JiZAQlJqmqS289LWTWUgCcE4qUAQpSA5UNmopKpT0RIEMi11oQQVkrZKVfcTVKIIal6sECl9ARNS1C7UKEUlFFEpqQOEFyc1XSKKnUYNBEhogRjDvx92AsNqlz27O+uzO8/1k1aac84zc+597HPv2TM7M6kqJEnjbU3fASRJy8+yl6QGWPaS1ADLXpIaYNlLUgMse0lqQKeyT7ItyeEkU0mum2X7NUm+muTuwdcrRx9VkrRYJ803IMkEsBd4AXAUOJhksqrumTH0/VW1exkySpKWqMuZ/VZgqqruq6pjwH5gx/LGkiSN0rxn9sB64MjQ8lHg0lnGvSTJc4EvAq+rqiMzByTZBewCWLP28c98wpnnLDyxZvV/3/pu3xHGxlPPeXLfEcbK4Qce6TvCWPneV7/0tap6ykLv16Xsu/gQ8L6qejTJq4CbgStmDqqqfcA+gNPO+aXa8vqbRrR73fGv9/YdYWx88J2/2XeEsXLFnn/uO8JYOfqOF//XYu7X5TLO/cDGoeUNg3U/VFUPVdWjg8UbgWcuJowkaXl0KfuDwKYk5ydZC+wEJocHJDl7aHE74GmmJK0g817GqarjSXYDtwETwE1VdSjJHuCuqpoEXpNkO3Ac+DpwzTJmliQtUKdr9lV1ADgwY90NQ7evB64fbTRJ0qj4ClpJaoBlL0kNsOwlqQGWvSQ1wLKXpAZY9pLUAMtekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIaYNlLUgNSVb3seM0Z59TjnvOGXvY9jh689dV9Rxgb//3N7/YdYaycu+4JfUcYK48/OZ+qqi0LvZ9n9pLUAMtekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIaYNlLUgMse0lqgGUvSQ2w7CWpAZa9JDXAspekBlj2ktQAy16SGtCp7JNsS3I4yVSS637CuJckqSQL/sgsSdLymbfsk0wAe4Ergc3A1Uk2zzLuNOC1wJ2jDilJWpouZ/Zbgamquq+qjgH7gR2zjPtz4E2An9YsSSvMSR3GrAeODC0fBS4dHpDkEmBjVf1Tkj+c64GS7AJ2Aaw940wues7TF55Ys/qZF7+17whj46HJ1/UdYaz8/ge/0HcEMYInaJOsAd4CvH6+sVW1r6q2VNWWk594+lJ3LUnqqEvZ3w9sHFreMFj3mNOApwEfT/Jl4DJg0idpJWnl6FL2B4FNSc5PshbYCUw+trGqHq6qdVV1XlWdB9wBbK+qu5YlsSRpweYt+6o6DuwGbgPuBW6pqkNJ9iTZvtwBJUlL1+UJWqrqAHBgxrob5hh7+dJjSZJGyVfQSlIDLHtJaoBlL0kNsOwlqQGWvSQ1wLKXpAZY9pLUAMtekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIa0OnDS5bDWaefwhtfeEFfux87+89+Ut8RxsaOfXf2HWGsvPs3Lu47wli5cZH388xekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIaYNlLUgMse0lqgGUvSQ2w7CWpAZa9JDXAspekBlj2ktQAy16SGtCp7JNsS3I4yVSS62bZ/jtJPp/k7iSfTLJ59FElSYs1b9knmQD2AlcCm4GrZynz91bV06vqYuDNwFtGHVSStHhdzuy3AlNVdV9VHQP2AzuGB1TVI0OLTwRqdBElSUvV5QPH1wNHhpaPApfOHJTk94BrgbXAFbM9UJJdwC6AnzrzZznyyHcWmldzeOdVF/YdYWxcffNdfUcYK7+299/6jiBG+ARtVe2tqp8H3gj8yRxj9lXVlqracuoZTx7VriVJ8+hS9vcDG4eWNwzWzWU/8OIlZJIkjViXsj8IbEpyfpK1wE5gcnhAkk1Diy8C/nN0ESVJSzXvNfuqOp5kN3AbMAHcVFWHkuwB7qqqSWB3kucD3wO+AbxsOUNLkhamyxO0VNUB4MCMdTcM3X7tiHNJkkbIV9BKUgMse0lqgGUvSQ2w7CWpAZa9JDXAspekBlj2ktQAy16SGmDZS1IDLHtJaoBlL0kNsOwlqQGWvSQ1wLKXpAZY9pLUAMtekhqQquplx6ec9Yt17sve3su+x9HWC8/qO8LYeNIT1vYdYay8asvG+Qeps4vOOe1TVbVloffzzF6SGmDZS1IDLHtJaoBlL0kNsOwlqQGWvSQ1wLKXpAZY9pLUAMtekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIaYNlLUgM6lX2SbUkOJ5lKct0s269Nck+SzyX5lyTnjj6qJGmx5i37JBPAXuBKYDNwdZLNM4Z9BthSVRcCtwJvHnVQSdLidTmz3wpMVdV9VXUM2A/sGB5QVbdX1bcHi3cAG0YbU5K0FCd1GLMeODK0fBS49CeMfwXwkdk2JNkF7AJg7Wl85faPdkupeV3+rJf3HWFsfP1bj/YdYax84NADfUcQ3cq+syQvBbYAz5tte1XtA/YBrHniWTXKfUuS5tal7O8HNg4tbxis+zFJng/8MfC8qvLUSJJWkC7X7A8Cm5Kcn2QtsBOYHB6Q5BnAu4HtVfXg6GNKkpZi3rKvquPAbuA24F7glqo6lGRPku2DYX8BnAp8IMndSSbneDhJUg86XbOvqgPAgRnrbhi6/fwR55IkjZCvoJWkBlj2ktQAy16SGmDZS1IDLHtJaoBlL0kNsOwlqQGWvSQ1wLKXpAZY9pLUAMtekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNWCkHzi+EBddsIGPffxNfe1+7PzPw37s76gc//4P+o4wVj555Gt9RxCe2UtSEyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIaYNlLUgMse0lqgGUvSQ2w7CWpAZa9JDXAspekBlj2ktQAy16SGmDZS1IDOpV9km1JDieZSnLdLNufm+TTSY4nuWr0MSVJSzFv2SeZAPYCVwKbgauTbJ4x7CvANcB7Rx1QkrR0XT6DdiswVVX3ASTZD+wA7nlsQFV9ebDND++UpBWoS9mvB44MLR8FLl3MzpLsAnYBTJy6jqde+4+LeRjNYmJiou8IY2P9xjP6jjBWjh37ft8RxAl+graq9lXVlqrasuaU00/kriWpaV3K/n5g49DyhsE6SdIq0aXsDwKbkpyfZC2wE5hc3liSpFGat+yr6jiwG7gNuBe4paoOJdmTZDtAkmclOQr8OvDuJIeWM7QkaWG6PEFLVR0ADsxYd8PQ7YNMX96RJK1AvoJWkhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGWPaS1ADLXpIaYNlLUgMse0lqgGUvSQ2w7CWpAZa9JDXAspekBlj2ktSATh9eshwed8pJbLrgzL52P3bedtWFfUcYG5dtv77vCGNl3bNf0HcE4Zm9JDXBspekBlj2ktQAy16SGmDZS1IDLHtJaoBlL0kNsOwlqQGWvSQ1wLKXpAZY9pLUAMtekhpg2UtSAyx7SWqAZS9JDbDsJakBlr0kNcCyl6QGdCr7JNuSHE4yleS6WbY/Lsn7B9vvTHLeyJNKkhZt3rJPMgHsBa4ENgNXJ9k8Y9grgG9U1S8Afwm8adRBJUmL1+XMfiswVVX3VdUxYD+wY8aYHcDNg9u3Ar+SJKOLKUlaipM6jFkPHBlaPgpcOteYqjqe5GHgp4GvDQ9KsgvYNVh89BPXPucLiwl9gq1jxvexEl187erIyeqYz9WQEVZJzqN3710VOVkl8wlcsJg7dSn7kamqfcA+gCR3VdWWE7n/xTDnaK2GnKshI5hz1FZTzsXcr8tlnPuBjUPLGwbrZh2T5CTgdOChxQSSJI1el7I/CGxKcn6StcBOYHLGmEngZYPbVwEfq6oaXUxJ0lLMexlncA1+N3AbMAHcVFWHkuwB7qqqSeA9wN8kmQK+zvQPhPnsW0LuE8mco7Uacq6GjGDOURvrnPEEXJLGn6+glaQGWPaS1IBlL/vV8lYLHXJek+SrSe4efL2yh4w3JXkwyayvT8i0tw2+h88lueREZxzkmC/n5UkeHprLG3rIuDHJ7UnuSXIoyWtnGdP7fHbMuRLm85Qk/57ks4OcfzbLmN6P9Y45ez/WBzkmknwmyYdn2bbwuayqZfti+gndLwE/B6wFPgtsnjHm1cC7Brd3Au9fzkxLyHkN8FcnOtuMDM8FLgG+MMf2FwIfAQJcBty5QnNeDny457k8G7hkcPs04Iuz/Jv3Pp8dc66E+Qxw6uD2ycCdwGUzxqyEY71Lzt6P9UGOa4H3zvZvu5i5XO4z+9XyVgtdcvauqj7B9F87zWUH8Nc17Q7gjCRnn5h0P9IhZ++q6oGq+vTg9reAe5l+Jfiw3uezY87eDebofweLJw++Zv71R+/HesecvUuyAXgRcOMcQxY8l8td9rO91cLM/6g/9lYLwGNvtXAidckJ8JLBr/O3Jtk4y/a+df0+VoJfHvwq/ZEkT+0zyOBX4GcwfZY3bEXN50/ICStgPgeXHe4GHgQ+WlVzzmePx3qXnND/sf5W4A3AD+bYvuC59Ana7j4EnFdVFwIf5Uc/VbVwnwbOraqLgLcD/9BXkCSnAn8P/EFVPdJXjvnMk3NFzGdVfb+qLmb6VfZbkzytjxzz6ZCz12M9ya8CD1bVp0b5uMtd9qvlrRbmzVlVD1XVo4PFG4FnnqBsC9FlvntXVY889qt0VR0ATk6y7kTnSHIy0wX6d1X1wVmGrIj5nC/nSpnPoTzfBG4Hts3YtBKO9R+aK+cKONafDWxP8mWmLylfkeRvZ4xZ8Fwud9mvlrdamDfnjGu125m+drrSTAK/PfgrksuAh6vqgb5DzZTkrMeuLybZyvT/wxN60A/2/x7g3qp6yxzDep/PLjlXyHw+JckZg9uPB14A/MeMYb0f611y9n2sV9X1VbWhqs5juos+VlUvnTFswXO5rO96Wcv3Vgt95HxNku3A8UHOa050ziTvY/ovL9YlOQr8KdNPMFFV7wIOMP0XJFPAt4GXn+iMHXNeBfxukuPAd4CdPfyAfzbwW8DnB9dvAf4IOGco50qYzy45V8J8ng3cnOkPO1oD3FJVH15px3rHnL0f67NZ6lz6dgmS1ACfoJWkBlj2ktQAy16SGmDZS1IDLHtJaoBlL0kNsOwlqQH/D4Y+KAQVt7iYAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.lods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdirs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">chrID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\.chr([0-9XY]+)\.&#39;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chromosome </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chrID</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">lods</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span>
               <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lods</span><span class="p">),</span>
               <span class="n">yticklabels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">Num</span><span class="p">))</span> <span class="o">*</span> <span class="n">theta_inc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
               <span class="n">cmap</span><span class="o">=</span><span class="n">brewer2mpl</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="s1">&#39;Sequential&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">mpl_colormap</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IndexError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/2206534.1.plot.q/ipykernel_30528/3434994219.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> fig<span class="ansi-blue-fg">,</span> ax <span class="ansi-blue-fg">=</span> plt<span class="ansi-blue-fg">.</span>subplots<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> ax<span class="ansi-blue-fg">.</span>set_title<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Chromosome {}&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>chrID<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg"> plt.pcolormesh(fig,ax,lods.transpose(),
</span><span class="ansi-green-intense-fg ansi-bold">      6</span>                xticklabels<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;&#39;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">*</span> len<span class="ansi-blue-fg">(</span>lods<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>                yticklabels<span class="ansi-blue-fg">=</span>np<span class="ansi-blue-fg">.</span>round<span class="ansi-blue-fg">(</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>range<span class="ansi-blue-fg">(</span>Num<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">*</span> theta_inc<span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>tolist<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/miniconda3/envs/seqpy3v0/lib/python3.9/site-packages/matplotlib/pyplot.py</span> in <span class="ansi-cyan-fg">pcolormesh</span><span class="ansi-blue-fg">(alpha, norm, cmap, vmin, vmax, shading, antialiased, data, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2716</span>         vmax<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> shading<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> antialiased<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   2717</span>         **kwargs):
<span class="ansi-green-fg">-&gt; 2718</span><span class="ansi-red-fg">     __ret = gca().pcolormesh(
</span><span class="ansi-green-intense-fg ansi-bold">   2719</span>         <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> alpha<span class="ansi-blue-fg">=</span>alpha<span class="ansi-blue-fg">,</span> norm<span class="ansi-blue-fg">=</span>norm<span class="ansi-blue-fg">,</span> cmap<span class="ansi-blue-fg">=</span>cmap<span class="ansi-blue-fg">,</span> vmin<span class="ansi-blue-fg">=</span>vmin<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   2720</span>         vmax<span class="ansi-blue-fg">=</span>vmax<span class="ansi-blue-fg">,</span> shading<span class="ansi-blue-fg">=</span>shading<span class="ansi-blue-fg">,</span> antialiased<span class="ansi-blue-fg">=</span>antialiased<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/miniconda3/envs/seqpy3v0/lib/python3.9/site-packages/matplotlib/__init__.py</span> in <span class="ansi-cyan-fg">inner</span><span class="ansi-blue-fg">(ax, data, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1410</span>     <span class="ansi-green-fg">def</span> inner<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> data<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1411</span>         <span class="ansi-green-fg">if</span> data <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1412</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>map<span class="ansi-blue-fg">(</span>sanitize_sequence<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1413</span> 
<span class="ansi-green-intense-fg ansi-bold">   1414</span>         bound <span class="ansi-blue-fg">=</span> new_sig<span class="ansi-blue-fg">.</span>bind<span class="ansi-blue-fg">(</span>ax<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/seqpy3v0/lib/python3.9/site-packages/matplotlib/axes/_axes.py</span> in <span class="ansi-cyan-fg">pcolormesh</span><span class="ansi-blue-fg">(self, alpha, norm, cmap, vmin, vmax, shading, antialiased, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   6014</span>         kwargs<span class="ansi-blue-fg">.</span>setdefault<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;edgecolors&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;none&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   6015</span> 
<span class="ansi-green-fg">-&gt; 6016</span><span class="ansi-red-fg">         X, Y, C, shading = self._pcolorargs(&#39;pcolormesh&#39;, *args,
</span><span class="ansi-green-intense-fg ansi-bold">   6017</span>                                             shading=shading, kwargs=kwargs)
<span class="ansi-green-intense-fg ansi-bold">   6018</span>         coords <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>stack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>X<span class="ansi-blue-fg">,</span> Y<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> axis<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/envs/seqpy3v0/lib/python3.9/site-packages/matplotlib/axes/_axes.py</span> in <span class="ansi-cyan-fg">_pcolorargs</span><span class="ansi-blue-fg">(self, funcname, shading, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   5507</span>                             f&#39;but {len(args)} were given&#39;)
<span class="ansi-green-intense-fg ansi-bold">   5508</span> 
<span class="ansi-green-fg">-&gt; 5509</span><span class="ansi-red-fg">         </span>Nx <span class="ansi-blue-fg">=</span> X<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   5510</span>         Ny <span class="ansi-blue-fg">=</span> Y<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">   5511</span>         <span class="ansi-green-fg">if</span> X<span class="ansi-blue-fg">.</span>ndim <span class="ansi-blue-fg">!=</span> <span class="ansi-cyan-fg">2</span> <span class="ansi-green-fg">or</span> X<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">IndexError</span>: tuple index out of range</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">heatmap</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/heatmap/</span><span class="si">{}</span><span class="s1">.lods&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">workdirs</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">theta_inc</span><span class="p">,</span> <span class="n">theta_max</span><span class="p">)</span>
<span class="c1">#heatmap(&#39;{}/heatmap/{}.hlods&#39;.format(env.outdir, basename(workdir)), theta_inc, theta_max)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LOC102725121@1 1 11868 14362 0.5 0.0

DDX11L1 1 11873 14409 0.5 0.0

WASH7P 1 14361 29370 0.5 0.0

MIR6859-1@1,MIR6859-2@1,MIR6859-3@1,MIR6859-4@1 1 17368 17436 0.5 0.0

[&#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;, &#39;0.0&#39;]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/2206534.1.plot.q/ipykernel_30528/3244704223.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>heatmap<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;{}/heatmap/{}.lods&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>env<span class="ansi-blue-fg">.</span>outdir<span class="ansi-blue-fg">,</span> basename<span class="ansi-blue-fg">(</span>workdirs<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> theta_inc<span class="ansi-blue-fg">,</span> theta_max<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-red-fg">#heatmap(&#39;{}/heatmap/{}.hlods&#39;.format(env.outdir, basename(workdir)), theta_inc, theta_max)</span>

<span class="ansi-green-fg">/tmp/2206534.1.plot.q/ipykernel_30528/1950724175.py</span> in <span class="ansi-cyan-fg">heatmap</span><span class="ansi-blue-fg">(file, theta_inc, theta_max)</span>
<span class="ansi-green-intense-fg ansi-bold">     41</span>             <span class="ansi-red-fg">#return</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>         Num<span class="ansi-blue-fg">=</span>int<span class="ansi-blue-fg">(</span>round<span class="ansi-blue-fg">(</span>theta_max<span class="ansi-blue-fg">/</span>theta_inc<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 43</span><span class="ansi-red-fg">         </span>lods <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>map<span class="ansi-blue-fg">(</span>float<span class="ansi-blue-fg">,</span>lods<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>Num<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>         chrID <span class="ansi-blue-fg">=</span> re<span class="ansi-blue-fg">.</span>search<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">r&#39;\.chr([0-9XY]+)\.&#39;</span><span class="ansi-blue-fg">,</span> file<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>group<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>         fig<span class="ansi-blue-fg">,</span> ax <span class="ansi-blue-fg">=</span> plt<span class="ansi-blue-fg">.</span>subplots<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">ValueError</span>: cannot reshape array of size 1 into shape (10)</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">workdirs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;./LINKAGE/LINKAGE/LINKAGE.chr1&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

